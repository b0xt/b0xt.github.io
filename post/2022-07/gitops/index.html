<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>GitOps Getting Started Tutorial - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Explore GitOps and its relationship to DevOps." /><meta name="keywords" content="gitops" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-07/gitops/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="GitOps Getting Started Tutorial" />
<meta property="og:description" content="Explore GitOps and its relationship to DevOps." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-07/gitops/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-07-03T16:19:28+08:00" />
<meta property="article:modified_time" content="2022-07-03T16:19:28+08:00" />

<meta itemprop="name" content="GitOps Getting Started Tutorial">
<meta itemprop="description" content="Explore GitOps and its relationship to DevOps."><meta itemprop="datePublished" content="2022-07-03T16:19:28+08:00" />
<meta itemprop="dateModified" content="2022-07-03T16:19:28+08:00" />
<meta itemprop="wordCount" content="1660">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="GitOps Getting Started Tutorial"/>
<meta name="twitter:description" content="Explore GitOps and its relationship to DevOps."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">GitOps Getting Started Tutorial</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-07-03 16:19:28 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1660 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#infrastructure-as-code">Infrastructure as Code</a></li>
        <li><a href="#what-is-gitops">What is GitOps</a></li>
        <li><a href="#gitops-vs-devops">GitOps vs DevOps</a></li>
        <li><a href="#gitops-design-philosophy">GitOps Design Philosophy</a>
          <ul>
            <li><a href="#1-declarative">1. declarative</a></li>
            <li><a href="#2-version-control--immutability">2. Version Control / Immutability</a></li>
            <li><a href="#3-automatically-apply-changes">3. Automatically Apply Changes</a></li>
            <li><a href="#4-continuous-reconciliation">4. Continuous Reconciliation</a></li>
          </ul>
        </li>
        <li><a href="#push-vs-pull">Push vs Pull</a>
          <ul>
            <li><a href="#push-mode">Push mode</a></li>
            <li><a href="#pull-mode">Pull Mode</a></li>
          </ul>
        </li>
        <li><a href="#advantages-of-gitops">Advantages of GitOps</a>
          <ul>
            <li><a href="#stronger-security">Stronger Security</a></li>
            <li><a href="#git-as-the-single-source-of-truth">Git as the Single Source of Truth</a></li>
            <li><a href="#increase-productivity">Increase Productivity</a></li>
            <li><a href="#easier-compliance-auditing">Easier Compliance Auditing</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/07/03/fd8ab1bda3d248cb97f6d7cf8ec135bc.png" alt="gitops"></p>
<p>GitOps was first introduced by Weaveworks, a Kubernetes management company, in 2017. Now that five years have passed, I&rsquo;m sure you&rsquo;ve heard of the concept, but you may not know what it is or what it has to do with DevOps. In this article, we&rsquo;ll help you figure it out one by one.</p>
<h2 id="infrastructure-as-code">Infrastructure as Code</h2>
<p>Before we can understand GitOps, we need to understand what <strong>Infrastructure as Code</strong> is.</p>
<p>Infrastructure as Code (<strong>IaC</strong>), as the name implies, indicates that infrastructure is defined using code (rather than manual processes) and that developers can treat infrastructure like application software, for example.</p>
<ul>
<li>Declarative configuration files can be created that contain infrastructure specifications, thereby facilitating editing and distribution of configurations.</li>
<li>It is possible to ensure that the environment is identical every time it is configured.</li>
<li>Version control is possible, and all changes are logged for easy traceability.</li>
<li>The infrastructure can be divided into several modular components and combined in different ways through automation.</li>
</ul>
<p>Of course, IaC in the broader sense is not just about infrastructure, but also includes <strong>Networking</strong>, <strong>Security</strong>, <strong>Configuration</strong>, and so on, so IaC in the broader sense is also called <strong>X as Code</strong>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/07/03/13f7ae41a9a045829522b24a6855e1f3.png" alt="x as code"></p>
<p>For example, if you want to create servers, configure networks, deploy Kubernetes clusters and various workloads in AWS, all you need to do is define a declarative configuration for Terraform or Ansible and a configuration checklist for Kubernetes, eliminating all the tedious manual work.</p>
<h2 id="what-is-gitops">What is GitOps</h2>
<p>GitOps = IaC + Git + CI/CD, a versioned CI/CD based on IaC. at its core, it uses a Git repository to manage the configuration of your infrastructure and applications, and <strong>with the Git repository as the single source of truth for your infrastructure and applications</strong>, you can&rsquo;t change your configuration from anywhere else (like manually changing your online configuration) without going through.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/07/03/04af48da27ff448ea1bb1263911b8662.png" alt="Git Repository"></p>
<p>The declarative configuration in the Git repository describes the desired state of the target environment&rsquo;s current required infrastructure. With GitOps, if the actual state of the cluster does not match the desired state defined in the Git repository, Kubernetes reconcilers adjust the current state based on the desired state, ultimately making the actual state match the desired state.</p>
<p>On the other hand, modern application development is more concerned with iteration speed and scale, and organizations with a mature DevOps culture can deploy code to a generative environment hundreds of times a day, and DevOps teams can do this with best practices like version control, code review, and CI/CD streams for automated testing and deployment, which is what GitOps does.</p>
<h2 id="gitops-vs-devops">GitOps vs DevOps</h2>
<p>In a broad sense, GitOps and DevOps are not in conflict. <strong>GitOps is a technical tool, while DevOps is a culture</strong> GitOps is a tool and framework that enables Continuous Delivery, Continuous Deployment, and Infrastructure as Code (IaC), which supports a DevOps culture.</p>
<p>In a narrow sense, GitOps differs from DevOps in several ways.</p>
<p>First, <strong>GitOps is goal-oriented</strong>. It uses Git to maintain the desired state and continuously adjust the actual state to eventually match the desired state. Whereas <strong>DevOps focuses more on best practices</strong> that can be universally applied to every process in the enterprise.</p>
<p>Second, <strong>GitOps takes a declarative approach to operations, while DevOps accepts both declarative and imperative approaches</strong>, so DevOps is applicable to both virtual and bare-metal environments in addition to container environments.</p>
<p>Finally, <strong>GitOps redefines CI/CD</strong> in cloud-native scenarios with Git as the central immutable state declaration to speed up continuous deployment.</p>
<h2 id="gitops-design-philosophy">GitOps Design Philosophy</h2>
<p>To use GitOps to manage your infrastructure and applications, you need to practice the following principles.</p>
<h3 id="1-declarative">1. declarative</h3>
<p>The desired state of the system must be described declaratively. For example, Kubernetes, one of the many modern cloud-native tools that are declarative, is just one of them.</p>
<h3 id="2-version-control--immutability">2. Version Control / Immutability</h3>
<p>Because all state declarations are stored in the Git repository and use the Git repository as a single source of truth, then all operations are driven from the Git repository and retain a full version history for easy rollback. With Git&rsquo;s excellent security, you can also use SSH keys to sign commits, enforcing strong security over the authorship and provenance of your code.</p>
<h3 id="3-automatically-apply-changes">3. Automatically Apply Changes</h3>
<p>Any changes to the expected state declared in the Git repository can be applied to the system immediately, and there is no need to install and configure additional tools (like kubectl) or configure Kubernetes authentication authorization.</p>
<h3 id="4-continuous-reconciliation">4. Continuous Reconciliation</h3>
<p>Reconciliation is a concept that was first introduced in Kubernetes to represent the process of <strong>ensuring that the actual state of the system matches the desired state</strong>. This is achieved by installing an agent in the target environment, which will automatically repair any mismatch between the actual state and the desired state. The repair here is more advanced than Kubernetes&rsquo; fault self-healing, where the cluster is restored to the state described by the manifest in the Git repository, even if the cluster&rsquo;s orchestration manifest is manually modified.</p>
<p>With these design philosophies in mind, let&rsquo;s look at the GitOps workflow.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/07/03/83bbd10dffa84dbe990413dd42559f67.png" alt="GitOps workflow"></p>
<ul>
<li>First, any member of the team can Fork the repository to make changes to the configuration and then submit a Pull Request.</li>
<li>Next, the CI pipeline will run, typically doing several things: validating the configuration file, executing automated tests, testing the code for complexity, building the OCI image, pushing the image to the mirror repository, and so on.</li>
<li>Once the CI pipeline is running, the person on the team with the merge code permission will merge the pull request into the master branch. Usually the person with this permission is an R&amp;D person, security expert, or senior operations engineer.</li>
<li>Finally, a CD pipeline is run to apply the changes to the target system (e.g., Kubernetes cluster or AWS).</li>
</ul>
<p>The entire process is fully automated and transparent, with multi-person collaboration and automated testing to ensure robustness of the infrastructure statement configuration. The traditional model is that one of the engineers does it all on his or her own computer, and no one else knows what&rsquo;s going on or can review his or her actions.</p>
<h2 id="push-vs-pull">Push vs Pull</h2>
<p>There are two modes in the CD flowline: Push and Pull.</p>
<h3 id="push-mode">Push mode</h3>
<p>Most CI/CD tools today use a Push-based deployment model, such as Jenkins, CircleCI, and so on. This mode typically executes a command (such as kubectl) to deploy the application to the target environment after the CI pipeline has finished running.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/07/03/1e33cf774336438dab5061ccc2e715c6.png" alt="Push mode"></p>
<p>The drawbacks of the CD model are obvious.</p>
<ul>
<li>the need to install and configure additional tools (such as kubectl).</li>
<li>the need for Kubernetes to license it.</li>
<li>the need for cloud platform authorization.</li>
<li>Inability to perceive the deployment state. It is also impossible to perceive the deviation of the desired state from the actual state, and requires additional solutions to guarantee consistency.</li>
</ul>
<p>The authorization credentials of the CI system by the Kubernetes cluster or cloud platform are outside the trust domain of the cluster or cloud platform and are not protected by the security policy of the cluster or cloud platform, so the CI system can be easily used as a vector for illegal attacks.</p>
<h3 id="pull-mode">Pull Mode</h3>
<p>Pull mode installs an Agent in the target environment, such as an Operator in a Kubernetes cluster, and periodically monitors the actual state of the target environment and compares it to the desired state in the Git repository. If the actual state does not match the desired state, Operator updates the actual state of the infrastructure to match the desired state.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/07/03/5aa1cde013b6407083b9381cace8292e.png" alt="Pull Mode"></p>
<p>Only Git changes can be used as the only source of desired state; otherwise, no one can make any changes to the cluster, and even if you do, they will be restored to the desired state by the Operator, which is also known as immutable infrastructure.</p>
<p>The current CD tools based on the Pull model are <a href="https://github.com/argoproj/argo-cd/">Argo CD</a>, <a href="https://github.com/fluxcd/flux">Flux CD</a>, and <a href="https://github.com/kubesphere/ks-devops">ks-devops</a>.</p>
<h2 id="advantages-of-gitops">Advantages of GitOps</h2>
<p>GitOps generally prefers a Pull-based deployment model because it has a number of irreplaceable advantages.</p>
<h3 id="stronger-security">Stronger Security</h3>
<p>As mentioned above, using GitOps does not require any Kubernetes or cloud platform credentials to perform a deployment. An Argo CD or Flux CD within a Kubernetes cluster simply accesses the Git repository and updates it via Pull mode.</p>
<p>Git, on the other hand, is backed by strong cryptography for tracking and managing code changes, with the ability to sign changes to prove authorship and provenance, which is key to securing your cluster.</p>
<h3 id="git-as-the-single-source-of-truth">Git as the Single Source of Truth</h3>
<p>Because all of the declarative configuration of your application, including your infrastructure, is stored in Git, and you use Git as the only source of truth for your application, you can use the power of Git to manipulate everything, such as version control, history, auditing, rollbacks, and more, without having to use a tool like kubectl to do it.</p>
<h3 id="increase-productivity">Increase Productivity</h3>
<p>Git is also a tool that developers are very familiar with, and by iterating through Git, you can increase productivity, speed up development and deployment, and get new products out faster, while improving the stability and reliability of your system.</p>
<h3 id="easier-compliance-auditing">Easier Compliance Auditing</h3>
<p>Infrastructure using GitOps can be managed using Git just like any software project, so it can be audited for quality as well. When someone needs to make a change to the infrastructure, a Pull Request is created, and the change can be applied to the system only after a Code Review is performed by the appropriate people.</p>
<h2 id="summary">Summary</h2>
<p>GitOps complements the existing DevOps culture by using a version control system like Git to automate the deployment of infrastructure, with clear visibility into the deployment process and the ability to see and track any changes made to the system, improving productivity, security, and compliance. And GitOps provides more elegant observability, allowing you to see the state of your deployment in real time and take action to keep the actual state consistent with the desired state.</p>
<p>And in GitOps, the entire system is described declaratively, which naturally fits into cloud-native environments because Kubernetes is designed to do the same.</p>

    </div>

    
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/2022-07/go-ioc/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">IOC-golang&#39;s AOP principles and applications</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-07/k8s-pvc-resize/">
            <span class="next-text nav-default">kubernetes PVC supports resize scaling</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
