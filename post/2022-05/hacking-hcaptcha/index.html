<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Hacking HCaptcha through simulated clicks - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Learn how to hack HCaptcha by simulating clicks." /><meta name="keywords" content="Hcaptcha, Hacking, Selenium, YesCaptcha" />






<meta name="generator" content="Hugo 0.96.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-05/hacking-hcaptcha/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Hacking HCaptcha through simulated clicks" />
<meta property="og:description" content="Learn how to hack HCaptcha by simulating clicks." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-05/hacking-hcaptcha/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-05-31T12:19:11+08:00" />
<meta property="article:modified_time" content="2022-05-31T12:19:11+08:00" />

<meta itemprop="name" content="Hacking HCaptcha through simulated clicks">
<meta itemprop="description" content="Learn how to hack HCaptcha by simulating clicks."><meta itemprop="datePublished" content="2022-05-31T12:19:11+08:00" />
<meta itemprop="dateModified" content="2022-05-31T12:19:11+08:00" />
<meta itemprop="wordCount" content="2693">
<meta itemprop="keywords" content="Hcaptcha," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hacking HCaptcha through simulated clicks"/>
<meta name="twitter:description" content="Learn how to hack HCaptcha by simulating clicks."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Hacking HCaptcha through simulated clicks</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-05-31 12:19:11 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2693 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#hcaptcha">HCaptcha</a></li>
        <li><a href="#how-to-crack">How to crack</a></li>
        <li><a href="#yescaptcha">YesCaptcha</a></li>
        <li><a href="#code-base-implementation">Code base implementation</a>
          <ul>
            <li><a href="#encapsulation-of-recognition-methods">Encapsulation of recognition methods</a></li>
            <li><a href="#basic-framework">Basic framework</a></li>
            <li><a href="#iframe-toggle-support">iframe toggle support</a></li>
            <li><a href="#trigger-captcha">Trigger CAPTCHA</a></li>
            <li><a href="#find-the-recognition-target">Find the recognition target</a></li>
          </ul>
        </li>
        <li><a href="#captcha-recognition">Captcha recognition</a></li>
        <li><a href="#image-recognition">Image Recognition</a></li>
        <li><a href="#simulate-a-click">Simulate a click</a>
          <ul>
            <li><a href="#click-to-verify">Click to verify</a></li>
            <li><a href="#verify-the-result">Verify the result</a></li>
          </ul>
        </li>
        <li><a href="#code">Code</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>In the <a href="/post/2022-05/recaptcha-hack/">previous article</a> we introduced ReCaptcha&rsquo;s mock click crack tutorial, but in addition to ReCaptcha, there is another CAPTCHA that is very similar to ReCapacha&rsquo;s verification process, called <a href="https://www.hcaptcha.com/">HCaptcha</a>.</p>
<p>ReCaptcha is Google&rsquo;s, for some reason, we can not use ReCaptcha in China, so sometimes HCaptcha has become a better choice for some international sites.</p>
<p>So today we&rsquo;ll learn about HCaptcha and its simulated click cracking process.</p>
<h2 id="hcaptcha">HCaptcha</h2>
<p>Let&rsquo;s first take a look at HCaptcha&rsquo;s verification interaction flow, its Demo website is <a href="https://democaptcha.com/demo-form-eng/hcaptcha.html">https://democaptcha.com/demo-form-eng/hcaptcha.html</a>, after opening it, we can see the following CAPTCHA entry page.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/b7c9394349704a24aa0caae4aded58a4.png" alt="HCaptcha"></p>
<p>It looks very similar to ReCaptcha, and the verification process is also very similar.</p>
<p>When we click on the checkbox, Captcha will first determine the risk of the current user through its risk analysis engine, and if it is a low-risk user, it will pass directly, otherwise, Captcha will pop up a dialog box and let us answer the questions in the dialog box, similar to the following.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/e830bfa381c54b37894ce4d1fa0a4099.png" alt="HCaptcha"></p>
<p>At this point we see that the HCaptcha verification code will give us a question, for example, the above question is &ldquo;Please click on each picture containing an airplane&rdquo;, we need to select from the following nine pictures containing airplanes, if there are no airplanes in the nine pictures, then click the &ldquo;Skip / Skip&rdquo; button, if there are, then all pictures with airplanes will be selected, the skip button will become a &ldquo;Check / Verify&rdquo; button, after the verification is passed we can see the following effect of successful verification.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/a94489ec533747808d6d7cc16776294c.png" alt="HCaptcha successful"></p>
<p>Is the overall process very similar to ReCaptcha?</p>
<p>But in fact, this is simpler than ReCaptcha, its captcha image must be 3x3 each time, no 4x4, and after clicking a picture will not appear a new small picture for us to choose twice, so its cracking idea is also relatively simple.</p>
<h2 id="how-to-crack">How to crack</h2>
<p>The whole process actually we sort out a little, we know the overall idea of cracking, there are so two key points.</p>
<ul>
<li>The first is to find out the content of the text above, so that we know what to click on.</li>
<li>The second is that we need to know which target images and the text above is a match, to find the analog click in turn on the good.</li>
</ul>
<p>It sounds very simple, but the second point is a difficult one, how do we know which images match the text? This is a difficult problem.</p>
<p>We learned about using YesCaptcha for image recognition in the previous ReCaptcha hack. In addition to ReCaptcha, YesCaptcha actually supports HCaptcha&rsquo;s CAPTCHA recognition, so we can easily know which images and input content match using YesCaptcha.</p>
<p>Let&rsquo;s try it out.</p>
<h2 id="yescaptcha">YesCaptcha</h2>
<p>Before using the site we need to register first, the website address is <a href="https://yescaptcha.com/auth/register">https://yescaptcha.com/auth/register</a>, after registering an account you can get an account key in the background, that is, ClientKey, save the backup.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/e44058fcffb4406381401c56d2adb5d2.png" alt="YesCaptcha"></p>
<p>Then we can check out the <a href="https://yescaptcha.atlassian.net/wiki/spaces/YESCAPTCHA/pages/24543233/HCaptchaClassification+Hcaptcha">official documentation</a> here. There is an API that is described here, and the general content is like this.</p>
<p>First there is an API for creating tasks, the API address is <a href="https://api.yescaptcha.com/createTask">https://api.yescaptcha.com/createTask</a>. Then look at the request parameters.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/dd081e489f68446b8ccf372f2c596537.png" alt="yescaptcha createTask"></p>
<p>Here we need to pass in these parameters.</p>
<ul>
<li>type: the content is <code>HCaptchaClassification</code></li>
<li>queries: the corresponding Base64 encoding of the verification code, here directly into a list can be</li>
<li>question: the corresponding question ID, that is, the identification of the target code, here is actually the content of the entire sentence of the question</li>
<li>corrdinate: a control switch to return the result, the default will return the true / false result of each picture recognition, that is, whether the first x pictures and pictures match, if the parameter is added, then the API will return the index of the corresponding matching pictures.</li>
</ul>
<p>For example, here we can POST such a content to the server with the following structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;clientKey&#34;</span><span class="p">:</span> <span class="s2">&#34;cc9c18d3e263515c2c072b36a7125eecc078618f&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;task&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;HCaptchaClassification&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;queries&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8Uw...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8Uw...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="err">...</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8Uw...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;question&#34;</span><span class="p">:</span> <span class="s2">&#34;请单击每个包含卡车的图像。&#34;</span> <span class="c1">// Upload the whole sentence of the question directly
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The server then returns a response like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;errorId&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;errorCode&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;ready&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;solution&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;objects&#34;</span><span class="p">:</span> <span class="p">[</span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">]</span> <span class="c1">// 返回图片是否为目标,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;labels&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;truck&#34;</span><span class="p">,</span> <span class="s2">&#34;boat&#34;</span><span class="p">,</span> <span class="s2">&#34;boat&#34;</span><span class="p">,</span> <span class="s2">&#34;truck&#34;</span><span class="p">,</span> <span class="s2">&#34;truck&#34;</span><span class="p">,</span> <span class="s2">&#34;airplane-right&#34;</span><span class="p">,</span> <span class="s2">&#34;truck&#34;</span><span class="p">,</span> <span class="s2">&#34;truck&#34;</span><span class="p">]</span> <span class="c1">// 返回图片对应的标签
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;taskId&#34;</span><span class="p">:</span> <span class="s2">&#34;5aa8be0c-94a5-11ec-80d7-00163f00a53c&#34;</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see that the objects field in the solution field of the returned result contains a list of true and false, which represents whether each image matches the target or not.</p>
<p>Once we know this result, we just need to simulate the click on the image that returns true.</p>
<h2 id="code-base-implementation">Code base implementation</h2>
<p>Okay, so with the basic idea in mind, let&rsquo;s start implementing the whole process in Python. Here we&rsquo;ll take the <a href="https://democaptcha.com/demo-form-eng/hcaptcha.html">https://democaptcha.com/demo-form-eng/hcaptcha.html</a> website as a sample to explain the whole process of identifying and simulating clicks.</p>
<h3 id="encapsulation-of-recognition-methods">Encapsulation of recognition methods</h3>
<p>First we implement a wrapper around the above task API, and write a class to start with.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">app.settings</span> <span class="kn">import</span> <span class="n">CAPTCHA_RESOLVER_API_KEY</span><span class="p">,</span> <span class="n">CAPTCHA_RESOLVER_API_URL</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CaptchaResolver</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_url</span><span class="o">=</span><span class="n">CAPTCHA_RESOLVER_API_URL</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="n">CAPTCHA_RESOLVER_API_KEY</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">=</span> <span class="n">api_url</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">create_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">question</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start to recognize image for question </span><span class="si">{</span><span class="n">question</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;clientKey&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;task&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;HCaptchaClassification&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;queries&#34;</span><span class="p">:</span> <span class="n">queries</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;question&#34;</span><span class="p">:</span> <span class="n">question</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;captcha recogize result </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;error occurred while recognizing captcha&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>OK, here we define a class CaptchaResolver, and then mainly receive two parameters, one is <code>api_url</code>, which corresponds to the <a href="https://api.yescaptcha.com/createTask">https://api.yescaptcha.com/createTask</a> API address, and then there is another parameter is <code>api_key</code>, which is the ClientKey introduced in the previous article.</p>
<p>Then we define a create_task method that takes two parameters, the first one, queries, is the Base64 encoding of each captcha image, and the second one, <code>question</code>, is the whole sentence of the question to be recognized. Here the whole request is simulated with requests, and finally the corresponding JSON is returned.</p>
<h3 id="basic-framework">Basic framework</h3>
<p>OK, so let&rsquo;s use Selenium to simulate opening this example site, then simulate tapping to trigger the CAPTCHA, and then recognize the CAPTCHA.</p>
<p>First write a general framework.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.support.wait</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.remote.webelement</span> <span class="kn">import</span> <span class="n">WebElement</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">app.captcha_resolver</span> <span class="kn">import</span> <span class="n">CaptchaResolver</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">captcha_resolver</span> <span class="o">=</span> <span class="n">CaptchaResolver</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here we first initialize a Chrome operation object in the constructor, then call the corresponding get method to open the example website, and then declare a WebDriverWait object and a CaptchaResolver object to handle node lookup and captcha recognition operations, respectively, as a backup.</p>
<h3 id="iframe-toggle-support">iframe toggle support</h3>
<p>The next step is to simulate a click on the Captcha entry to trigger the Captcha, right?</p>
<p>By looking at this captcha, we see that it is very similar to ReCaptcha in that the entry point is actually loaded in an iframe, and the corresponding iframe looks like this.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/4f113dace6e9494e8847a5da97237c61.png" alt="hcaptcha"></p>
<p>In addition, the pop-up captcha image is inside another iframe, as shown in the figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/dadbac919a3c49e4ab8644e105bfb5f2.png" alt="hcaptcha"></p>
<p>Selenium needs to switch to the corresponding iframe to find the node, otherwise it will not be able to find the corresponding node and simulate a click or something.</p>
<p>So here we define several tool methods to support switching to the corresponding iframe of the portal and the corresponding iframe of the CAPTCHA itself, with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_captcha_entry_iframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WebElement</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">default_content</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_entry_iframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;.h-captcha &gt; iframe&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">captcha_entry_iframe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">switch_to_captcha_entry_iframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_entry_iframe</span><span class="p">:</span> <span class="n">WebElement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_captcha_entry_iframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">captcha_entry_iframe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_captcha_content_iframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WebElement</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">default_content</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_content_iframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;//iframe[contains(@title, &#34;Main content&#34;)]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">captcha_content_iframe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">switch_to_captcha_content_iframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_content_iframe</span><span class="p">:</span> <span class="n">WebElement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_captcha_content_iframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">captcha_content_iframe</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In this case, we only need to call switch_to_captcha_content_iframe to find the content inside the captcha image and switch_to_captcha_entry_iframe to find the content inside the captcha entry.</p>
<h3 id="trigger-captcha">Trigger CAPTCHA</h3>
<p>OK, so the next step is to simulate a click on the captcha entry and then trigger the captcha, right, by simulating a click here.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/2f35b9bbe5f24cb3935b1168cae1a6b9.png" alt="CAPTCHA"></p>
<p>The implementation is simple and the code is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">trigger_captcha</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_captcha_entry_iframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s1">&#39;#anchor #checkbox&#39;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_entry</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_captcha_content_iframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">captcha_element</span><span class="p">:</span> <span class="n">WebElement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_captcha_element</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">captcha_element</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;trigged captcha successfully&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here we first call switch_to_captcha_entry_iframe to switch the iframe, then find the node corresponding to the entry box and click on it.</p>
<p>After clicking on it, we call switch_to_captcha_content_iframe to switch to the iframe corresponding to the captcha itself and find out if the node corresponding to the captcha itself has been loaded, and if it has, then it proves that the trigger is successful.</p>
<h3 id="find-the-recognition-target">Find the recognition target</h3>
<p>OK, so now the captcha might look like this.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/6ab0cc49036c4d7296b3b2f5bc14625c.png" alt="captcha"></p>
<p>So the next thing we need to do is two things, one thing is to find the match target, which is the question itself, and the second thing is to save each captcha and convert it to Base64 encoding.</p>
<p>Okay, so how do you find the question? Just use Selenium&rsquo;s regular node search.</p>
<p>By calling this method, we get the complete text of the question in the image above.</p>
<h2 id="captcha-recognition">Captcha recognition</h2>
<p>Next, we need to download and convert each image to Base64 encoding, and let&rsquo;s observe its HTML structure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/8762b16d008b41de8c6c67e8b661b7fc.png" alt="Captcha"></p>
<p>We can see that each captcha actually corresponds to a <code>.task-image</code> node, and then there is a <code>.image-wrapper</code> node inside, and inside there is a <code>.image</code> node, so how is the image rendered? Here it is set a style CSS style, through the CSS <code>backgroud</code> to set the address of the CAPTCHA image.</p>
<p>So, it&rsquo;s easy to extract the captcha image, we just need to find out the content of the style property of the <code>.image</code> node and extract the url from it.</p>
<p>After we get the URL, we turn down the Base64 encoding and use captcha_resolver to recognize the content.</p>
<p>So the code can be written as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">verify_captcha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># get target text</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">captcha_target_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_captcha_target_text</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s1">&#39;captcha_target_text </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">captcha_target_text</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># extract all images</span>
</span></span><span class="line"><span class="cl">    <span class="n">single_captcha_elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">visibility_of_all_elements_located</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s1">&#39;.task-image .image-wrapper .image&#39;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">resized_single_captcha_base64_strings</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">single_captcha_element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">single_captcha_elements</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">single_captcha_element_style</span> <span class="o">=</span> <span class="n">single_captcha_element</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;style&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;url\(&#34;(https.*?)&#34;\)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">match_result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">single_captcha_element_style</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">single_captcha_element_url</span> <span class="o">=</span> <span class="n">match_result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">match_result</span> <span class="k">else</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">f</span><span class="s1">&#39;single_captcha_element_url </span><span class="si">{</span><span class="n">single_captcha_element_url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CAPTCHA_SINGLE_IMAGE_FILE_PATH</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">single_captcha_element_url</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">resized_single_captcha_base64_string</span> <span class="o">=</span> <span class="n">resize_base64_image</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">CAPTCHA_SINGLE_IMAGE_FILE_PATH</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">resized_single_captcha_base64_strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">resized_single_captcha_base64_string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s1">&#39;length of single_captcha_element_urls </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">resized_single_captcha_base64_strings</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here we extract the url of each captcha image, which is matched using regular expressions. After extracting the url, we then store it in the resized_single_captcha_base64_strings list.</p>
<p>Here we have defined a separate method for Base64 encoding, passing in the image path and resizing, and then we can return the encoded result, defined as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">app.settings</span> <span class="kn">import</span> <span class="n">CAPTCHA_RESIZED_IMAGE_FILE_PATH</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">resize_base64_image</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">size</span>
</span></span><span class="line"><span class="cl">    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">new_img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">new_img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">CAPTCHA_RESIZED_IMAGE_FILE_PATH</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CAPTCHA_RESIZED_IMAGE_FILE_PATH</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">encoded_string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">encoded_string</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="image-recognition">Image Recognition</h2>
<p>Okay, so now that we can get the content of the question and the corresponding Base64 encoding for each image, we can directly use YesCaptcha for image recognition, with the following code call.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># try to verify using API</span>
</span></span><span class="line"><span class="cl"><span class="n">captcha_recognize_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">captcha_resolver</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">resized_single_captcha_base64_strings</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">captcha_target_text</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">captcha_recognize_result</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;count not get captcha recognize result&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="n">recognized_results</span> <span class="o">=</span> <span class="n">captcha_recognize_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;solution&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;objects&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">recognized_results</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;count not get captcha recognized indices&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If it runs properly, we may get the following return results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;errorId&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;errorCode&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;status&#34;</span><span class="p">:</span><span class="s2">&#34;ready&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;solution&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;objects&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">         <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;labels&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;boat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;seaplane&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;bicycle&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;train&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;boat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;train&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;boat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;boat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;bus&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;taskId&#34;</span><span class="p">:</span><span class="s2">&#34;25fee484-df63-11ec-b02e-c2654b11608a&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we can see that the objects field in sulution contains a list of true false, for example, the first true means that the first captcha is a match to the question, and the second false means that the second captcha image is a mismatch to the question. How do the serial number and the image correspond to each other? See the following figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/3833c01efb104dfeadc7459df6945180.png" alt="yescaptcha response"></p>
<p>Counting from left to right, line by line, the serial number in increasing order, for example, the first serial number in the first line is 0, then the result is the first result inside the objects result, true.</p>
<h2 id="simulate-a-click">Simulate a click</h2>
<p>Now we have got the true false list, we just need to extract the serial number of the result is true, and then click on these CAPTCHA small picture is good, the code is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># click captchas</span>
</span></span><span class="line"><span class="cl"><span class="n">recognized_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">recognized_results</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;recognized_indices </span><span class="si">{</span><span class="n">recognized_indices</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">click_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">visibility_of_all_elements_located</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s1">&#39;.task-image&#39;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">recognized_index</span> <span class="ow">in</span> <span class="n">recognized_indices</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">click_target</span><span class="p">:</span> <span class="n">WebElement</span> <span class="o">=</span> <span class="n">click_targets</span><span class="p">[</span><span class="n">recognized_index</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">click_target</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Of course, we can also simulate a click on each node by executing JavaScript, and the effect is similar.</p>
</blockquote>
<p>Here we use a for loop to turn the true false list into a list, and each element of the list represents the position of true in the list, which is actually the target of our click.</p>
<p>Then we get all the nodes corresponding to the small CAPTCHA images, and then we call the click method to click them in turn.</p>
<p>This way, we can recognize the CAPTCHA image one by one.</p>
<h3 id="click-to-verify">Click to verify</h3>
<p>Okay, so with the above logic, we can complete the entire HCaptcha recognition and point-and-click.</p>
<p>Finally, let&rsquo;s simulate clicking the validation button and we&rsquo;re done.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># after all captcha clicked</span>
</span></span><span class="line"><span class="cl"><span class="n">verify_button</span><span class="p">:</span> <span class="n">WebElement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_verify_button</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">verify_button</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">verify_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And the verfiy_button is extracted using Selenium as well.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_verify_button</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WebElement</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">verify_button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s1">&#39;.button-submit&#39;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">verify_button</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="verify-the-result">Verify the result</h3>
<p>After clicking on it, we can try to check the page changes to see if the validation was successful.</p>
<p>For example, the sign of successful validation is the appearance of a small green check mark.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/05/31/71851f5d655d4310ac9f5e4c8f5f338c.png" alt="HCaptcha successful"></p>
<p>The inspection method is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_is_successful</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_captcha_entry_iframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">anchor</span><span class="p">:</span> <span class="n">WebElement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">visibility_of_element_located</span><span class="p">((</span>
</span></span><span class="line"><span class="cl">        <span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s1">&#39;#anchor #checkbox&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">checked</span> <span class="o">=</span> <span class="n">anchor</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;aria-checked&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;checked </span><span class="si">{</span><span class="n">checked</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">checked</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here we switch the iframe first, and then check if the corresponding class is what we expect.</p>
<p>Finally, if the result of get_is_successful is True, then it means the recognition is successful, and the whole process is finished.</p>
<p>If the result is False, we can recursively call the above logic for a second time until the recognition is successful.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># check if succeed</span>
</span></span><span class="line"><span class="cl"><span class="n">is_succeed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_is_successful</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">is_succeed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;verifed successfully&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">verify_captcha</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="code">Code</h2>
<p>The above code may be complicated, so I&rsquo;ve organized the code here and put it on GitHub: <a href="https://github.com/Python3WebSpider/HCaptchaResolver">https://github.com/Python3WebSpider/HCaptchaResolver</a></p>
<p>Finally, it should be noted that the above verification code service is charged, each verification may cost a certain number of points, for example, to identify a 3x3 figure costs 10 points, while a recharge of a dollar will get 1000 points, so identify a penny, or relatively cheap.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/hcaptcha/">Hcaptcha</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-05/nodejs-copy-file/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Multiple ways to copy files and folders in nodejs</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-05/docker-compose-graceful-stop/">
            <span class="next-text nav-default">Gracefully shutting down services with docker-compose</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
