<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Using Go Swagger to generate OpenAPI definitions - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Learn how to use Go Swagger to generate OpenAPI definitions." /><meta name="keywords" content="golang, Swagger" />






<meta name="generator" content="Hugo 0.96.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-05/go-swagger/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Using Go Swagger to generate OpenAPI definitions" />
<meta property="og:description" content="Learn how to use Go Swagger to generate OpenAPI definitions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-05/go-swagger/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-05-20T13:17:30+08:00" />
<meta property="article:modified_time" content="2022-05-20T13:17:30+08:00" />

<meta itemprop="name" content="Using Go Swagger to generate OpenAPI definitions">
<meta itemprop="description" content="Learn how to use Go Swagger to generate OpenAPI definitions."><meta itemprop="datePublished" content="2022-05-20T13:17:30+08:00" />
<meta itemprop="dateModified" content="2022-05-20T13:17:30+08:00" />
<meta itemprop="wordCount" content="2153">
<meta itemprop="keywords" content="golang,swagger," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using Go Swagger to generate OpenAPI definitions"/>
<meta name="twitter:description" content="Learn how to use Go Swagger to generate OpenAPI definitions."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Using Go Swagger to generate OpenAPI definitions</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-05-20 13:17:30 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2153 words </span>
          <span class="more-meta"> 11 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents"></nav>
  </div>
</div>
    <div class="post-content">
      <p><a href="https://swagger.io/specification/">OpenAPI</a> (formerly known as Swagger) is the more popular protocol for defining HTTP APIs. However, the OpenAPI definition file is in a machine-friendly format that is not easy to write and read. Here is a method to generate OpenAPI definition files based on Go code using <a href="https://goswagger.io/">go-swagger</a>. This method uses only Go code to define the API, and does not force the Server or Client to use Go as well.</p>
<p>Currently <code>go-swagger</code> can only generate definitions in OpenAPI 2.0 format. This is also the format that is widely used now. <code>go-swagger</code> will support OpenAPI 3.0 in the future.</p>
<p>This article assumes familiarity with Go syntax and only explains the extensions to <code>go-swagger</code> in detail.</p>
<p>Suppose you want to create a set of APIs for a pet store that supports defining pets. This article shows how to use Go to define this API.</p>
<p>Although <code>go-swagger</code> does not require the use of a Go project, it is recommended to create a separate Go project for the API to facilitate the use of completions and code highlighting.</p>
<p>The first step is to define the basic information about the API, such as the name of the API, the protocol, the supported serialization formats, the base path, and some security information. This information is defined in the <code>petstore.go</code> file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// Package petstore The API of the pet store.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// The pet store is a demo service to show how to use go-swagger generate
</span></span></span><span class="line"><span class="cl"><span class="c1">// OpenAPI (Swagger) Spec.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Version: 1.0.0
</span></span></span><span class="line"><span class="cl"><span class="c1">// BasePath: /v1/petstore
</span></span></span><span class="line"><span class="cl"><span class="c1">// Schemes: https
</span></span></span><span class="line"><span class="cl"><span class="c1">// Consumes:
</span></span></span><span class="line"><span class="cl"><span class="c1">// - application/json
</span></span></span><span class="line"><span class="cl"><span class="c1">// Produces:
</span></span></span><span class="line"><span class="cl"><span class="c1">// - application/json
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:meta
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kn">package</span> <span class="nx">petstore</span>
</span></span><span class="line"><span class="cl"><span class="c1">//go:generate go run github.com/go-swagger/go-swagger/cmd/swagger@latest generate spec -o openapi.yaml
</span></span></span><span class="line"><span class="cl"><span class="c1">//go:generate go run github.com/go-swagger/go-swagger/cmd/swagger@latest validate openapi.yaml
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The package description, according to Go&rsquo;s specification, is to start with <code>Package petstore</code>. The remainder of that line, which is <code>The API of the pet store.</code> will be used as the <code>title</code> part of OpenAPI, and the rest of the non-<code>go-swagger</code> defined comments will be used as the <code>description</code> of OpenAPI.</p>
<p>Note: If the package description does not contain a <code>description</code> section, <code>go-swagger</code> will use the first line of what would otherwise be the <code>title</code> section as the <code>description</code> and leave the <code>title</code> blank. The OpenAPI file defined this way does not conform to the specification. So please write the two descriptions in full.</p>
<p>Starting at the <code>Version:</code> line is the definition of <code>go-swagger</code>. This section defines the rest of the base content of the generated OpenAPI file. The specific options available can be found in <a href="https://goswagger.io/use/spec/meta.html">swagger:meta</a>. The last line <code>swagger:meta</code> indicates that this comment is used in <code>go-swagger</code> to generate the base information.</p>
<p>The next two lines <code>go:generate</code> are used to generate the OpenAPI file. To ensure that no executable is missing during execution, <code>go run github.com/go-swagger/go-swagger/cmd/swagger@latest</code> is used to call <code>go-swagger</code>. If you can guarantee that the execution environment has <code>go-swagger</code> installed, the two lines <code>go run ...</code> can be simplified directly to <code>swagger</code>. This simplification will improve the speed of execution when generating.</p>
<p>To install <code>go-swagger</code>, you can refer to <a href="https://goswagger.io/install.html">official website</a>. If you have a Go environment, you can install it directly via <code>go install github.com/go-swagger/go-swagger/cmd/swagger@latest</code>. Note that you need to add <code>$GOPATH/bin</code> to <code>$PATH</code> for easy execution.</p>
<p>The first line <code>generate spec -o openapi.yaml</code> will generate the OpenAPI file based on the contents of the current directory. The second line <code>validate openapi.yaml</code> will verify that the OpenAPI file is compliant.</p>
<p>With this file, you can generate the OpenAPI file by executing <code>go generate .</code> to generate the OpenAPI file. The execution will generate:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ cat openapi.yaml 
</span></span><span class="line"><span class="cl">basePath: /v1/petstore
</span></span><span class="line"><span class="cl">consumes:
</span></span><span class="line"><span class="cl">- application/json
</span></span><span class="line"><span class="cl">info:
</span></span><span class="line"><span class="cl">  description: <span class="p">|</span>-
</span></span><span class="line"><span class="cl">    The pet store is a demo service to show how to use go-swagger generate
</span></span><span class="line"><span class="cl">    OpenAPI <span class="o">(</span>Swagger<span class="o">)</span> Spec.
</span></span><span class="line"><span class="cl">  title: The API of the pet store.
</span></span><span class="line"><span class="cl">  version: 1.0.0
</span></span><span class="line"><span class="cl">paths: <span class="o">{}</span>
</span></span><span class="line"><span class="cl">produces:
</span></span><span class="line"><span class="cl">- application/json
</span></span><span class="line"><span class="cl">schemes:
</span></span><span class="line"><span class="cl">- https
</span></span><span class="line"><span class="cl">swagger: <span class="s2">&#34;2.0&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We haven&rsquo;t defined any APIs yet, so the <code>paths</code> field is empty. We will add this field later step by step.</p>
<p>After that, define the API related to the Pet instance in the <code>pet.go</code> file.</p>
<p>First define the <code>Pet</code> structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// NewPet provides data to create a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">NewPet</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// The name of the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// min length: 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// max length: 64
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// example: Yuki
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`json:&#34;name&#34;`</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// The contact email for the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// min length: 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// max length: 64
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// example: person@domain.com
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// swagger:strfmt email
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">Contact</span> <span class="kt">string</span> <span class="s">`json:&#34;contact&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Pet provides data of a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">Pet</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// The pet id.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// example: 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">ID</span> <span class="kt">uint64</span> <span class="s">`json:&#34;id&#34;`</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// The name of the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// example: Yuki
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`json:&#34;name&#34;`</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// The contact email for the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// example: person@domain.com
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// swagger: strfmt email
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">Contact</span> <span class="kt">string</span> <span class="s">`json:&#34;contact&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>where <code>NewPet</code> is used to create and modify Pet data, and <code>Pet</code> is used to display Pet data. The two structures have some nuances, such as <code>NewPet</code> will not have <code>ID</code> information, and <code>Pet</code> does not need to define input restrictions. In simple scenarios, the structures can be combined into one structure, or <code>NewPet</code> can be embedded anonymously in <code>Pet</code> to simplify the structure.</p>
<p><code>swagger:model</code> is processed by <code>go-swagger</code> as a predefined structure and the definitions are placed in <code>definitions</code>. This structure will be reused across multiple API methods.</p>
<p><code>go-swagger</code> will generate the corresponding types based on the type of the Go structure. The annotation of each field can specify more detailed <a href="https://goswagger.io/use/spec/model.html#properties">value constraints</a>, such as <code>min length: 1</code> and <code>max length: 64</code> in the example, which agree that the length of the corresponding field string should be between <code>[ 1, 64]</code>. Further semantic constraints on the string values can also be made using <a href="https://goswagger.io/use/spec/strfmt.html"><code>swagger:strfmt</code></a>.</p>
<p>In order to return another structure when handling errors, it is also necessary to define the error structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Error</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">ID</span>     <span class="kt">string</span> <span class="s">`json:&#34;error_id&#34;`</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Detail</span> <span class="kt">string</span> <span class="s">`json:&#34;error_detail&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Simple structures can be used without writing all the information, even without marking <code>swagger:model</code>. <code>go-swagger</code> will automatically find the corresponding structure definition based on the definition of the method afterwards.</p>
<p>Once the structure for processing is defined, the specific operation methods can be defined. To cover the widest range of cases, here is an example of how to update a <code>Pet</code> method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// swagger:route POST /pets/{pet_id} pet UpdatePet
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Update data of a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// responses:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   200: PetReply
</span></span></span><span class="line"><span class="cl"><span class="c1">//   default: ErrorReply
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>swagger:route</code> is used to define a specific API method in the format <code>swagger:route &lt;method&gt; &lt;url&gt; &lt;tag&gt; ... &lt;operation id&gt;</code> . There can be zero or any number of <code>tags</code>, giving the method a number of tags. No matter how many <code>tags</code> there are, the last parameter <code>operation id</code> is the name of the method. This method name needs to be unique in an API definition file.</p>
<p>Specifically in the example, <code>swagger:router POST /pets/{pet_id} pet CreatePet</code> means the following.</p>
<ul>
<li>Follow the common API principle of defining the update method on the <code>POST /pets/{pet_id}</code> endpoint.
<ul>
<li>The path has an input parameter <code>pet_id</code>.</li>
</ul>
</li>
<li>Add the <code>pet</code> tag to this method.</li>
<li>The method name is <code>CreatePet</code>.</li>
</ul>
<p>This is followed by the method description information.</p>
<p><code>responses</code> is the return information that defines the <code>go-swagger</code>, and can be structured differently depending on the HTTP Code. The example returns a <code>PetReply</code> structure when the operation is normal, i.e. <code>Code 200</code>, and an <code>ErrorReply</code> structure in other cases.</p>
<p>Let&rsquo;s put aside the output structure and look at how to define the input structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// swagger:parameters UpdatePet RetrievePet DeletePet
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">PetIDArg</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// in: path
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">ID</span> <span class="kt">uint64</span> <span class="s">`json:&#34;pet_id&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// swagger:parameters CreatePet UpdatePet
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">NewPetArg</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">NewPet</span> <span class="o">*</span><span class="nx">NewPet</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>swagger:parameters</code> is used to define an input structure in the format <code>swagger:parameters &lt;operation id&gt; &lt;operation id&gt; ...</code> . where <code>operation id</code> is the name of the method that uses this input structure. Note that it is possible to have multiple input structures used on a single method, such as the example where both structures reference <code>UpdatePet</code>. Because the input to a method is not only the HTTP Post message, but also the information inside the URL and possibly even the Header. In order to reuse these structures, <code>go-swagger</code> can define different parts of the input into different structures and reference them to the same method.</p>
<p>In the example, <code>PetIDArg</code> defines the path parameter <code>pet_id</code> by <code>in: path</code>, where <code>pet_id</code> is defined by <code>json: &quot;pet_id&quot;</code>. Another structure <code>NewPetArg</code> defines the Post message structure <code>NewPet</code> via <code>in: body</code>, where <code>NewPet</code> is one of the structures described above.</p>
<p>This is followed by the output structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// PetReply returns a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">PetReply</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">Pet</span> <span class="o">*</span><span class="nx">Pet</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ErrorReply replys an error of API calling.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">ErrorReply</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">Error</span> <span class="nx">Error</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>swagger:response</code> is used to define an output structure. Its name is the same as <code>responses</code> defined by <code>swagger:route</code>. <code>in: body</code> indicates the corresponding field for the returned HTTP message.</p>
<p>This completes the definition of Pet&rsquo;s update method. It also explains most of the contents of <code>go-swagger</code>. You can directly execute <code>go generate .</code> or <code>swagger generate spec</code> to see the output. More details on using <code>go-swagger</code> to generate spec files can be found on the <a href="https://goswagger.io/use/spec.html">official website</a>.</p>
<p>As an example, the following <code>pet.go</code> file gives all the definitions for the Pet operation. Together with the previously mentioned <code>petstore.go</code> file, it can be used directly to generate the OpenAPI definitions for <code>petstore</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">petstore</span>
</span></span><span class="line"><span class="cl"><span class="c1">// NewPet provides data to create a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">NewPet</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// The name of the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// min length: 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// max length: 64
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// example: Yuki
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`json:&#34;name&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// The contact email for the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// min length: 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// max length: 64
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// example: person@domain.com
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// swagger:strfmt email
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Contact</span> <span class="kt">string</span> <span class="s">`json:&#34;contact&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Pet provides data of a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">Pet</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// The pet id.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// example: 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">ID</span> <span class="kt">uint64</span> <span class="s">`json:&#34;id&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// The name of the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// example: Yuki
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`json:&#34;name&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// The contact email for the pet.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// example: person@domain.com
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// swagger: strfmt email
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Contact</span> <span class="kt">string</span> <span class="s">`json:&#34;contact&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// swagger:parameters UpdatePet RetrievePet DeletePet
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">PetIDArg</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// in: path
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">ID</span> <span class="kt">uint64</span> <span class="s">`json:&#34;pet_id&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// swagger:parameters CreatePet UpdatePet
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">NewPetArg</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">NewPet</span> <span class="o">*</span><span class="nx">NewPet</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// PetReply returns a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">PetReply</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Pet</span> <span class="o">*</span><span class="nx">Pet</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// PetsReply returns a list of pets.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">PetsReply</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Pets</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Pet</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Error</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">ID</span>     <span class="kt">string</span> <span class="s">`json:&#34;error_id&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Detail</span> <span class="kt">string</span> <span class="s">`json:&#34;error_detail&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ErrorReply replys an error of API calling.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">ErrorReply</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Error</span> <span class="nx">Error</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">ErrorInput</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Error</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Fields</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Error</span> <span class="s">`json:&#34;error_fields&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ErrorInputReply replys an error with details of input data.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">type</span> <span class="nx">ErrorInputReply</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// in: body
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">ErrorInput</span> <span class="nx">ErrorInput</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// swagger:route GET /pets pet ListPet
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Get the list of pets.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// responses:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   200: PetsReply
</span></span></span><span class="line"><span class="cl"><span class="c1">//   default: ErrorReply
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:route POST /pets pet CreatePet
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Create a new pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// responses:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   200: PetReply
</span></span></span><span class="line"><span class="cl"><span class="c1">//   default: ErrorReply
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:route POST /pets/{pet_id} pet UpdatePet
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Update data of a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// responses:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   200: PetReply
</span></span></span><span class="line"><span class="cl"><span class="c1">//   default: ErrorReply
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:route GET /pets/{pet_id} pet RetrievePet
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Get data of a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// responses:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   200: PetReply
</span></span></span><span class="line"><span class="cl"><span class="c1">//   default: ErrorReply
</span></span></span><span class="line"><span class="cl"><span class="c1">// swagger:route DELETE /pets/{pet_id} pet DeletePet
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// Delete a pet.
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">// responses:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   200: PetReply
</span></span></span><span class="line"><span class="cl"><span class="c1">//   default: ErrorReply
</span></span></span></code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/golang/">golang</a>
          <a href="/tags/swagger/">swagger</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-05/rust-view-from-a-gopher/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">A Go developer&#39;s experience with Rust</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-05/go-netaddr-value/">
            <span class="next-text nav-default">The intern.Value property in the new Go 1.18 library netaddr</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
