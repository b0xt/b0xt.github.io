<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Why is the maximum length of VARCHAR in MySQL 65535? - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Explore why the maximum length of MySQL VARCHAR is 65535." /><meta name="keywords" content="mysql, Varchar 65535" />






<meta name="generator" content="Hugo 0.102.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-08/mysql-varchar/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Why is the maximum length of VARCHAR in MySQL 65535?" />
<meta property="og:description" content="Explore why the maximum length of MySQL VARCHAR is 65535." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-08/mysql-varchar/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-19T13:39:54+08:00" />
<meta property="article:modified_time" content="2022-08-19T13:39:54+08:00" />

<meta itemprop="name" content="Why is the maximum length of VARCHAR in MySQL 65535?">
<meta itemprop="description" content="Explore why the maximum length of MySQL VARCHAR is 65535."><meta itemprop="datePublished" content="2022-08-19T13:39:54+08:00" />
<meta itemprop="dateModified" content="2022-08-19T13:39:54+08:00" />
<meta itemprop="wordCount" content="1659">
<meta itemprop="keywords" content="mysql," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Why is the maximum length of VARCHAR in MySQL 65535?"/>
<meta name="twitter:description" content="Explore why the maximum length of MySQL VARCHAR is 65535."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Why is the maximum length of VARCHAR in MySQL 65535?</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-08-19 13:39:54 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1659 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#analysis">Analysis</a>
          <ul>
            <li><a href="#character-encoding">Character encoding</a></li>
            <li><a href="#row-record-format">Row Record Format</a></li>
          </ul>
        </li>
        <li><a href="#char-type-storage">CHAR type storage</a></li>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>CHAR and VARCHAR are commonly used data types for storing strings in MySQL. The official documentation describes the maximum length of CHAR as 255 and the maximum length of VARCHAR as 65535.</p>
<p>However, after operation, we found that the actual maximum &rsquo;length&rsquo; that VARCHAR can create is an indefinite value. This article will analyze this issue.</p>
<p>When we enter the table build statement <code>CREATE TABLE test( a VARCHAR(65535) NOT NULL)CHARSET=latin1;</code> in MySQL, MySQL returns us <code>Row size too large</code> error, which means MySQL does not support creating 65535 bytes long VARCHAR type. VARCHAR type of 65535 bytes.</p>
<p>However, we finally found out through testing that the maximum length that can be created is 65533. In order to better explain this phenomenon, we need to understand the internal storage method of MySQL.</p>
<h2 id="analysis">Analysis</h2>
<h3 id="character-encoding">Character encoding</h3>
<p>In computer, character encoding is to encode the characters in a character set into a certain object in a specified set according to the bit pattern, so that the text can be stored in the computer and passed through the network. The same character may have different sizes in different encoding methods, for example, the UTF-8 encoding of Chinese character &ldquo;我&rdquo; is <code>E68891</code>, which occupies three bytes, while the GBK encoding is <code>CED2</code>, which occupies only two bytes. In the variable length byte encoding, different characters occupy different lengths, for example, &ldquo;1&rdquo; in UTF-8 encoding is <code>35</code>, which occupies only one byte.</p>
<p>The way characters are stored in the database depends on the specific character encoding, since MySQL version 5.0, <strong>N in VARCHAR(N) or CHAR(N) refers to the maximum number of characters stored</strong> , not the maximum number of bytes. If we set the encoding of the table to <code>utf8mb4</code>, then the column will take up N~4N bytes of space, and MySQL will estimate the worst-case input space when creating the table, at which point the maximum number of characters we can create is 65533/4 = 16383.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">mysql&gt; CREATE TABLE test<span class="o">(</span> a VARCHAR<span class="o">(</span>16384<span class="o">)</span> NOT NULL<span class="o">)</span><span class="nv">CHARSET</span><span class="o">=</span>utf8mb4<span class="p">;</span>
</span></span><span class="line"><span class="cl">ERROR <span class="m">1074</span> <span class="o">(</span>42000<span class="o">)</span>: Column length too big <span class="k">for</span> column <span class="s1">&#39;a&#39;</span> <span class="o">(</span><span class="nv">max</span> <span class="o">=</span> 16383<span class="o">)</span><span class="p">;</span> use BLOB or TEXT instead
</span></span><span class="line"><span class="cl">mysql&gt; CREATE TABLE test<span class="o">(</span> a VARCHAR<span class="o">(</span>16383<span class="o">)</span> NOT NULL<span class="o">)</span><span class="nv">CHARSET</span><span class="o">=</span>utf8mb4<span class="p">;</span>
</span></span><span class="line"><span class="cl">Query OK, <span class="m">0</span> rows affected <span class="o">(</span>0.18 sec<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="row-record-format">Row Record Format</h3>
<p>Records are stored as rows in MySQL, and each 16KB-sized page can hold 2 to 200 row records. MySQL 5.0 introduced the row record format <code>Compact</code> as the default storage format. After that, <code>Compressed</code> and <code>Dynamic</code> row record formats were introduced, but they are actually the same storage format.</p>
<ol>
<li>the header is a list of length records of a non-NULL variable-length column and is stored in reverse order.
<ul>
<li>If the length of the column is less than or equal to 255 bytes, it is represented by 1 byte.</li>
<li>If the length of the column is greater than 255 bytes, it is represented by 2 bytes.</li>
</ul>
</li>
<li>the second part is the NULL flag, indicating whether a column in the row is a NULL value, with 1, the NULL flag is also indefinite, if all the columns are set to NOT NULL when the table is built, then the NULL flag will not exist.</li>
<li>followed by Record Header, which is fixed to occupy 5 bytes.</li>
<li>if the primary key is not identified when the table is created, then MySQL automatically generates a RowID, which is 6 bytes long.</li>
<li>Finally, there are two hidden columns, TransactionID, which records the transaction ID of the last time the row was modified and is 6 bytes long, and Roll Pointer, which is a rollback pointer and is 7 bytes long.</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/19/417efc6307494e53ad424ebfc590df42.png" alt="Row Record Format"></p>
<p>The maximum length of a variable-length column record in the header is two bytes. 65535 is the maximum value that can be represented by a 16-bit binary number and the maximum value that can be stored in a variable-length field, so MySQL theoretically supports VARCHAR type columns of this length to store data. However, the official document <a href="https://dev.mysql.com/doc/refman/8.0/en/column-count-limit.html">Limits on Table Column Count and Row Size</a> states that MySQL rows have a 65,535-byte and that this feature is independent of the storage engine, even if we choose a storage engine that can support larger rows. That is, the <strong>maximum row length limits the length of columns</strong> .</p>
<p>For this reason, we can assume that the formula for calculating the length of rows in MySQL is: the sum of the lengths of all columns + the length of the record length list + the length of the NULL flag bit, and the space occupied by the fixed-length Record Header and hidden columns is not counted. Suppose there is a table with encoding <code>latin1</code>, the length of a field is defined as 65530, and its length token occupies two bytes, the length of b field is defined as 2, and its length token occupies one byte, the total is exactly 65535 bytes. If the b field length is defined as 3, which exceeds the maximum row length limit, then the table cannot be created successfully.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_max_size</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">65530</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="n">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ERROR</span><span class="w"> </span><span class="mi">1118</span><span class="w"> </span><span class="p">(</span><span class="mi">42000</span><span class="p">):</span><span class="w"> </span><span class="k">Row</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="k">large</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">counting</span><span class="w"> </span><span class="n">BLOBs</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">65535</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="k">storage</span><span class="w"> </span><span class="n">overhead</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">manual</span><span class="p">.</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="k">some</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">BLOBs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_max_size</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">65530</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="n">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">14</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Regarding the length of the NULL flag bit, if a row has nine columns, the first column is NULL and the other columns are not empty, then the NULL flag bit stores 0x01, which uses only one byte, and the ninth column is truncated in the flag bit to save some space. If all columns of the row data are not empty, MySQL will store 0x00 in the flag bit, which also takes up one byte, but will not be counted in the total length of the row data. The formula for calculating the length of the NULL flag bit can be derived from this: the position of the last NUUL column is N, and size = (N + 7)/8.</p>
</blockquote>
<h2 id="char-type-storage">CHAR type storage</h2>
<p>It is commonly understood that VARCHAR is the type of character that stores variable length and CHAR is the type of character that stores fixed length. In MySQL, the length of a fixed-length column is not stored in each row of data, but is defined at the table level. However, in multi-byte encoded character sets, the data stored inside a CHAR type column may not be of a fixed length.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_char_size</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">test_char_size</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="s2">&#34;abc&#34;</span><span class="p">,</span><span class="s2">&#34;我&#34;</span><span class="p">),(</span><span class="s2">&#34;abc&#34;</span><span class="p">,</span><span class="s2">&#34;我我我我我&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Records</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="n">Duplicates</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">Warnings</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>We inserted two rows of data into the utf8mb4 encoded table and used the hexdump utility to see how the row records are stored in the <code>test_char_size.ibd</code> binary storage file.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/19/edda605ffcb04b63886ee35820421d3a.png" alt="binary storage file"></p>
<p>The storage of row data starts at address 00010079. The contents have been organized for ease of understanding.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">// Row 1 Recorded value
</span></span><span class="line"><span class="cl">0a 03                                           // Variable-length column length list, stored in reverse order
</span></span><span class="line"><span class="cl">00 00 10 00 27                                  // Recoder Header
</span></span><span class="line"><span class="cl">00 00 00 00 02 0c                               // RowID
</span></span><span class="line"><span class="cl">00 00 00 00 10 33                               // TxID 
</span></span><span class="line"><span class="cl">82 00 00 00 c5 01 10                            // Roll Pointer
</span></span><span class="line"><span class="cl">61 62 63                                        // Column a Record value: &#34;abc&#34;
</span></span><span class="line"><span class="cl">e6 88 91 20 20 20 20 20 20 20                   // Column b record value: &#34;我&#34;, the remaining part is completed with 0x20
</span></span><span class="line"><span class="cl">// Row 2 Record value
</span></span><span class="line"><span class="cl">0f 03                                           // Variable-length column length list, stored in reverse order
</span></span><span class="line"><span class="cl">00 00 18 ff ca                                  // Recoder Header
</span></span><span class="line"><span class="cl">00 00 00 00 02 0d                               // RowID
</span></span><span class="line"><span class="cl">00 00 00 00 10 33                               // TxID 
</span></span><span class="line"><span class="cl">82 00 00 00 c5 01 1f                            // Roll Pointer
</span></span><span class="line"><span class="cl">61 62 63                                        // Column a Record value: &#34;abc&#34;
</span></span><span class="line"><span class="cl">e6 88 91 e6 88 91 e6 88 91 e6 88 91 e6 88 91    // Column b record value: &#34;我我我我我&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>From the above diagram, you can see more clearly the format of MySQL storing row data. Although CHAR(N) is a fixed-length data type, it may be stored internally as a variable-length column, and InnoDB records the true length of the column, and completes it with spaces (0x20) if it is less than N. You need to pay extra attention to this when calculating the total length of row data.</p>
<h2 id="summary">Summary</h2>
<p>The maximum length of rows in MySQL and the maximum length of VARCHAR columns in InnoDB are both 65535, but there are also some uncertain data in the rows, and the space occupied by these data needs to be calculated in the row length, which leads to the VARCHAR columns cannot be filled. Besides, the non-single-byte encoded VHAR columns also need extra space to store the column length, and although the problem of overflow beyond the row length is rarely encountered in practical situations, extra attention should be paid to the way the data is stored.</p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://wingsxdu.com/posts/database/mysql/varchar-less-than-65535/">https://wingsxdu.com/posts/database/mysql/varchar-less-than-65535/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Character_encoding">Character encoding</a></li>
<li><a href="https://www.wingsxdu.com/post/database/mysql/mysq-utf8-utf8mb4/">UTF-8 encoding vs. utf8, utf8mb4 in MySQL</a></li>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/char.html">The CHAR and VARCHAR Types</a></li>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/column-count-limit.html">Limits on Table Column Count and Row Size</a></li>
<li><a href="https://stackoverflow.com/questions/7124029/mysql-varchar-size">MySQL VARCHAR size?</a></li>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-row-format.html">InnoDB Row Formats</a></li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/mysql/">mysql</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-08/mysql-index/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Index design principles for relational databases</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-08/float-precision-problem/">
            <span class="next-text nav-default">Why do Floating-point arithmetic have precision problems</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
