<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Google C&#43;&#43; Style Excerpt Notes - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="This article is an excerpt from Google C&#43;&#43; Style." /><meta name="keywords" content="Google C&#43;&#43; Style" />






<meta name="generator" content="Hugo 0.102.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-08/google-cpp-style/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Google C&#43;&#43; Style Excerpt Notes" />
<meta property="og:description" content="This article is an excerpt from Google C&#43;&#43; Style." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-08/google-cpp-style/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-15T10:35:37+08:00" />
<meta property="article:modified_time" content="2022-08-15T10:35:37+08:00" />

<meta itemprop="name" content="Google C&#43;&#43; Style Excerpt Notes">
<meta itemprop="description" content="This article is an excerpt from Google C&#43;&#43; Style."><meta itemprop="datePublished" content="2022-08-15T10:35:37+08:00" />
<meta itemprop="dateModified" content="2022-08-15T10:35:37+08:00" />
<meta itemprop="wordCount" content="1432">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Google C&#43;&#43; Style Excerpt Notes"/>
<meta name="twitter:description" content="This article is an excerpt from Google C&#43;&#43; Style."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Google C&#43;&#43; Style Excerpt Notes</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-08-15 10:35:37 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1432 words </span>
          <span class="more-meta"> 7 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#inline-functions">Inline functions</a></li>
        <li><a href="#try-not-to-use-fully-naked-global-functions">Try not to use fully naked global functions</a></li>
        <li><a href="#be-careful-where-you-declare-variables">Be careful where you declare variables</a></li>
        <li><a href="#prohibit-the-use-of-static-or-global-variables-of-class-type">Prohibit the use of static or global variables of class type</a></li>
        <li><a href="#initialization-of-classes">Initialization of classes</a></li>
        <li><a href="#copyable-and-moveable-types">Copyable and moveable types</a></li>
        <li><a href="#overloading-operators">Overloading operators</a></li>
        <li><a href="#not-using-c-exceptions">Not using C++ exceptions</a></li>
        <li><a href="#try-to-use-c-type-conversions">Try to use C++ type conversions</a></li>
        <li><a href="#the-prefix-self-increment-i-self-subtract-operator-should-be-used">The prefix self-increment (++i), self-subtract operator should be used</a></li>
        <li><a href="#dont-use-unsigned-integers">Don&rsquo;t use unsigned integers</a></li>
        <li><a href="#replace-define-with-const-enum-inline-as-much-as-possible">Replace #define with const, enum, inline as much as possible</a></li>
        <li><a href="#for-naming-convention-and-code-style">For naming convention and code style</a></li>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Why this excerpt? Because when I was learning C++ code, I found that its functional advantages were too powerful and that there were no strong restrictions on writing code, and C++ has actually carried a lot of old-world atmosphere after decades of iteration, which has led to different habits of people from different backgrounds writing C++ code in different times, so I wanted to learn as much as possible from how good teams write C++ code, so I wrote this one excerpt.</p>
<h2 id="inline-functions">Inline functions</h2>
<p>Define a function as inline only if it has 10 lines or less.</p>
<p>Abuse of inlining will cause the program to become slower. Inline may increase or decrease the amount of target code, depending on the size of the inline function. Inline is very short
A small store-and-fetch function will usually reduce the code size, but inlining a fairly large function will dramatically increase the code size.</p>
<p>Also do not inline functions that contain loops or switch statements, dummy functions, and recursive functions, as these functions are usually not well inlined.</p>
<h2 id="try-not-to-use-fully-naked-global-functions">Try not to use fully naked global functions</h2>
<p>Placing non-member functions in the namespace avoids polluting the global scope. This is actually quite important, as it reduces unnecessary coupling and link-time dependencies.</p>
<h2 id="be-careful-where-you-declare-variables">Be careful where you declare variables</h2>
<p>It is generally advisable to declare variables in the smallest possible scope, as close to the first use as possible. This makes it easier for the code viewer to locate where the variable is declared and to understand the type and initial value of the variable.</p>
<p>However, there are some exceptions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Inefficient implementation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Foo</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Constructors and destructors are called 1000000 times each!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">f</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If the variable is an object, its constructor is called every time it enters scope, and its destructor is called every time it exits scope. It is much more efficient to declare such variables outside of the loop scope.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Constructors and destructors are called only 1 time
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Foo</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="prohibit-the-use-of-static-or-global-variables-of-class-type">Prohibit the use of static or global variables of class type</h2>
<p>The order of constructors, destructors, and initialization of global variables of class types is indeterminate in C++, even changing with build changes, leading to hard-to-detect bugs, and the destructor order is also indeterminate.</p>
<h2 id="initialization-of-classes">Initialization of classes</h2>
<p>If member variables are defined in a class, you must provide an initialization function or define a constructor for each class in the class. If a constructor is not declared, the
The compiler will generate a default constructor, which may cause some members to be uninitialized or initialized to inappropriate values.</p>
<p>This is unlike java or go, which have a default initialization value, but C++ does not, so if your class has member variables that are not initialized inside the class, and no other constructor is provided, you must define a default constructor (without arguments). It makes more sense to initialize the internal state of the object to a consistent/valid value.</p>
<h2 id="copyable-and-moveable-types">Copyable and moveable types</h2>
<p>If your types require it, make them support copy/move. Otherwise, disable copy and move functions that are implicitly generated.</p>
<p>Copy/move constructors generally have their specific uses, such as making code cleaner and performing better, but they are implicit operations that can often be confusing and ignored. If your class does not need copy/move operations, disable them explicitly by = delete or other means.</p>
<h2 id="overloading-operators">Overloading operators</h2>
<p>Do not overload operators except in a few specific circumstances.</p>
<p>To make the code look more intuitive, classes behave like built-in types (e.g. int) can use operators like + and /. But this implicit operation tends to confuse you by making you think that a time-consuming operation is as light as manipulating a built-in type. And it&rsquo;s much harder to locate the call point of an overloaded operator; it&rsquo;s obviously easier to find Equals() than the corresponding == call point.</p>
<p>So, in general, do not overload operators. In particular, the assignment operator (operator=) is weird and should be avoided. If necessary, you can define functions like Equals(), CopyFrom(), etc.</p>
<h2 id="not-using-c-exceptions">Not using C++ exceptions</h2>
<p>When I was writing java projects, I used to use exceptions to handle errors, and then wrap a big try catch in the outer layer to catch them, which meant that you had to check all the call points to use the exceptions, otherwise you&rsquo;d just watch the exceptions run happily all the way up and eventually break the whole program.</p>
<p>Exceptions also tend to disrupt the flow of execution and are difficult to determine, and functions may return in places you didn&rsquo;t expect. And abusing exceptions can encourage developers to catch &ldquo;pseudo-exceptions&rdquo; that are out of place or already unrecoverable.</p>
<p>Instead, we can use error codes, assertions, and other actions to keep our programs running properly.</p>
<h2 id="try-to-use-c-type-conversions">Try to use C++ type conversions</h2>
<p>Many people prefer to use C-style type conversions int y = (int)x or int y = int(x) in C++ code. But the problem with C type conversions is that they are ambiguous; sometimes they are doing forced conversions (like (int)3.5), sometimes they are doing type conversions (like (int) &ldquo;hello&rdquo;).</p>
<p>So we should.</p>
<ul>
<li>Replace C-style value conversions with static_cast, or when a class pointer needs to be explicitly converted up to a parent class pointer.</li>
<li>Remove the const qualifier with const_cast.</li>
<li>Use reinterpret_cast for unsafe interconversions between pointer types and integers or other pointers. Use only if you know everything you&rsquo;re doing.</li>
</ul>
<h2 id="the-prefix-self-increment-i-self-subtract-operator-should-be-used">The prefix self-increment (++i), self-subtract operator should be used</h2>
<p>The prefix self-increment (++i) is usually more efficient than the postfix self-increment (i++), regardless of the return value. This is because the postfix self-increment (or self-subtract) requires a copy of the value i of the expression. If i is an iterator or other non-numeric type, the cost of copying is higher, but this is only for custom types; for built-in types, most compilers optimize, so there is no difference in efficiency.</p>
<h2 id="dont-use-unsigned-integers">Don&rsquo;t use unsigned integers</h2>
<p>Do not use unsigned integers such as uint32_t unless you are representing a byte rather than a value, or you need to define a binary complement overflow. In particular, do not use unsigned types just to indicate that the value will never be negative. Instead, you should use assertions to protect the data.</p>
<p>Beware of integer type conversions and integer promotions (e.g., when operating with int and unsigned int, the former is promoted to unsigned int and may overflow), there are always unintended consequences.</p>
<p>Regarding unsigned integers.</p>
<p>Some people, including some textbook authors, recommend using unsigned types for non-negative numbers. However, in C, this advantage is overwhelmed by the bugs it causes. Look at the following example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="n">Length</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">...</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>The above loop never exits! Sometimes gcc finds this bug and alerts you, but most of the time it doesn&rsquo;t. A similar bug occurs when comparing signed variables with unsigned variables.</p>
<h2 id="replace-define-with-const-enum-inline-as-much-as-possible">Replace #define with const, enum, inline as much as possible</h2>
<p>A lot of C++ code still retains its C-era habit of using macros, which are not as essential in C++ as they were in C. In C++, macros are not as essential as they were in C. Performance-critical code that used to be expanded with macros can now be replaced with inline functions, and macros that represent constants can be replaced with const variables.</p>
<p>As a common example, let&rsquo;s say we use the following macro.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#define PI 3.14
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>As in the case of the <code>PI</code> macro definition above, when the program is compiled, the compiler replaces all <code>PI</code> macro definitions in the source code with 3.14 during the preprocessing phase. the program is compiled in the preprocessing phase before the real compilation phase. <strong>In some compilers that apply this <code>PI</code> constant, if a compilation error is encountered, then this error message might mention 3.14 instead of <code>PI</code></strong>, which is confusing, especially if the project is large.</p>
<p>Anyway, be very careful when using macros, and try to replace them with inline functions, enumerations and constants.</p>
<h2 id="for-naming-convention-and-code-style">For naming convention and code style</h2>
<p>Different teams have different specifications and code styles, you should try to refer to the original project&rsquo;s to do, rather than adding a new style yourself, which will feel very strange when reading the code. In order to maintain consistency with the original style of the code, if you are not sure you should discuss with the original author of the code or the person in charge now.</p>
<h2 id="reference">Reference</h2>
<p><a href="http://staff.ustc.edu.cn/~tongwh/CG_2019/materials/Google%20C++%20Style%20Guide.pdf">http://staff.ustc.edu.cn/~tongwh/CG_2019/materials/Google%20C++%20Style%20Guide.pdf</a></p>

    </div>

    
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/2022-08/linux-virtual-file-system/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Linux Virtual File System</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-08/linux-anonymous-pages-reverse-mapping/">
            <span class="next-text nav-default">Reverse mapping of anonymous pages in Linux</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
