<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Match-Case in Python 3.10 - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Explore the Match-Case syntax in Python 3.10." /><meta name="keywords" content="python 3.10, Match-Case" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-08/python-match-case/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Match-Case in Python 3.10" />
<meta property="og:description" content="Explore the Match-Case syntax in Python 3.10." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-08/python-match-case/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-13T12:29:12+08:00" />
<meta property="article:modified_time" content="2022-08-13T12:29:12+08:00" />

<meta itemprop="name" content="Match-Case in Python 3.10">
<meta itemprop="description" content="Explore the Match-Case syntax in Python 3.10."><meta itemprop="datePublished" content="2022-08-13T12:29:12+08:00" />
<meta itemprop="dateModified" content="2022-08-13T12:29:12+08:00" />
<meta itemprop="wordCount" content="2429">
<meta itemprop="keywords" content="python," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Match-Case in Python 3.10"/>
<meta name="twitter:description" content="Explore the Match-Case syntax in Python 3.10."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Match-Case in Python 3.10</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-08-13 12:29:12 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2429 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#preface">Preface</a></li>
        <li><a href="#the-difference-between-switch-case-and-match-case">The difference between switch-case and match-case</a></li>
        <li><a href="#literal-mode">Literal mode</a></li>
        <li><a href="#capture-mode">Capture mode</a></li>
        <li><a href="#sequence-mode">Sequence mode</a></li>
        <li><a href="#wildcard-mode">Wildcard mode</a></li>
        <li><a href="#constant-value-mode">Constant value mode</a></li>
        <li><a href="#mapping-mode">Mapping mode</a></li>
        <li><a href="#class-mode">Class mode</a></li>
        <li><a href="#combination-or-mode">Combination (OR) mode</a></li>
        <li><a href="#the-as-pattern">The AS pattern</a></li>
        <li><a href="#adding-conditions-to-patterns">Adding conditions to patterns</a></li>
        <li><a href="#code">Code</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="preface">Preface</h2>
<p>Many Python core developers thought that Python didn&rsquo;t need to add <code>switch-case</code> syntax, because you could do the same thing with <code>if/elif/else</code>. In fact, Guido himself wasn&rsquo;t interested in this syntax either, so it wasn&rsquo;t until Python 3.10 that a new <code>match-case</code> was added.</p>
<p>This new syntax is called Structural Pattern Matching, and since there are a lot of new features, there are three PEPs to introduce it.</p>
<ul>
<li><a href="https://peps.python.org/pep-0634/">PEP 634 - Structural Pattern Matching: Specification</a>: Introduction to match syntax and supported patterns</li>
<li><a href="https://peps.python.org/pep-0635/">PEP 635 - Structural Pattern Matching: Motivation and Rationale</a>: Explaining the reasons for the design of the grammar</li>
<li><a href="https://peps.python.org/pep-0636/">PEP 636 - Structural Pattern Matching</a>: Tutorial: A tutorial. Introduction to concepts, syntax and semantics</li>
</ul>
<h2 id="the-difference-between-switch-case-and-match-case">The difference between switch-case and match-case</h2>
<p>Take a small example to compare. The following is a function that returns the corresponding type of error message by HTTP CODE, which is what we had to write in the previous example by if-determination.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">http_error</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Bad request&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Unauthorized&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Forbidden&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Not found&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Unknown status code&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Use the <code>match-case</code> syntax.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">http_error</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">match</span> <span class="n">status</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">400</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;Bad request&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">401</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;Unauthorized&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">403</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;Forbidden&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">404</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;Not found&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;Unknown status code&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>match</code> is followed by the variable to be matched, <code>case</code> is followed by the different conditions, and then the statement to be executed if the conditions are met. The last case is underlined to indicate the default match, so if the previous condition doesn&rsquo;t match, it will be executed in this case, which is equivalent to <code>else</code> before.</p>
<p>This is actually a typical <code>switch-case</code> usage, if only this, I also think there is really no need to add this new syntax, on the one hand, the code is not optimized, on the other hand, the indentation is more.</p>
<p>But the <code>match-case</code> syntax can do much more than the <code>switch-case</code> in C/Go languages, it is actually the <code>match-case</code> in Scala, Erlang, etc. It supports complex pattern matching, and I will demonstrate the flexibility and pythonic nature of this new syntax in detail with several pattern examples. I will then demonstrate the flexibility and pythonicity of this new syntax in detail with several pattern examples.</p>
<h2 id="literal-mode">Literal mode</h2>
<p>The above example is a literal pattern that uses the basic data structures that come with Python, such as strings, numbers, booleans, and None.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">match</span> <span class="n">number</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">case</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">case</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">case</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;two&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="capture-mode">Capture mode</h2>
<p>The target of an assignment that can match <strong>a single</strong>expression. For demonstration purposes, each example is put into a function with the variable to be matched following the match as an argument (capture_pattern.py).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">capture</span><span class="p">(</span><span class="n">greeting</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">match</span> <span class="n">greeting</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Hello!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Hi </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&#34;Santa&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If greeting is not null, it will be assigned to name, but note that if greeting is null, a NameError or UnboundLocalError error will be thrown because name has not been defined before.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">capture</span><span class="p">(</span><span class="s1">&#39;Alex&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Hi</span> <span class="n">Alex</span><span class="err">!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">capture</span><span class="p">(</span><span class="s1">&#39;Santa&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Hi</span> <span class="n">Santa</span><span class="err">!</span>
</span></span><span class="line"><span class="cl"><span class="n">Match</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">capture</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Hello</span><span class="err">!</span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="ne">UnboundLocalError</span>                         <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">cell</span> <span class="n">line</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">capture</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="ow">in</span> <span class="n">capture</span><span class="p">(</span><span class="n">greeting</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="mi">1</span> <span class="k">def</span> <span class="nf">capture</span><span class="p">(</span><span class="n">greeting</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2</span>     <span class="n">match</span> <span class="n">greeting</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="mi">3</span>         <span class="n">case</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="mi">4</span>             <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Hello!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="mi">5</span>         <span class="n">case</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="mi">6</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Hi </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">7</span>     <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&#34;Santa&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="mi">8</span>         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="ne">UnboundLocalError</span><span class="p">:</span> <span class="n">local</span> <span class="n">variable</span> <span class="s1">&#39;name&#39;</span> <span class="n">referenced</span> <span class="n">before</span> <span class="n">assignment</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="sequence-mode">Sequence mode</h2>
<p>You can use list or tuple format results in match, and you can also use <code>first, *rest = seq</code> pattern to unpack as in <a href="https://peps.python.org/pep-3132/">PEP 3132 - Extended Iterable Unpacking</a>. I&rsquo;ll use an example for this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">sequence</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">collection</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">others</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Got 1 and a nested sequence: </span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">others</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Got 1 and </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">z</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">nested</span> <span class="n">sequence</span><span class="p">:</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">others</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">nested</span> <span class="n">sequence</span><span class="p">:</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">others</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mi">2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that the following conditions must be met.</p>
<ol>
<li>the first element of this match condition needs to be 1, otherwise the match fails</li>
<li>the first case uses a list and unwrapping, the second case uses a tuple, which is actually the same as the list semantics, and the third is still a list</li>
</ol>
<p>If the pattern after the case is a single item, you can remove the parentheses and write it like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sequence2</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">match</span> <span class="n">collection</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">others</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Got 1 and a nested sequence: </span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">others</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Got 1 and </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">z</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But note that one of the <code>case 1, [x, *others]</code> cannot be removed from the brackets, and the logic of unpacking is changed by removing it, so be careful.</p>
<h2 id="wildcard-mode">Wildcard mode</h2>
<p>Use the single underscore <code>_</code> to match any result, <strong>but not to bind (not to assign to a variable or variables)</strong>. Example at the beginning.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">http_error</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">match</span> <span class="n">status</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span> <span class="c1"># 省略</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;Unknown status code&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The last <code>case _</code> is the wildcard pattern, and of course there can be multiple matches.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">wildcard</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Some pair&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">wildcard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">wildcard</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">wildcard</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">Some</span> <span class="n">pair</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The sequence mode mentioned earlier is also supported in <code>_</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">sequence2</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">collection</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="s2">&#34;z&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matches any sequence of length two or more that starts with &#34;a&#34; and ends with &#34;z&#34;.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matches any sequence of length two or more.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="o">*</span><span class="n">_</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matches a sequence of any length.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence2</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">matches</span> <span class="nb">any</span> <span class="n">sequence</span> <span class="n">of</span> <span class="n">length</span> <span class="n">two</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">that</span> <span class="n">starts</span> <span class="k">with</span> <span class="s2">&#34;a&#34;</span> <span class="ow">and</span> <span class="n">ends</span> <span class="k">with</span> <span class="s2">&#34;z&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence2</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">matches</span> <span class="nb">any</span> <span class="n">sequence</span> <span class="n">of</span> <span class="n">length</span> <span class="n">two</span> <span class="ow">or</span> <span class="n">more</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence2</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">matches</span> <span class="nb">any</span> <span class="n">sequence</span> <span class="n">of</span> <span class="n">length</span> <span class="n">two</span> <span class="ow">or</span> <span class="n">more</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">sequence2</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">matches</span> <span class="n">a</span> <span class="n">sequence</span> <span class="n">of</span> <span class="nb">any</span> <span class="n">length</span><span class="o">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The use of wildcards requires attention to the logical order, placing those with small ranges in front and those with large ranges in the back to prevent them from not meeting expectations.</p>
<h2 id="constant-value-mode">Constant value mode</h2>
<p>This pattern mainly matches constant values or enum values of enum modules.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">RED</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">class</span> <span class="nc">NewColor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">YELLOW</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">constant_value</span><span class="p">(</span><span class="n">color</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">color</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Red&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">NewColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Yellow&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">new_color</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="n">new_color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">constant_value</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>  <span class="c1"># Match the first case</span>
</span></span><span class="line"><span class="cl"><span class="n">Red</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">constant_value</span><span class="p">(</span><span class="n">NewColor</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">)</span>  <span class="c1"># Match the second case</span>
</span></span><span class="line"><span class="cl"><span class="n">Yellow</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">constant_value</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>  <span class="c1"># Match the third case</span>
</span></span><span class="line"><span class="cl"><span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">constant_value</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># The constant values match the second case as well</span>
</span></span><span class="line"><span class="cl"><span class="n">Yellow</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">constant_value</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Other constants</span>
</span></span><span class="line"><span class="cl"><span class="mi">10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note here that since case has a binding effect, you cannot use constants like YELLOW directly, like the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">YELLOW</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">constant_value</span><span class="p">(</span><span class="n">color</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">match</span> <span class="n">color</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="n">YELLOW</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Yellow&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is the wrong syntax.</p>
<h2 id="mapping-mode">Mapping mode</h2>
<p>is actually a case followed by support for matching using a dictionary.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">mapping</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">config</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">{</span><span class="s1">&#39;sub&#39;</span><span class="p">:</span> <span class="n">sub_config</span><span class="p">,</span> <span class="o">**</span><span class="n">rest</span><span class="p">}:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sub: </span><span class="si">{</span><span class="n">sub_config</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OTHERS: </span><span class="si">{</span><span class="n">rest</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">{</span><span class="s1">&#39;route&#39;</span><span class="p">:</span> <span class="n">route</span><span class="p">}:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROUTE: </span><span class="si">{</span><span class="n">route</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">mapping</span><span class="p">({})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">mapping</span><span class="p">({</span><span class="s1">&#39;route&#39;</span><span class="p">:</span> <span class="s1">&#39;/auth/login&#39;</span><span class="p">})</span>  <span class="c1"># Match the first case</span>
</span></span><span class="line"><span class="cl"><span class="n">ROUTE</span><span class="p">:</span> <span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">login</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># # Match dictionaries with sub keys, values are bound to sub_config and the rest of the dictionary is bound to rest</span>
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">mapping</span><span class="p">({</span><span class="s1">&#39;route&#39;</span><span class="p">:</span> <span class="s1">&#39;/auth/login&#39;</span><span class="p">,</span> <span class="s1">&#39;sub&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>  <span class="c1"># Match the second case</span>
</span></span><span class="line"><span class="cl"><span class="n">Sub</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">OTHERS</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;route&#39;</span><span class="p">:</span> <span class="s1">&#39;/auth/login&#39;</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="class-mode">Class mode</h2>
<p>Any object is supported as a match after case. Let&rsquo;s start with an error example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">class_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Point(</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">class_pattern</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Input</span> <span class="n">In</span> <span class="p">[],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">cell</span> <span class="n">line</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">class_pattern</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Input</span> <span class="n">In</span> <span class="p">[],</span> <span class="ow">in</span> <span class="n">class_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="mi">1</span> <span class="k">def</span> <span class="nf">class_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2</span>     <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">3</span>         <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="mi">4</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Point(</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="ne">TypeError</span><span class="p">:</span> <span class="n">Point</span><span class="p">()</span> <span class="n">accepts</span> <span class="mi">0</span> <span class="n">positional</span> <span class="n">sub</span><span class="o">-</span><span class="n">patterns</span> <span class="p">(</span><span class="mi">2</span> <span class="n">given</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is because for matching, the <strong>position needs to be determined</strong> , so the position parameter needs to be used to identify it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">class_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;match&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">class_pattern</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">match</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Another solution to this custom class that doesn&rsquo;t use positional arguments for matching is to use <code>__match_args__</code> to return an array of positional arguments, like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="nd">@dataclass</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span> <span class="k">class</span> <span class="nc">Point2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">class_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Point(</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">Point2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Point2(</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">class_pattern</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">class_pattern</span><span class="p">(</span><span class="n">Point2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">Point2</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Point2 here uses the standard library&rsquo;s dataclasses.dataclass decorator, which provides the <code>__match_args__</code> property, so it can be used directly.</p>
<h2 id="combination-or-mode">Combination (OR) mode</h2>
<p>Multiple literals can be combined to represent an or relationship using <code>|</code>, and <code>|</code> can exist more than one within a case condition to represent multiple or relationships.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">or_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># 0,1,2 three numbers match</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;small number&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="nb">list</span><span class="p">()</span> <span class="o">|</span> <span class="nb">set</span><span class="p">():</span>  <span class="c1"># List or set matching</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list or set&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="nb">str</span><span class="p">()</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">():</span>  <span class="c1"># String or bytes match</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;str or bytes&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="n">Point2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>  <span class="c1"># Borrowing from the previous 2 classes, one of them can match</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">|</span> <span class="n">x</span><span class="p">:</span>  <span class="c1"># list and only one element or single value matches the</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that the <code>[x]</code> in <code>case [x] | x</code> is not triggered due to the matching order, and x cannot be a set, string, byte, etc., because it will not be matched in the previous conditions. Let&rsquo;s try it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">small</span> <span class="n">number</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">small</span> <span class="n">number</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">list</span> <span class="ow">or</span> <span class="nb">set</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nb">list</span> <span class="ow">or</span> <span class="nb">set</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="s1">&#39;sss&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="ow">or</span> <span class="nb">bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;sd&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="ow">or</span> <span class="nb">bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="n">Point2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">or_pattern</span><span class="p">({})</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Also, there is no case syntax for AND relationships in Python.</p>
<h2 id="the-as-pattern">The AS pattern</h2>
<p>The AS pattern was actually the Walrus pattern in the early days, but it was later discussed that using the <code>as</code> keyword would give the syntax an edge.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">as_pattern</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="nb">str</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Got str: </span><span class="si">{</span><span class="n">s</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">()</span> <span class="k">as</span> <span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Got int: </span><span class="si">{</span><span class="n">i</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">()</span> <span class="k">as</span> <span class="n">tu</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Got tuple: </span><span class="si">{</span><span class="n">tu</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="nb">list</span><span class="p">()</span> <span class="o">|</span> <span class="nb">set</span><span class="p">()</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">()</span> <span class="k">as</span> <span class="n">iterable</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Got iterable: </span><span class="si">{</span><span class="n">iterable</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">as_pattern</span><span class="p">(</span><span class="s1">&#39;sss&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="nb">str</span><span class="p">:</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;sss&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">as_pattern</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="nb">int</span><span class="p">:</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">as_pattern</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="nb">tuple</span><span class="p">:</span> <span class="n">tu</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">as_pattern</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="n">iterable</span><span class="p">:</span> <span class="n">iterable</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">as_pattern</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">Got</span> <span class="n">iterable</span><span class="p">:</span> <span class="n">iterable</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It should be noted that <code>[0, int() as i]</code> is a subpattern, that is, it contains patterns within patterns:<code>[0, int() as i]</code> is a sequence pattern for case matching, and where <code>int() as i</code> is a subpattern, it is an AS pattern.</p>
<p>Subpatterns are flexible to be combined inside the match syntax.</p>
<h2 id="adding-conditions-to-patterns">Adding conditions to patterns</h2>
<p>There is also support for adding if judgments (called guard) to patterns.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>     <span class="n">match</span> <span class="n">obj</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="p">]</span> <span class="k">if</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;east&#39;</span><span class="p">,</span> <span class="s1">&#39;north&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Right way&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="n">direction</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;west&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Wrong way&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>         <span class="n">case</span> <span class="p">[</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">_</span><span class="p">]</span> <span class="o">|</span> <span class="n">_</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Other way&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">go</span><span class="p">([</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">])</span>  <span class="c1"># Matching condition 1</span>
</span></span><span class="line"><span class="cl"><span class="n">Right</span> <span class="n">way</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">go</span><span class="p">(</span><span class="s1">&#39;west&#39;</span><span class="p">)</span>  <span class="c1"># Matching condition 2</span>
</span></span><span class="line"><span class="cl"><span class="n">Wrong</span> <span class="n">way</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">go</span><span class="p">(</span><span class="s1">&#39;north&#39;</span><span class="p">)</span>  <span class="c1"># Match default conditions</span>
</span></span><span class="line"><span class="cl"><span class="n">Other</span> <span class="n">way</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">:</span> <span class="n">go</span><span class="p">([</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">])</span>  <span class="c1"># Match default conditions</span>
</span></span><span class="line"><span class="cl"><span class="n">Other</span> <span class="n">way</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This allows the match to be judged further, which is equivalent to achieving some degree of AND effect.</p>
<h2 id="code">Code</h2>
<p>The code for this article can be found in the <a href="https://github.com/dongweiming/mp/tree/master/2022-08-12">mp</a> project.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          </div>
      <nav class="post-nav">
        
        <a class="next" href="/post/2022-08/flannel/">
            <span class="next-text nav-default">Flannel for Cloud-Native Virtual Networks</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
