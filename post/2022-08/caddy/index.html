<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Caddy, an out-of-the-box web server - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Learn how to install and use Caddy." /><meta name="keywords" content="Caddy" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-08/caddy/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Caddy, an out-of-the-box web server" />
<meta property="og:description" content="Learn how to install and use Caddy." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-08/caddy/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-10T10:08:20+08:00" />
<meta property="article:modified_time" content="2022-08-10T10:08:20+08:00" />

<meta itemprop="name" content="Caddy, an out-of-the-box web server">
<meta itemprop="description" content="Learn how to install and use Caddy."><meta itemprop="datePublished" content="2022-08-10T10:08:20+08:00" />
<meta itemprop="dateModified" content="2022-08-10T10:08:20+08:00" />
<meta itemprop="wordCount" content="1931">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Caddy, an out-of-the-box web server"/>
<meta name="twitter:description" content="Learn how to install and use Caddy."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Caddy, an out-of-the-box web server</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-08-10 10:08:20 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1931 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-caddy-features">1. Caddy Features</a></li>
        <li><a href="#2-caddy-tools-installation">2. Caddy Tools Installation</a></li>
        <li><a href="#3-getting-started-with-caddy">3. Getting Started with Caddy</a></li>
        <li><a href="#4-caddy-simple-demo">4. Caddy Simple Demo</a></li>
        <li><a href="#5-caddy-domain-encryption">5. Caddy Domain Encryption</a></li>
        <li><a href="#6-summary">6. Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>As we all know, the <code>Web</code> server is an indispensable basic service for <code>Web</code> development and is often used in development. Familiar open source <code>Web</code> servers are the well-known <code>Apache</code>, the powerful <code>Nginx</code>. The open source project we are going to introduce today is written in <code>Go</code> the up-and-coming &ldquo;: <strong><a href="https://caddyserver.com/">Caddy</a></strong> It has a download without installation can be used, zero configuration to achieve <code>HTTPS</code> and other characteristics, so in many excellent <code>Web</code> server to occupy a place.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/10/67ec4a5c0f2a4ff4b197f8b978420087.png" alt="Out-of-the-box web server"></p>
<p>In this era of <code>HTTPS</code> must-have, <code>Caddy</code> with no additional configuration automatically <code>HTTPS</code>, <code>HTTPS</code> site in minutes to complete the build, making it the preferred server for small and medium <code>Web</code> services. <code>Caddy</code> is very popular among open source enthusiasts, and has collected <code>42</code> thousand stars since it was open sourced in <code>2014</code>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/10/9c11e42f31b54a2c90c121f82d9fb110.png" alt="Caddy"></p>
<h2 id="1-caddy-features">1. Caddy Features</h2>
<blockquote>
<p><strong><code>Caddy</code> is a powerful, scalable platform for your sites, services and applications.</strong></p>
</blockquote>
<p>Use <code>Caddy</code> to quickly deploy <code>http(s)</code> sites or reverse proxy services on <code>Linux</code>, <code>Mac</code>, <code>Windows</code>. The following features are supported.</p>
<ul>
<li><code>HTTP/1.1</code> and <code>HTTP/2</code></li>
<li>Both <code>HTTPS</code> automatic issuance and manual management are accepted</li>
<li>Virtual hosting (multiple sites working on a single port)</li>
<li>Native <code>IPv4</code> and <code>IPv6</code> support</li>
<li>Static file distribution</li>
<li>Smooth restart/reload</li>
<li>Reverse proxy (<code>HTTP</code> or <code>WebSocket</code>)</li>
<li>Load balancing and health checks</li>
<li><code>Markdown</code> rendering</li>
<li>File browsing service</li>
<li>etc.</li>
</ul>
<p>Compared to traditional <code>Nginx</code> or <code>Apache</code>, <code>Caddy</code> has only one executable file, easy to install and less likely to have strange dependencies, a clear configuration file structure and simple syntax, and a modular architecture that allows you to quickly develop extensions using the <code>Go</code> language.</p>
<ul>
<li><strong>Easy configuration</strong> with the <a href="https://caddyserver.com/docs/caddyfile">Caddyfile</a></li>
<li><strong>Powerful configuration</strong> with its <a href="https://caddyserver.com/docs/json/">native JSON config</a></li>
<li><strong>Dynamic configuration</strong> with the <a href="https://caddyserver.com/docs/api">JSON API</a></li>
<li><a href="https://caddyserver.com/docs/config-adapters"><strong>Config adapters</strong></a> if you don&rsquo;t like JSON</li>
<li><strong>Automatic HTTPS</strong> by default
<ul>
<li><a href="https://zerossl.com/">ZeroSSL</a> and <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> for public names</li>
<li>Fully-managed local CA for internal names &amp; IPs</li>
<li>Can coordinate with other Caddy instances in a cluster</li>
<li>Multi-issuer fallback</li>
</ul>
</li>
<li><strong>Stays up when other servers go down</strong> due to TLS/OCSP/certificate-related issues</li>
<li><strong>Production-ready</strong> after serving trillions of requests and managing millions of TLS certificates</li>
<li><strong>Scales to tens of thousands of sites</strong> … and probably more</li>
<li><strong>HTTP/1.1, HTTP/2, and experimental HTTP/3</strong> support</li>
<li><strong>Highly extensible</strong> <a href="https://caddyserver.com/docs/architecture">modular architecture</a> lets Caddy do anything without bloat</li>
<li><strong>Runs anywhere</strong> with <strong>no external dependencies</strong> (not even libc)</li>
<li>Written in Go, a language with higher <strong>memory safety guarantees</strong> than other servers</li>
<li>Actually <strong>fun to use</strong></li>
<li>So, so much more to <a href="https://caddyserver.com/v2">discover</a></li>
</ul>
<h2 id="2-caddy-tools-installation">2. Caddy Tools Installation</h2>
<blockquote>
<p><strong>Using an Ubuntu machine, introducing automatic installation and manual installation!</strong></p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/10/8523cdf95e364597b7975a4f6189efb7.png" alt="Caddy"></p>
<ul>
<li>
<p>Docker</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># https://hub.docker.com/_/caddy</span>
</span></span><span class="line"><span class="cl">$ docker pull caddy
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Automatic installation</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Debian, Ubuntu, Raspbian</span>
</span></span><span class="line"><span class="cl">$ sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https
</span></span><span class="line"><span class="cl">$ curl -1sLf <span class="s1">&#39;https://dl.cloudsmith.io/public/caddy/stable/gpg.key&#39;</span> <span class="p">|</span> sudo gpg --dearmor -o $ /usr/share/keyrings/caddy-stable-archive-keyring.gpg
</span></span><span class="line"><span class="cl">$ curl -1sLf <span class="s1">&#39;https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt&#39;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/caddy-stable.list
</span></span><span class="line"><span class="cl">$ sudo apt update
</span></span><span class="line"><span class="cl">$ sudo apt install caddy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Fedora, RedHat, CentOS</span>
</span></span><span class="line"><span class="cl">$ dnf install <span class="s1">&#39;dnf-command(copr)&#39;</span>
</span></span><span class="line"><span class="cl">$ dnf copr <span class="nb">enable</span> @caddy/caddy
</span></span><span class="line"><span class="cl">$ dnf install caddy
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Manual compilation</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Go 1.17 or newer</span>
</span></span><span class="line"><span class="cl">$ git clone <span class="s2">&#34;https://github.com/caddyserver/caddy.git&#34;</span>
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> caddy/cmd/caddy/
</span></span><span class="line"><span class="cl">$ go build
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Manual Download</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># https://caddyserver.com/download</span>
</span></span><span class="line"><span class="cl">$ mv caddy_linux_amd64 caddy
</span></span><span class="line"><span class="cl">$ sudo chmod a+x caddy
</span></span><span class="line"><span class="cl">$ mv caddy /bin/caddy
</span></span><span class="line"><span class="cl">$ caddy version
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>The <code>caddy</code> installed by command line <code>apt</code> tool will generate part of the configuration file by itself, this way the service will be started after the installation is completed and will start automatically when booting.</p>
<ul>
<li>
<p>Configuration file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Service boot-up configuration</span>
</span></span><span class="line"><span class="cl">/lib/systemd/system/caddy.service.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configuration file contents</span>
</span></span><span class="line"><span class="cl">$ cat /lib/systemd/system/caddy.service
</span></span><span class="line"><span class="cl"><span class="o">[</span>Service<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/caddy run --environ --config /etc/caddy/Caddyfile
</span></span><span class="line"><span class="cl"><span class="nv">ExecReload</span><span class="o">=</span>/usr/bin/caddy reload --config /etc/caddy/Caddyfile --force
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The main configuration file for service startup</span>
</span></span><span class="line"><span class="cl">$ cat /etc/caddy/Caddyfile
</span></span><span class="line"><span class="cl">:80 <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Set this path to your site&#39;s directory.</span>
</span></span><span class="line"><span class="cl">        root * /usr/share/caddy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Enable the static file server.</span>
</span></span><span class="line"><span class="cl">        file_server
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Another common task is to set up a reverse proxy:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># reverse_proxy localhost:8080</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Binary file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># caddy</span>
</span></span><span class="line"><span class="cl">/usr/bin/caddy
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="3-getting-started-with-caddy">3. Getting Started with Caddy</h2>
<blockquote>
<p><strong>After the installation is complete, a brief introduction to basic usage!</strong></p>
</blockquote>
<p>Here we will start with <code>Caddy</code> common commands, then we will explain the configuration, and finally we will show you how to use <code>Caddy</code> to configure your website and go online with a real case.</p>
<ul>
<li>
<p>Common Commands</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ caddy
</span></span><span class="line"><span class="cl">Caddy is an extensible server platform.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">usage:
</span></span><span class="line"><span class="cl">caddy &lt;command&gt; <span class="o">[</span>&lt;args...&gt;<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">commands:
</span></span><span class="line"><span class="cl">adapt           指定配置文件 Adapts a config to Caddy native JSON
</span></span><span class="line"><span class="cl">add-package     添加扩展 Adds Caddy packages <span class="o">(</span>EXPERIMENTAL<span class="o">)</span>
</span></span><span class="line"><span class="cl">build-info      输出build信息 Prints information about this build
</span></span><span class="line"><span class="cl">environ         展示环境Prints the environment
</span></span><span class="line"><span class="cl">file-server     启动文件服务 Spins up a production-ready file server
</span></span><span class="line"><span class="cl">fmt             格式配置文件 Formats a Caddyfile
</span></span><span class="line"><span class="cl">hash-password   生成Hash密码 Hashes a password and writes base64
</span></span><span class="line"><span class="cl"><span class="nb">help</span>            帮助 Shows <span class="nb">help</span> <span class="k">for</span> a Caddy subcommand
</span></span><span class="line"><span class="cl">list-modules    列出已安装模块 Lists the installed Caddy modules
</span></span><span class="line"><span class="cl">reload          重载配置并重启 Changes the config of running Caddy instance
</span></span><span class="line"><span class="cl">remove-package  删除扩展 Removes Caddy packages <span class="o">(</span>EXPERIMENTAL<span class="o">)</span>
</span></span><span class="line"><span class="cl">reverse-proxy   启动反向代理 A quick and production-ready reverse proxy
</span></span><span class="line"><span class="cl">run             启动服务<span class="o">(</span>前台<span class="o">)</span> Starts the Caddy process
</span></span><span class="line"><span class="cl">start           启动服务<span class="o">(</span>后台<span class="o">)</span> Starts the Caddy process
</span></span><span class="line"><span class="cl">stop            停止服务 Gracefully stops a started Caddy process
</span></span><span class="line"><span class="cl">trust           添加信任 Installs a CA cert into <span class="nb">local</span> trust stores
</span></span><span class="line"><span class="cl">untrust         删除信任 Untrusts a locally-trusted CA certificate
</span></span><span class="line"><span class="cl">upgrade         升级版本 Upgrade Caddy <span class="o">(</span>EXPERIMENTAL<span class="o">)</span>
</span></span><span class="line"><span class="cl">validate        校验配置是否合法 Tests whether a config file is valid
</span></span><span class="line"><span class="cl">version         输出版本信息 Prints the version
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Use <span class="s1">&#39;caddy help &lt;command&gt;&#39;</span> <span class="k">for</span> more information about a command.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Full documentation is available at:
</span></span><span class="line"><span class="cl">https://caddyserver.com/docs/command-line
</span></span></code></pre></td></tr></table>
</div>
</div><p>The native configuration file of <code>Caddy</code> is in <code>JSON</code> format, but it provides <code>Caddyfile</code> as an interface for users to quickly configure site information, and at runtime <code>Caddy</code> will automatically convert <code>Caddyfile</code> configuration information to <code>JSON</code> configuration file. Caddyfile<code>is not as powerful as a</code>JSON` configuration file, but it is sufficient for users who do not need complex configuration.</p>
</li>
<li>
<p>Configuration file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># matcher stands for matcher</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If provided, this directive will only respond to the resource described by matcher</span>
</span></span><span class="line"><span class="cl">directive <span class="o">[</span>&lt;matcher&gt;<span class="o">]</span> &lt;args...&gt; <span class="o">{</span>
</span></span><span class="line"><span class="cl">    subdirective <span class="o">[</span>&lt;args...&gt;<span class="o">]</span> <span class="c1"># Sub-directives</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>File Structure</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/10/14639e1e96d94390b2f2f2a0bf485fa0.png" alt="File Structure"></p>
</li>
</ul>
<h2 id="4-caddy-simple-demo">4. Caddy Simple Demo</h2>
<blockquote>
<p><strong>Simple demo to explain configuration file writing and command tool usage</strong></p>
</blockquote>
<p>The following will demonstrate how to build a site with <code>Caddy</code> and deepen your understanding of the configuration format and command usage.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># 目录结构
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">├──&amp;nbsp;Caddyfile
</span></span><span class="line"><span class="cl">├──&amp;nbsp;index.html
</span></span><span class="line"><span class="cl">└──&amp;nbsp;public
</span></span><span class="line"><span class="cl">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;└──&amp;nbsp;HG.html
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!--&amp;nbsp;index.html&amp;nbsp;--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Hello<span class="ni">&amp;nbsp;</span>World!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>你好，世界！
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--&amp;nbsp;HG.html&amp;nbsp;--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>HelloGitHub<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>HelloGitHub
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Caddyfile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://localhost:3000 {
</span></span><span class="line"><span class="cl">    basicauth /public/* {
</span></span><span class="line"><span class="cl">        # 匹配localhost:3000/public/*的请求为加上登陆保护
</span></span><span class="line"><span class="cl">        # 用户名HG密码HelloGitHub
</span></span><span class="line"><span class="cl">        # 密码使用 caddy hash-passowrd 指令生成
</span></span><span class="line"><span class="cl">        HG JDJhJDE0JGxxxBNGJt
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # 设置当前站点根目录为当前文件夹，*表示匹配所有的请求
</span></span><span class="line"><span class="cl">    root * ./
</span></span><span class="line"><span class="cl">    templates
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # 配置当前站点为静态文件服务器，可用于博客系统的搭建
</span></span><span class="line"><span class="cl">    file_server {
</span></span><span class="line"><span class="cl">        # 隐藏所有的 .git 文件
</span></span><span class="line"><span class="cl">        hide .git
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:4000 {
</span></span><span class="line"><span class="cl">    # 配置反向代理(匹配请求转发到)
</span></span><span class="line"><span class="cl">    reverse_proxy /public/* http://localhost:3000
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># 启动服务</span>
</span></span><span class="line"><span class="cl">$<span class="p">&amp;</span>nbsp<span class="p">;</span>caddy<span class="p">&amp;</span>nbsp<span class="p">;</span>run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 测试</span>
</span></span><span class="line"><span class="cl">http://localhost:3000
</span></span><span class="line"><span class="cl">http://localhost:3000/public/HG.html
</span></span><span class="line"><span class="cl">http://localhost:4000
</span></span></code></pre></td></tr></table>
</div>
</div><p>In addition to an easy-to-understand configuration file approach, <code>Caddy</code> also provides interfaces for managing configuration. These interfaces make it easy to automate <code>Web</code> server administration, integrate releases and other advanced features.</p>
<ul>
<li><strong><code>POST /load</code></strong> Set or replace the active configuration</li>
<li><strong><code>POST /stop</code></strong> Stop the active configuration and exit the process</li>
<li><strong><code>GET /config/[path]</code></strong> Export the configuration to the specified path</li>
<li><strong><code>POST /config/[path]</code></strong> Set or replace object; append to array</li>
<li><strong><code>PUT /config/[path]</code></strong> Create a new object or insert into an array</li>
<li><strong><code>PATCH /config/[path]</code></strong> Replace an existing object or array element</li>
<li><strong><code>DELETE /config/[path]</code></strong> Delete the value of the specified path</li>
<li><strong>Use</strong> <code>@id</code> in <code>JSON</code> to easily traverse the configuration structure</li>
<li><strong><code>GET /reverse_proxy/upstreams</code></strong> Returns the current state of the configured proxy upstream</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/10/ba7b241178864b36ae5b944f7c52020c.png" alt="json"></p>
<h2 id="5-caddy-domain-encryption">5. Caddy Domain Encryption</h2>
<blockquote>
<p><strong>From scratch HTTPS site</strong></p>
</blockquote>
<ul>
<li>
<p><strong>Step 1</strong>: Install, use the command described above to install</p>
</li>
<li>
<p><strong>Step 2</strong>: Set the domain name resolution address, set it in the website where you bought the domain name, set <code>A</code> record.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># It takes a few minutes for the settings to take effect, so you can check if they take effect with the following command</span>
</span></span><span class="line"><span class="cl">$ curl<span class="p">&amp;</span>nbsp<span class="p">;</span><span class="s2">&#34;https://cloudflare-dns.com/dns-query?name=caddy.escapelife.site&amp;type=A&#34;</span><span class="p">&amp;</span>nbsp<span class="p">;</span>-H<span class="p">&amp;</span>nbsp<span class="p">;</span><span class="s2">&#34;accept:&amp;nbsp;application/dns-json&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>Step 3</strong> : Create the configuration file <code>Caddyfile</code> without the additional setting of <code>HTTPS</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Domain names and access returns</span>
</span></span><span class="line"><span class="cl">caddy.escapelife.site
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">respond<span class="p">&amp;</span>nbsp<span class="p">;</span><span class="s2">&#34;Hello HTTPS！&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>Step 4</strong> : Start and see the results</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Execute the command in the same directory</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Visit&amp;nbsp;caddy.escapelife.site&amp;nbsp;to check the effect</span>
</span></span><span class="line"><span class="cl">$ sudo caddy run
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="6-summary">6. Summary</h2>
<p>At this point you should have some idea about <code>Caddy</code>. Although its performance is not as good as <code>Nginx</code>, if we talk about how easy it is to get started, <code>Caddy</code> is much easier than <code>Nginx</code>. The main thing is that it is so convenient to enable <code>HTTPS</code> by default, you can open your website <code>HTTPS</code> for free, quickly and easily without having to worry about anything.</p>

    </div>

    
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/2022-08/react-err/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">React: useNavigate() may be used only in the context of a Router component</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-08/k8s-crossplane-vcluster/">
            <span class="next-text nav-default">Quickly build new clusters on Kubernetes with Crossplane and VCluster</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
