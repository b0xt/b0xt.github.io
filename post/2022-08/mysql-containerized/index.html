<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Does database MySQL need to be containerized? - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Explore whether database MySQL needs to be containerized." /><meta name="keywords" content="mysql, docker" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-08/mysql-containerized/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Does database MySQL need to be containerized?" />
<meta property="og:description" content="Explore whether database MySQL needs to be containerized." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-08/mysql-containerized/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-09T10:58:30+08:00" />
<meta property="article:modified_time" content="2022-08-09T10:58:30+08:00" />

<meta itemprop="name" content="Does database MySQL need to be containerized?">
<meta itemprop="description" content="Explore whether database MySQL needs to be containerized."><meta itemprop="datePublished" content="2022-08-09T10:58:30+08:00" />
<meta itemprop="dateModified" content="2022-08-09T10:58:30+08:00" />
<meta itemprop="wordCount" content="821">
<meta itemprop="keywords" content="mysql," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Does database MySQL need to be containerized?"/>
<meta name="twitter:description" content="Explore whether database MySQL needs to be containerized."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Does database MySQL need to be containerized?</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-08-09 10:58:30 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 821 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#data-security-issues">Data security issues</a></li>
        <li><a href="#performance-issues">Performance Issues</a>
          <ul>
            <li><a href="#database-program-and-data-separation">Database program and data separation</a></li>
            <li><a href="#run-lightweight-or-distributed-databases">Run lightweight or distributed databases</a></li>
            <li><a href="#rational-layout-application">Rational layout application</a></li>
          </ul>
        </li>
        <li><a href="#stateful-issues">Stateful issues</a></li>
        <li><a href="#resource-isolation">Resource Isolation</a></li>
        <li><a href="#cant-mysql-run-in-a-container">Can&rsquo;t MySQL run in a container?</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/09/4261d88fd81949ee9100743f23e4e529.png" alt="mysql docker"></p>
<p>Definition of <strong>Containers</strong>: Containers are designed to solve the problem of &ldquo;how to ensure that the software can run properly when switching runtime environments&rdquo;.</p>
<p>Currently, containers and Docker are still the hottest words in the technology field, stateless services containerization has been the trend, but also brings a hot issue is debated by everyone: <strong>database MySQL need to be containerized?</strong></p>
<p>We carefully analyze the various views of everyone, and find that those who agree are only elaborating MySQL needs containerization from the perspective of container advantages, with little business scenarios to verify their views; on the other hand, if we look at the opponents, they elaborate MySQL does not need containerization from multiple factors such as performance and data security, and also cite some unsuitable business scenarios. Here, we&rsquo;ll talk about a few reasons why Docker is not suitable for running MySQL!</p>
<h2 id="data-security-issues">Data security issues</h2>
<p>Do not store data in containers, which is one of the official Docker container usage tips. Containers can be stopped, or deleted, at any time. When the container is deleted, the data in the container will be lost. To avoid data loss, users can use data volume mounts to store data. However, the container Volumes are designed to provide persistent storage around the Union FS mirror layer, and data security is not guaranteed. If the container suddenly crashes and the database is not shut down properly, the data may be corrupted. In addition, the shared data volume groups in containers are more damaging to the physical machine hardware.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/09/c7756b4a407a4c5b9ef9a445b4b1a9b3.png" alt="Data security issues"></p>
<h2 id="performance-issues">Performance Issues</h2>
<p>As we all know, MySQL is a relational database with high IO requirements. When a physical machine runs more than one, the IO will accumulate, leading to IO bottlenecks and greatly reducing MySQL&rsquo;s read and write performance.</p>
<p>In a special session to discuss the top ten difficulties of Docker applications, an architect of a state-owned bank also raised: &ldquo;The performance bottleneck of database generally appears above IO, and if we follow the idea of Docker, then multiple dockers will end up with IO requests on top of storage. Nowadays, most of the databases on the Internet are share nothing architecture, which is probably a factor for not considering migration to Docker.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/09/0e02ad25c0f54921a7d8be2ebdbb416d.png" alt="Performance Issues"></p>
<p>In fact, there are some corresponding strategies to solve this problem, as follows.</p>
<h3 id="database-program-and-data-separation">Database program and data separation</h3>
<p>If you use Docker to run MySQL, the database program needs to be separated from the data by storing the data in the shared storage and the program in the container. If there is an exception in the container or MySQL service exception, a brand new container will be started automatically. In addition, it is recommended not to store data in the host, the host and container share volume groups, the impact of damage to the host is relatively large.</p>
<h3 id="run-lightweight-or-distributed-databases">Run lightweight or distributed databases</h3>
<p>Deploying a lightweight or distributed database in Docker, Docker itself recommends that the service hang and automatically start a new container instead of continuing to restart the container service.</p>
<h3 id="rational-layout-application">Rational layout application</h3>
<p>For applications or services with high IO requirements, it is more appropriate to deploy the database in a physical machine or KVM. Currently, Tencent Cloud&rsquo;s TDSQL and Ali&rsquo;s Oceanbase are deployed directly on physical machines instead of Docker.</p>
<h2 id="stateful-issues">Stateful issues</h2>
<p>Horizontal scaling in Docker can only be used for stateless compute services, not databases.</p>
<p>An important feature of Docker&rsquo;s rapid scaling is statelessness. Anything with data state is not suitable to be placed directly inside Docker, and if a database is installed in Docker, storage services need to be provided separately.</p>
<p>Currently, Tencent Cloud&rsquo;s TDSQL (financial distributed database) and AliCloud&rsquo;s Oceanbase (distributed database system) are running directly on physical machines, not on Docker which is easy to manage.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/09/6c3523d4292447f88846e02ff953dcb8.png" alt="docker"></p>
<h2 id="resource-isolation">Resource Isolation</h2>
<p>In terms of resource isolation, Docker is indeed inferior to the virtual machine KVM. Docker uses Cgroup to achieve resource limits, which can only limit the maximum amount of resources consumed, but not isolate other applications from occupying their own resources. If other applications take up the physical machine resources, it will affect the efficiency of MySQL reading and writing in the container.</p>
<p>The more isolation levels you need, the more resource overhead you get. The ease of horizontal scaling is a major advantage of Docker over dedicated environments. However, horizontal scaling in Docker can only be used for stateless computing services, not for databases.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images1/2022/08/09/b23234fa9dce4614b3e1d5ad3e43369f.png" alt="docker"></p>
<h2 id="cant-mysql-run-in-a-container">Can&rsquo;t MySQL run in a container?</h2>
<p>It&rsquo;s not all that MySQL can&rsquo;t be containerized.</p>
<ol>
<li>Businesses that are not sensitive to data loss (e.g., products searched by users) can be databased, using database sharding to increase the number of instances and thus increase throughput.</li>
<li>docker is suitable for running lightweight or distributed databases. When the docker service goes down, it will automatically start a new container instead of continuing to restart the container service.</li>
<li>Database using middleware and containerized system is able to automatically scale, disaster recovery, switching, and self-contained multiple nodes, which is also containerizable.</li>
</ol>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/mysql/">mysql</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-08/go-channel-free-lock/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Is Golang&#39;s Channel a free, lock-free implementation?</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-08/k8s-schedule-ext-prometheus/">
            <span class="next-text nav-default">Using Prometheus to extend the kubernetes scheduler</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
