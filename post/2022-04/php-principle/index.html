<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>PHP underlying operating mechanism and principle analysis - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Learn the underlying operation mechanism and principle of PHP." /><meta name="keywords" content="php, operating mechanism, principle " />






<meta name="generator" content="Hugo 0.96.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-04/php-principle/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="PHP underlying operating mechanism and principle analysis" />
<meta property="og:description" content="Learn the underlying operation mechanism and principle of PHP." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-04/php-principle/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-18T14:59:53+08:00" />
<meta property="article:modified_time" content="2022-04-18T14:59:53+08:00" />

<meta itemprop="name" content="PHP underlying operating mechanism and principle analysis">
<meta itemprop="description" content="Learn the underlying operation mechanism and principle of PHP."><meta itemprop="datePublished" content="2022-04-18T14:59:53+08:00" />
<meta itemprop="dateModified" content="2022-04-18T14:59:53+08:00" />
<meta itemprop="wordCount" content="4320">
<meta itemprop="keywords" content="php," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PHP underlying operating mechanism and principle analysis"/>
<meta name="twitter:description" content="Learn the underlying operation mechanism and principle of PHP."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">PHP underlying operating mechanism and principle analysis</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-18 14:59:53 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 4320 words </span>
          <span class="more-meta"> 9 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#php-directory-structure">PHP directory structure</a></li>
        <li><a href="#sapi">SAPI</a>
          <ul>
            <li><a href="#fastcgi-process">fastcgi process</a></li>
          </ul>
        </li>
        <li><a href="#main">main</a></li>
        <li><a href="#zend">Zend</a></li>
        <li><a href="#extensions">Extensions</a></li>
        <li><a href="#tsrm">TSRM</a></li>
        <li><a href="#php-design-philosophy-and-features">PHP design philosophy and features</a></li>
        <li><a href="#php-execution-flow--opcode">php execution flow &amp; opcode</a></li>
        <li><a href="#hashtable---the-core-data-structure">HashTable - the core data structure</a></li>
        <li><a href="#php-variables">PHP variables</a>
          <ul>
            <li><a href="#php-arrays-are-implemented-naturally-via-zend-hashtable-how-is-foreach-operation-implemented">PHP arrays are implemented naturally via zend hashtable. how is foreach operation implemented?</a></li>
            <li><a href="#how-to-use-resources">How to use resources</a></li>
          </ul>
        </li>
        <li><a href="#how-local-and-global-variables-are-implemented-in-php">How local and global variables are implemented in PHP</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>PHP is simple, but it&rsquo;s not easy to master. In addition to knowing how to use it, we also need to know how it works under the hood.</p>
<p>What is the purpose of understanding the underlying implementation of PHP? To use a dynamic language well, we must first understand it, the memory management and framework model is worth learning from, and we can optimize the performance of our programs by extending the development to achieve more and more powerful features.</p>
<p>PHP is a dynamic language for web development. To be more specific, it is a software framework that contains a large number of component modules implemented in C. It is a powerful UI framework.</p>
<p>In short; the PHP dynamic language execution process: after getting a piece of code, the source program is translated into individual instructions (opcodes) through lexical and syntactic parsing, and then the ZEND virtual machine executes these instructions in order to complete the operation. PHP itself is implemented in C, so the final calls are to C functions, so in effect we can think of PHP as a C-developed piece of software.</p>
<h2 id="php-directory-structure">PHP directory structure</h2>
<p>The PHP source code also includes several files generated during development, and several sections maintained in their respective locations upstream. (Note: PHP version 7.4.13).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">&lt;php-src&gt;/
</span></span><span class="line"><span class="cl"> ├─ .git/                           # Git configuration and source directory
</span></span><span class="line"><span class="cl"> ├─ TSRM/                           # Thread Safe Resource Manager
</span></span><span class="line"><span class="cl"> └─ Zend/                           # Zend Engine
</span></span><span class="line"><span class="cl">    ├─ zend_vm_execute.h            # Generated by `Zend/zend_vm_gen.php`
</span></span><span class="line"><span class="cl">    ├─ zend_vm_opcodes.c            # Generated by `Zend/zend_vm_gen.php`
</span></span><span class="line"><span class="cl">    ├─ zend_vm_opcodes.h            # Generated by `Zend/zend_vm_gen.php`
</span></span><span class="line"><span class="cl">    └─ ...
</span></span><span class="line"><span class="cl"> ├─ appveyor/                       # Appveyor CI service files
</span></span><span class="line"><span class="cl"> └─ build/                          # *nix build system files
</span></span><span class="line"><span class="cl">    ├─ ax_*.m4                      # https://github.com/autoconf-archive/autoconf-archive
</span></span><span class="line"><span class="cl">    ├─ config.guess                 # https://git.savannah.gnu.org/cgit/config.git
</span></span><span class="line"><span class="cl">    ├─ config.sub                   # https://git.savannah.gnu.org/cgit/config.git
</span></span><span class="line"><span class="cl">    ├─ libtool.m4                   # https://git.savannah.gnu.org/cgit/libtool.git
</span></span><span class="line"><span class="cl">    ├─ ltmain.sh                    # https://git.savannah.gnu.org/cgit/libtool.git
</span></span><span class="line"><span class="cl">    ├─ shtool                       # https://www.gnu.org/software/shtool/
</span></span><span class="line"><span class="cl">    └─ ...
</span></span><span class="line"><span class="cl"> ├─ docs/                           # PHP internals and repository documentation
</span></span><span class="line"><span class="cl"> └─ ext/                            # PHP core extensions
</span></span><span class="line"><span class="cl">    └─ bcmath/
</span></span><span class="line"><span class="cl">       ├─ libbcmath/                # Forked and maintained in php-src
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ curl/
</span></span><span class="line"><span class="cl">       ├─ sync-constants.php        # The curl symbols checker
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ date/
</span></span><span class="line"><span class="cl">       └─ lib/                      # Bundled datetime library https://github.com/derickr/timelib
</span></span><span class="line"><span class="cl">          ├─ parse_date.c           # Generated by re2c 0.15.3
</span></span><span class="line"><span class="cl">          ├─ parse_iso_intervals.c  # Generated by re2c 0.15.3
</span></span><span class="line"><span class="cl">          └─ ...
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ ffi/
</span></span><span class="line"><span class="cl">       ├─ ffi_parser.c              # Generated by https://github.com/dstogov/llk
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ fileinfo/
</span></span><span class="line"><span class="cl">       ├─ libmagic/                 # Modified libmagic https://github.com/file/file
</span></span><span class="line"><span class="cl">       ├─ data_file.c               # Generated by `ext/fileinfo/create_data_file.php`
</span></span><span class="line"><span class="cl">       ├─ libmagic.patch            # Modifications patch from upstream libmagic
</span></span><span class="line"><span class="cl">       ├─ magicdata.patch           # Modifications patch from upstream libmagic
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ gd/
</span></span><span class="line"><span class="cl">       ├─ libgd/                    # Bundled and modified GD library https://github.com/libgd/libgd
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ mbstring/
</span></span><span class="line"><span class="cl">       ├─ libmbfl/                  # Forked and maintained in php-src
</span></span><span class="line"><span class="cl">       ├─ unicode_data.h            # Generated by `ext/mbstring/ucgendat/ucgendat.php`
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ pcre/
</span></span><span class="line"><span class="cl">       ├─ pcre2lib/                 # https://www.pcre.org/
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ pdo_mysql/
</span></span><span class="line"><span class="cl">       ├─ php_pdo_mysql_sqlstate.h  # Generated by `ext/pdo_mysql/get_error_codes.php`
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ skeleton/                    # Skeleton for developing new extensions with `ext/ext_skel.php`
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ standard/
</span></span><span class="line"><span class="cl">       └─ html_tables/
</span></span><span class="line"><span class="cl">          ├─ mappings/              # https://www.unicode.org/Public/MAPPINGS/
</span></span><span class="line"><span class="cl">          └─ ...
</span></span><span class="line"><span class="cl">       ├─ credits_ext.h             # Generated by `scripts/dev/credits`
</span></span><span class="line"><span class="cl">       ├─ credits_sapi.h            # Generated by `scripts/dev/credits`
</span></span><span class="line"><span class="cl">       ├─ html_tables.h             # Generated by `ext/standard/html_tables/html_table_gen.php`
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ tokenizer/
</span></span><span class="line"><span class="cl">       ├─ tokenizer_data.c          # Generated by `ext/tokenizer/tokenizer_data_gen.sh`
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ xmlrpc/
</span></span><span class="line"><span class="cl">       ├─ libxmlrpc/                # Forked and maintained in php-src
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ zend_test                    # For testing internal APIs. Not needed for regular builds.
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ zip/                         # Bundled https://github.com/pierrejoye/php_zip
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ ...
</span></span><span class="line"><span class="cl"> └─ main/                           # Binding that ties extensions, SAPIs, and engine together
</span></span><span class="line"><span class="cl">    ├─ streams/                     # Streams layer subsystem
</span></span><span class="line"><span class="cl">    ├─ php_version.h                # Generated by release managers using `configure`
</span></span><span class="line"><span class="cl">    └─ ...
</span></span><span class="line"><span class="cl"> ├─ pear/                           # PEAR installation
</span></span><span class="line"><span class="cl"> └─ sapi/                           # PHP SAPI modules
</span></span><span class="line"><span class="cl">    └─ cli/
</span></span><span class="line"><span class="cl">       ├─ mime_type_map.h           # Generated by `sapi/cli/generate_mime_type_map.php`
</span></span><span class="line"><span class="cl">       └─ ...
</span></span><span class="line"><span class="cl">    └─ ...
</span></span><span class="line"><span class="cl"> ├─ scripts/                        # php-config, phpize and internal development scripts
</span></span><span class="line"><span class="cl"> ├─ tests/                          # Core features tests
</span></span><span class="line"><span class="cl"> ├─ travis/                         # Travis CI service files
</span></span><span class="line"><span class="cl"> └─ win32/                          # Windows build system files
</span></span><span class="line"><span class="cl">    ├─ cp_enc_map.c                 # Generated by `win32/cp_enc_map_gen.exe`
</span></span><span class="line"><span class="cl">    └─ ...
</span></span><span class="line"><span class="cl"> └─ ...
</span></span></code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>Directory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TSRM</td>
<td>Thread-related safety implementation, PHP thread safety is built on top of the TSRM library, PHP implementation of the common *G macro is usually the encapsulation of TSRM, TSRM (Thread Safe Resource Manager) thread-safe resource manager.</td>
</tr>
<tr>
<td>Zend</td>
<td>Core implementation of PHP parser, such as lexical syntax parsing of scripts, execution of opcode and implementation of extension mechanism, etc.</td>
</tr>
<tr>
<td>build</td>
<td>Compile related directories under linux</td>
</tr>
<tr>
<td>ext</td>
<td>PHP extensions, including the definition and implementation of most PHP functions, such as array series, pdo series, spl series and other function implementations, are in this directory. Personally written extensions can also be placed in this directory when testing, for easy testing and debugging.</td>
</tr>
<tr>
<td>main</td>
<td>PHP&rsquo;s main code, where the most core PHP files are stored, mainly to achieve the basic facilities of PHP, here and Zend engine is not the same, Zend engine mainly to achieve the language&rsquo;s most core language runtime environment.</td>
</tr>
<tr>
<td>netware</td>
<td>Network directory, definition and implementation of sockets</td>
</tr>
<tr>
<td>pear</td>
<td>PEAR is an abbreviation for the PHP Extension and Application Repository, a code repository for PHP extensions and applications. It is a code repository for PHP extensions and applications. Simply put, PEAR is to PHP what CPAN (Comprehensive Perl Archive Network) is to Perl.</td>
</tr>
<tr>
<td>sapi</td>
<td>PHP&rsquo;s application layer interface contains code for various server abstraction layers, such as apache&rsquo;s mod_php, cli,cgi,embed, and fpm.</td>
</tr>
<tr>
<td>scripts</td>
<td>Script directory under Linux</td>
</tr>
<tr>
<td>tests</td>
<td>Test scripts directory, containing test files for various PHP functions</td>
</tr>
<tr>
<td>travis</td>
<td>For building, non-PHP specific directories</td>
</tr>
<tr>
<td>win32</td>
<td>The scripts related to compiling PHP under Windows, such as the implementation of sokcet is not quite the same under Windows and *Nix platform, and also includes the scripts related to compiling PHP under Windows。</td>
</tr>
</tbody>
</table>
<p>Although there are many source directories, the only core directories are <code>sapi</code>, <code>main</code>, <code>zend</code>, <code>ext</code>, and <code>TSRM</code>.</p>
<h2 id="sapi">SAPI</h2>
<p>The input to <code>PHP</code> programs can be standard input from the command line, or network requests based on the <code>cgi/fastcgi</code> protocol. It can even be embedded in a microcontroller for <code>C</code>, <code>C++</code> programs to call. They correspond to <strong>cli mode</strong>, <strong>fpm/cgi mode</strong>, <strong>embed mode</strong>, and in addition to these there are <code>apache2handler</code>, <strong>litespeed mode</strong>.</p>
<ol>
<li>
<p>apache2handle: This is the way to deal with <code>apache</code> as <code>webserver</code>, using <code>mod_PHP</code> mode to run, and it is the most widely used one now.</p>
</li>
<li>
<p>cgi: This is another way of interaction between <code>webserver</code> and <code>PHP</code> directly, that is, the famous fastcgi protocol, in recent <code>fastcgi+PHP</code> is getting more and more applications, and it is the only way supported by asynchronous <code>webserver</code>; typical application <code>nginx</code> server; <code>fastcgi</code> is To be clear, it is an extension of <code>php</code>.</p>
</li>
<li>
<p>cli: command invocation.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/9e8487e81b2c4ed6b62758bf0d249bef.png" alt="php cli"></p>
</li>
</ol>
<p>The sapi directory is an abstraction of the input and output layers, and is the specification for PHP to provide external services.</p>
<p>Similarly, the output can be written to the standard output of the command line or returned to the client as a network response based on the cgi/fastcgi protocol.</p>
<p>SAPI full name Server API, responsible for PHP external service specification, it defines the structure sapi_module_struct, the structure defines the mode start, shutdown, activation, expiration and so on many hook function pointers, each mode will these function pointers to their own function, it can easily extend the way of PHP external service. The above several modes are also the implementation of sapi_module_strcut to complete the multi-scenario application of PHP.</p>
<h3 id="fastcgi-process">fastcgi process</h3>
<ul>
<li><code>Web Server</code> loads the <code>FastCGI</code> process manager (IIS ISAPI or Apache Module) at startup</li>
<li>The <code>FastCGI</code> process manager initializes itself, starts multiple <code>CGI</code> interpreter processes (visible as multiple php-cgi) and waits for a connection from the Web <code>Server</code>.</li>
<li>When a client request reaches the <code>Web Server</code>, the <code>FastCGI</code> process manager selects and connects to a <code>CGI</code> interpreter. The <code>Web server</code> sends the <code>CGI</code> environment variables and standard input to the <code>FastCGI</code> subprocess <code>php-cgi</code>.</li>
<li>The <code>FastCGI</code> subprocess finishes processing and returns the standard output and error messages to the <code>Web Server</code> from the same connection. When the <code>FastCGI</code> subprocess closes the connection, the request is processed. The <code>FastCGI</code> subprocess then waits for and processes the next connection from the <code>FastCGI</code> process manager (running in the Web Server). In <code>CGI</code> mode, <code>php-cgi</code> exits at this point.</li>
<li>In the above case, you can imagine how slow <code>CGI</code> usually is. For every <code>Web</code> request, PHP has to re-parse <code>php.ini</code>, reload all the extensions and re-initialize all the data structures. With <code>FastCGI</code>, all of this happens only once when the process starts. An additional benefit is that Persistent database connection works.</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/88e6b3932435481b9239bd57ca661e74.png" alt="CGI">
<img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/69ff3690db7042cea50f92a82aec088b.png" alt="CGI"></p>
<h2 id="main">main</h2>
<p>The <code>main</code> directory is the glue between the <code>SAPI</code> layer and the <code>Zend</code> layer.</p>
<p>The role of the <code>main</code> directory is to take requests from <code>SAPI</code>, parse out the script files and parameters to be executed, and initialize the environment and configuration, such as initializing variables and constants, registering functions, parsing configuration files, loading extensions, etc.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/6a488877fd4d403cab8b06cbce64f1ac.png" alt="main php"></p>
<h2 id="zend">Zend</h2>
<p>The <code>Zend</code> engine is the kernel part of <code>php</code>, which translates <code>php</code> code into executable <code>opcode</code> processing and implements the corresponding processing methods, basic data structures, memory allocation management, etc. It consists of two parts: the compiler and the executor.</p>
<p>The compiler is responsible for the lexical and syntactic analysis of the <code>PHP</code> code, and generates an abstract syntax tree, which is then further compiled into <code>opcode</code>, <code>opcode</code> is the instruction recognized by the <code>Zend</code> virtual machine, <code>php7</code> has <code>173</code> <code>opcodes</code> in total, and all the syntax is composed of these <code>opcodes</code>. The executor is responsible for executing the <code>opcode</code> output by the compiler.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/b14ac8b8833a48dfb10131b1f602c66c.png" alt="php zend"></p>
<h2 id="extensions">Extensions</h2>
<p><code>ext(extension)</code>, which is a way to extend the function of <code>PHP</code> kernel, divided into <code>PHP</code> extension and <code>zend</code> extension, both support user-defined development, both are more common, <code>PHP</code> extensions are <code>gd</code>, <code>json</code>, <code>date</code>, <code>array</code>, etc., and the familiar <code>opcache</code> is <code>Zend</code> extension.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/4aaf3c0d7b6b4837bf409321c0bfa13a.png" alt="php Extensions"></p>
<h2 id="tsrm">TSRM</h2>
<p>TSRM (Thread Safe Resource Manager) is a thread-safe resource manager.</p>
<p>A global variable is a variable defined outside a function, it is a public resource, in a multi-threaded environment, access to public resources may cause conflicts, TSRM is born to solve the problem.</p>
<p>The main purpose of TSRM is to ensure the safety of shared resources, and PHP&rsquo;s thread safety mechanism is simple and intuitive - in a multi-threaded environment, each thread is provided with a separate copy of the global variable. This is implemented by allocating (locking before allocation) an independent ID (self-incrementing) to each thread via TSRM as an index to the current thread&rsquo;s global variable memory area, enabling complete independence between threads for subsequent global variable access.</p>
<p>Most of the PHP SAPIs are single-threaded, so there is not much need to pay attention to thread safety, but in the case of Apache or the user&rsquo;s own implementation of the PHP environment, it is necessary to consider thread safety.</p>
<h2 id="php-design-philosophy-and-features">PHP design philosophy and features</h2>
<ol>
<li>multi-process model: Since PHP is a multi-process model, different requests do not interfere with each other, which ensures that a request hanging will not affect the full service, and PHP also supports multi-threaded model as early as now.</li>
<li>weakly typed language: different from C/C++, JAVA, C# and other languages, PHP is a weakly typed language. The type of a variable is not determined unchanged at the beginning, it will be determined and may occur implicitly or display type conversion only in the run, the flexibility of this mechanism is very convenient and efficient in web development, the specific will be detailed in the PHP variables later.</li>
<li>engine (Zend) + component (ext) model to reduce internal coupling.</li>
<li>middle layer (sapi ) Sapi full name is Server Application Programming Interface isolated web server and PHP.</li>
<li>syntax is simple and flexible, not too much specification. Disadvantages lead to mixed styles.</li>
</ol>
<h2 id="php-execution-flow--opcode">php execution flow &amp; opcode</h2>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/a7ffadf42a834ff5bacf8bfe549de327.png" alt="php execution flow &amp; opcode"></p>
<p>The php dynamic language execution process: after getting a piece of code, the source program is translated into individual instructions (opcodes) through lexical and syntactic parsing, and then the Zend virtual machine executes these instructions sequentially. php itself is implemented in c, so the final calls are to c functions, so in effect, we can think of php as a piece of software developed in c.</p>
<p>The core of php execution is the translated directives (opcode), which are the basic unit of php program execution.</p>
<p>There are several common processing functions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nl">ZEND_ASSIGN_SPEC_CV_CV_HANDLER</span> <span class="p">:</span> <span class="err">变量分配</span> <span class="err">（$</span><span class="n">a</span><span class="o">=</span><span class="err">$</span><span class="n">b</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">ZEND_DO_FCALL_BY_NAME_SPEC_HANDLER</span><span class="err">：函数调用</span>
</span></span><span class="line"><span class="cl"><span class="n">ZEND_CONCAT_SPEC_CV_CV_HANDLER</span><span class="err">：字符串拼接</span> <span class="err">$</span><span class="n">a</span><span class="p">.</span><span class="err">$</span><span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="nl">ZEND_ADD_SPEC_CV_CONST_HANDLER</span><span class="p">:</span> <span class="err">加法运算</span> <span class="err">$</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">ZEND_IS_EQUAL_SPEC_CV_CONST</span><span class="err">：判断相等</span> <span class="err">$</span><span class="n">a</span><span class="o">==</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">ZEND_IS_IDENTICAL_SPEC_CV_CONST</span><span class="err">：判断相等</span> <span class="err">$</span><span class="n">a</span><span class="o">===</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hashtable---the-core-data-structure">HashTable - the core data structure</h2>
<p><code>HashTable</code> is the core data structure of <code>Zend</code>, it is used to implement almost all common functions in <code>PHP</code>, we know <strong>PHP array</strong> is its typical application, in addition, inside <code>zend</code>, such as <strong>function symbol table</strong>, <strong>global variables</strong>, etc. are also based on <code>hash table</code> with the following features.</p>
<ol>
<li>supports typical <code>key-&gt;value</code> queries</li>
<li>can be used as an array</li>
<li>O(1) complexity for adding and deleting nodes</li>
<li>key supports mixed types: the presence of both associative index arrays</li>
<li>value supports mixed types: array(&ldquo;string&rdquo;,2332)</li>
<li>linear traversal support: such as <code>foreach</code></li>
</ol>
<p><code>Zend hash table</code> implements the typical <code>hash</code> table hash structure, and provides forward and reverse traversal of arrays by attaching a two-way chain table. The structure is shown in the following figure.</p>
<p>As you can see: in <code>hash table</code> there is both a hash structure in the form of <code>key-&gt;value</code> and a bidirectional linked table model, which makes it very convenient to support fast lookup and linear traversal.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/68752f38c16446098bff0d71ebafef35.png" alt="HashTable"></p>
<ol>
<li>
<p>Hash structure: Zend&rsquo;s hash structure is a typical hash table model, which resolves conflicts by means of linked lists. Note that zend&rsquo;s hash table is a self-growing data structure, and when the hash table is full, it dynamically expands by a factor of two and repositions the elements. In addition, zend itself has made some optimizations to speed up the key-&gt;value fast lookup by trading space for time. For example, in each element, a variable nKeyLength is used to identify the length of the key for quick determination.</p>
</li>
<li>
<p>Doubly linked list: <code>Zend hash table</code> implements a linear traversal of elements through a Linked list structure. In theory, it is enough to use a Linked list for traversal. The main reason for using a Doubly linked list is to quickly delete and avoid traversal. The <code>Zend hash table</code> is a composite structure that can be used as an array, i.e. it supports the usual associative arrays and can be used as sequential indexed numbers, even allowing a mixture of the two. PHP associative arrays: Associative arrays are the typical application of <code>hash_table</code>. A query process goes through the following steps (as you can see from the code, this is a common hash query process with some quick determinations to speed up the lookup).</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">getKeyHashValue</span> <span class="n">h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">index</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="n">nTableMask</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Bucket</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">arBucket</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="p">((</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">h</span> <span class="o">==</span> <span class="n">h</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">nKeyLength</span> <span class="o">==</span> <span class="n">nKeyLength</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">RETURN</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">RETURN</span> <span class="n">FALTURE</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>PHP Indexed Arrays</li>
</ul>
<p>Index arrays are our common arrays, accessed by subscripts. For example: <code>$arr[0]</code>, zend hashtable is internally normalized, and for index type key is also assigned hash value and nKeyLength (to 0). The internal member variable nNextFreeElement is the maximum id currently assigned, which is automatically added to one after each push. It is this normalization process that allows PHP to achieve a mix of associative and non-associative. Due to the special nature of the push operation, the order of index keys in the PHP array is not determined by the subscript size, but by the order of push. For example, <code>$arr[1] = 2</code>; <code>$arr[2] = 3</code>; for a double type key, Zend hashtable will treat him as an index key.</p>
<h2 id="php-variables">PHP variables</h2>
<p><code>PHP</code> is a weakly typed language that does not strictly distinguish between the types of variables itself. <code>PHP</code> does not require a type to be specified at the time of variable declaration.</p>
<p><code>PHP</code> may perform implicit conversions of variable types during program runtime. As with other strongly typed languages, explicit type conversions may be performed in programs.</p>
<p>PHP variables can be classified as simple types (int, string, bool), collection types (array resource object) and constants (const). All of the above variables have the same structure at the bottom zval.</p>
<p><code>Zval</code> consists of three main parts.</p>
<ul>
<li>type: specifies the type of variable stated (integer, string, array, etc.)</li>
<li>refcount&amp;is_ref: used to implement reference counting (described later in detail)</li>
<li>value: the core part, which stores the actual data of the variable</li>
</ul>
<p><code>Zvalue</code> is used to store the actual data of a variable. Because of the need to store multiple types, <code>zvalue</code> is a <code>union</code>, and thus implements weak types.</p>
<p>The correspondence between the <code>php</code> variable type and its actual storage is as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/18/3fe954f8126c4aa8a91735a0514994ee.png" alt="PHP variables"></p>
<ol>
<li>
<p>Reference counting is widely used in memory recovery, string manipulation, etc. Variables in PHP are a typical application of reference counting. Zval&rsquo;s reference counting is implemented by member variables is_ref and ref_count, which allows multiple variables to share the same data. This allows multiple variables to share a single copy of the data, avoiding the need for frequent copying. When assigning, zend points the variable to the same Zval with ref_count++ and ref_count-1 when unset. only when ref_count is reduced to 0 is the actual destruction operation performed. In the case of a reference assignment, zend will modify is_ref to 1.</p>
</li>
<li>
<p>PHP variables share data by reference counting, so what if you change the value of one of the variables? When trying to write to a variable, if Zend finds that the Zval pointed to by that variable is shared by multiple variables, it makes a copy of the Zval with a ref_count of 1 and decrements the refcount of the original Zval, a process called &lsquo;Zval separation&rsquo;. This process is called &lsquo;Zval separation&rsquo;. As you can see, zend will only copy when a write operation occurs, so it is also called copy-on-write. Integer and floating point number is one of the basic types in PHP and a simple type variable. For integers and floating point numbers, the corresponding values are stored directly in Zvalue. The types are long and double.</p>
</li>
<li>
<p>The Zvalue structure shows that, unlike strongly typed languages such as c, php does not distinguish between int, unsigned int, long, etc. For it, there is only one type of integer, which is long, and thus the range of integers in php is determined by the number of bits in the compiler rather than being fixed.</p>
</li>
<li>
<p>For floating point numbers, similar to integers, it also doesn&rsquo;t distinguish between float and double, but is uniformly of the type double only. In php, what if an integer is out of bounds? In this case, it is automatically converted to double, so be careful, as many triks are generated from this.</p>
</li>
<li>
<p>Like integers, character variables are also base and simple type variables in php. The Zvalue structure shows that in php, strings consist of a pointer to the actual data and a length structure, which is more similar to string in c++. Since the length is represented by an actual variable, unlike c, its strings can be binary numbers (containing \0), and in php, finding the string strlen is an O(1) operation. When adding, modifying, or appending string operations, php reallocates memory to generate a new string. Finally, for security reasons, php still adds a \0 to the end of a string when it is generated.</p>
</li>
</ol>
<p>Common string splicing methods and speed comparison. Suppose there are 4 variables as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$strA</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$strB</span> <span class="o">=</span> <span class="s1">&#39;456&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$intA</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$intB</span> <span class="o">=</span> <span class="mi">456</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now a comparison and explanation of several character splicing methods as above.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">// 这种情况下，zend会重新 malloc 一块内存并进行相应处理，其速度一般
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$res</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">{</span><span class="nv">$strA</span><span class="si">}{</span><span class="nv">$strB</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 这种速度是最快的，zend会在当前 strA基础上直接 relloc，避免重复拷贝
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$res</span> <span class="o">=</span> <span class="nv">$strA</span><span class="o">.</span><span class="nv">$strB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 这种速度是比较慢的，需要进行隐式转换
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$res</span> <span class="o">=</span> <span class="nv">$intA</span><span class="o">.</span><span class="nv">$intB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 这会是最慢的一种方式，因为sprintf在PHP中并不是一个语言结构，本身对于格式识别和处理就需要耗费比较多时间，另外本身机制也是malloc内存。不过sprintf的方式最具可读性，实际中可以根据具体情况灵活选择。 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$res</span> <span class="o">=</span> <span class="nx">sprintf</span> <span class="p">(</span><span class="s2">&#34;%s%s&#34;</span><span class="p">,</span><span class="nv">$strA</span><span class="o">.</span><span class="nv">$strB</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="php-arrays-are-implemented-naturally-via-zend-hashtable-how-is-foreach-operation-implemented">PHP arrays are implemented naturally via zend hashtable. how is foreach operation implemented?</h3>
<ul>
<li>
<p>For an array foreach is done by traversing a Doubly linked list in hashtable. For indexed arrays, foreach is more efficient than for, eliminating the need for a key-&gt;value lookup. count calls HashTabel -&gt; NumOfElements, O(1), and for strings like &lsquo;123&rsquo;, zend converts them to integers, <code>$arr[123]</code> and <code>$arr[' 123']</code> are equivalent.</p>
</li>
<li>
<p>Resource types are the most complex variables in PHP and are a type of compound structure. PHP&rsquo;s Zval can represent a wide range of data types, but it is difficult to adequately describe them for custom data types. Since there is no efficient way to depict these composite structures, there is also no way to use traditional straw rentals for them. To solve this problem, it is only necessary to refer to a pointer by an essentially arbitrary identifier (label), in a way known as a resource.</p>
</li>
</ul>
<p>In Zval, for resource, lval is used as a pointer to the address where the resource is located. resource can be any composite structure, we are familiar with mysqli, fsock, memcached, etc. are all resources.</p>
<h3 id="how-to-use-resources">How to use resources</h3>
<ul>
<li>Registration: for a custom data type to be used as a resource. It needs to be registered first, and <code>zend</code> will assign a globally unique label to it.</li>
<li>Get a resource variable: For a resource, <code>zend</code> maintains a <code>hash_tale</code> of id-&gt;actual data. For a <code>resource</code>, only its id is recorded in <code>Zval</code>. fetch finds the specific value in the hash_table by id and returns it.</li>
<li>Resource destruction: There are various data types for resources. There is no way to destroy it in <code>Zend</code> itself. So you need to provide the destruction function when registering the resource.</li>
<li>When <code>unset</code> a resource, <code>zend</code> calls the appropriate function to complete the destruct. It is also removed from the global resource table.</li>
</ul>
<p>A resource can persist for a long time, not just after all the variables that reference it have gone out of scope, but even after a request has ended and a new one has been made. These resources are called persistent resources because they persist through the entire lifecycle of <code>SAPI</code>, unless they are intentionally destroyed. In many cases, persistent resources can improve performance to some extent. For example, in the common case of <code>mysql_pconnect</code>, persistent resources are allocated via <code>pemalloc</code> so that they are not freed at the end of the request. For <code>zend</code>, there is no distinction between the two per se.</p>
<h2 id="how-local-and-global-variables-are-implemented-in-php">How local and global variables are implemented in PHP</h2>
<ul>
<li>For a request, at any given moment <code>PHP</code> can see two symbol tables (symbol_table and active_symbol_table), where the former is used to maintain global variables. The latter is a pointer to the symbol table of the currently active variable. When the program enters a function, <code>zend</code> allocates a <strong>symbol table x</strong> to it while pointing <code>active_symbol_table</code> to a. The distinction between global and local variables is achieved in this way.</li>
<li>Get variable values: <code>PHP</code> symbol table is implemented by <code>hash_table</code>, each variable is assigned a unique identifier, and the corresponding <code>Zval</code> is found from the table when fetching.</li>
<li>Using global variables in functions: In functions, we can use global variables by explicitly declaring <code>global</code>. Create a reference to a variable with the same name in <code>active_symbol_table</code>, or first if there is no variable with the same name in <code>symbol_table</code>.</li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/php/">php</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-04/7-zip-vulnerabilities/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Security vulnerability that can be triggered by dragging a file, affects all versions</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-04/php-extensions/">
            <span class="next-text nav-default">Writing extensions to PHP 7.4</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
