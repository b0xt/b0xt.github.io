<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MVCC in Mysql - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Explore the implementation of mvcc in mysql." /><meta name="keywords" content="mysql, Mvcc" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-04/mysql-mvcc/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="MVCC in Mysql" />
<meta property="og:description" content="Explore the implementation of mvcc in mysql." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-04/mysql-mvcc/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-20T10:51:29+08:00" />
<meta property="article:modified_time" content="2022-04-20T10:51:29+08:00" />

<meta itemprop="name" content="MVCC in Mysql">
<meta itemprop="description" content="Explore the implementation of mvcc in mysql."><meta itemprop="datePublished" content="2022-04-20T10:51:29+08:00" />
<meta itemprop="dateModified" content="2022-04-20T10:51:29+08:00" />
<meta itemprop="wordCount" content="3468">
<meta itemprop="keywords" content="mysql," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MVCC in Mysql"/>
<meta name="twitter:description" content="Explore the implementation of mvcc in mysql."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">MVCC in Mysql</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-20 10:51:29 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 3468 words </span>
          <span class="more-meta"> 7 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-exactly-is-mvcc">What exactly is MVCC?</a></li>
        <li><a href="#mvcc-fundamentals">MVCC Fundamentals</a></li>
        <li><a href="#innodb-engine-mvcc-exploration">Innodb Engine MVCC Exploration</a>
          <ul>
            <li><a href="#undolog">undolog</a></li>
            <li><a href="#version-chaining">Version chaining</a></li>
            <li><a href="#readview">ReadView</a></li>
            <li><a href="#read-committed----generate-a-readview-before-each-data-read">READ COMMITTED &ndash; Generate a ReadView before each data read</a></li>
            <li><a href="#repeatable-read----generates-a-readview-on-the-first-read-ensuring-consistent-results-across-multiple-queries-in-a-single-transaction">REPEATABLE READ &ndash; Generates a ReadView on the first read, ensuring consistent results across multiple queries in a single transaction</a></li>
          </ul>
        </li>
        <li><a href="#to-summarize">To summarize</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="what-exactly-is-mvcc">What exactly is MVCC?</h2>
<p>Definition: <strong>Multi-Version Concurrency Control</strong> , literally, the use of multiple versions for reasonable control during concurrency (that&rsquo;s how I took it literally anyway), obviously this thing is an abstract concept, and it is. It is mainly found in some data management software.
Maintaining multiple versions of a data makes the read and write operations conflict-free.</p>
<ul>
<li>Why is this thing there?</li>
</ul>
<p>We all know that the data management program provides the function of querying and modifying data, but how to solve the conflict problem during reading and writing it, in order to maintain data consistency and maintain high performance, to even when there is a read-write conflict, but also to do without locking, non-blocking concurrent reading, <code>MVCC</code> This concurrency control algorithm has emerged.</p>
<h2 id="mvcc-fundamentals">MVCC Fundamentals</h2>
<p>MVCC is allowing multiple versions of an object to exist simultaneously. That is, it has a &ldquo;current&rdquo; version and one or more previous versions. You can use different versions of it as needed to solve the problem you are facing when you get the version. During this run, the &ldquo;author&rdquo; can create and publish a new version of the object, which will become the latest version of the object, and the &ldquo;reader&rdquo; can still use the previous version as well.</p>
<p>Which versions are available to &ldquo;readers&rdquo;? This is related to your real needs, for example, the isolation level in Mysql, different levels of the same concurrent operation after the results see inconsistent, we can according to the needs of the reasonable display data object version, in different isolation levels to achieve different results.</p>
<p>Since we know the abstraction of MVCC, let&rsquo;s take a look at its implementation. MVCC has been embraced by many data management programs, which undoubtedly proves that it is a good design idea, such as the Innodb engine in Mysql, Etcd storage, PostgreSQL, oracle, etc. Let&rsquo;s take the Innodb engine as an example and observe how it is implemented MVCC.</p>
<h2 id="innodb-engine-mvcc-exploration">Innodb Engine MVCC Exploration</h2>
<p>In the <code>Innodb</code> engine, we need to understand some basic concepts first: <code>undolog</code>, <code>version chaining</code> and <code>ReadView</code>.</p>
<h3 id="undolog">undolog</h3>
<p>We know that transactions are atomic in nature. But when the system fails, or when you roll back manually, how to ensure that all the committed data is restored this time, sometimes it is possible that the transaction is only half executed, we want to ensure that it is the same as the original, the transaction does not seem to do anything, to give an example in life: such as chess, when you play the wrong piece you can apply for a repentance, repentance is a kind of rollback operation, in fact, is the previously executed operation again You insert a record, the log of the rollback operation corresponds to the deletion of the record; you update a record, the rollback operation corresponds to the update of the record to the old value; you delete a record, the corresponding rollback operation is the insertion.</p>
<p>In the real InnoDB, undo logs are not as simple as we described above, and the format of undo logs is different for different types of operations, but let&rsquo;s put aside these specific details that are easy to make people&rsquo;s brains confused for a while and pay attention to the focus of our article.</p>
<h3 id="version-chaining">Version chaining</h3>
<p>Each time a record is updated, the old value is put into an undo log, forming an old version of the record. As the number of updates increases, all versions are linked into a chain by the roll_pointer property of the data line, which we call the version chain. The head node of the version chain is the latest value of the current record. In addition, each version also contains the transaction ID that generated the version, and the approximate logic is shown below.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/20/3ed011bd511643149d2c54c85f90b2ac.png" alt="mvcc Version chaining"></p>
<h3 id="readview">ReadView</h3>
<p>In the <code>RC</code> and <code>RR</code> isolation levels (READ UNCOMMITTED, SERIALIZABLE is not used in Read View), it must be guaranteed that the transaction has been read to the already committed modified records, that is, assuming that another record has been modified but not yet committed, is not directly read the latest version of the record, the core problem is. The core problem is that we need to determine which version of the version chain is visible to the current transaction. The concept of <code>Read View</code> is designed to solve this problem, and it contains four elements.</p>
<ol>
<li><code>m_ids</code> generates a list of reads and writes <strong>transaction IDs</strong> that are active on the system at the time of `ReadView.</li>
<li><code>min_trx_id</code> generates the smallest <strong>transaction ID</strong> of the active transactions on the system at the time of <code>ReadView</code>, i.e. the smallest value in <code>m_ids</code>.</li>
<li><code>max_trx_id</code> should be assigned to the next <strong>transaction ID</strong> in the system at the time <code>ReadView</code> is generated.</li>
<li><code>creator_trx_id</code> generates the <strong>transaction id</strong> for <code>ReadView</code> only when changes are made to rows in the table (when executing INSERT, DELETE, UPDATE statements), otherwise the transaction id value defaults to 0 in a read-only transaction.</li>
</ol>
<p>With this <code>ReadView</code>, when accessing a record, you only need to follow the following steps to determine if a version of the record is visible.</p>
<ul>
<li>If the value of the <code>trx_id</code> attribute of the accessed version is the same as the value of <code>creator_trx_id</code> in the <code>ReadView</code>, it means that the current transaction is accessing its own modified record, so that version can be accessed by the current transaction.</li>
<li>If the value of the <code>trx_id</code> attribute of the accessed version is less than the value of <code>min_trx_id</code> in <code>ReadView</code>, it means that the transaction that generated the version was committed before the current transaction generated <code>ReadView</code>, so the version is accessible to the current transaction.</li>
<li>If the value of the <code>trx_id</code> attribute of the accessed version is greater than or equal to the value of max_trx_id in <code>ReadView</code>, the transaction that generated the version was opened after the current transaction generated <code>ReadView</code>, so the version is not accessible by the current transaction.</li>
<li>If the value of the <code>trx_id</code> property of the accessed version is between <code>min_trx_id</code> and <code>max_trx_id</code> of the <code>ReadView</code>, then you need to determine if the value of the <code>trx_id</code> property is in the <code>m_ids</code> list, and if it is, the transaction that generated the version when the <code>ReadView</code> was created is still active, and the version If it is not, then the transaction that generated the version when the <code>ReadView</code> was created has been committed and the version can be accessed.</li>
</ul>
<p>If a version of the data is not visible to the current transaction, then follow the version chain to the next version of the data and continue to follow the above steps to determine visibility. And so on, until the last version in the version chain. If the last version is not visible, it means that the record is not visible to the transaction at all, and the query result does not contain the record.</p>
<p>The timing of the ReadView generation also directly affects the result of the query operation. In Mysql, the biggest difference between RC and RR isolation levels is the timing of the ReadView generation.</p>
<h3 id="read-committed----generate-a-readview-before-each-data-read">READ COMMITTED &ndash; Generate a ReadView before each data read</h3>
<p>Let&rsquo;s say there are two transactions with ids 100 and 200 executing in the system.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Guan Yu&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhang Fei&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">更新了一些别的表的记录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Tip: Once again, the transaction execution process will only be assigned a separate transaction id, which is incremental, when the record is actually modified for the first time (e.g. using INSERT, DELETE, UPDATE statements). That&rsquo;s why we update some other table&rsquo;s records in Transaction 200, with the purpose of having it assigned a transaction id.</p>
</blockquote>
<p>At this moment, the row with <code>number</code> of 1 in the table <code>hero</code> gets the version chain as shown below.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/20/9212108b37f84793bcfe480282e76154.png" alt="version chain"></p>
<p>Suppose now that a transaction using the <code>READ COMMITTED</code> isolation level starts executing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">使用</span><span class="k">READ</span><span class="w"> </span><span class="n">COMMITTED隔离级别的事务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">SELECT1</span><span class="err">：</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="err">、</span><span class="mi">200</span><span class="err">未提交</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="w"> </span><span class="err">得到的列</span><span class="n">name的值为</span><span class="s1">&#39;Liu Bei&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The execution of <code>SELECT1</code> is as follows.</p>
<ul>
<li>The <code>SELECT</code> statement is executed as a <code>ReadView</code>, and the contents of the <code>m_ids</code> list of the <code>ReadView</code> is [100, 200], <code>min_trx_id</code> is 100, <code>max_trx_id</code> is 201, and <code>creator_trx_id</code> is 0.</li>
<li>Then pick the visible records from the version chain. From the figure, we can see that the column <code>name</code> of the latest version is &lsquo;Zhang Fei&rsquo;, and the <code>trx_id</code> value of this version is 100, which is inside the <code>m_ids</code> list, so it does not meet the visibility requirement, and jump to the next version according to <code>roll_pointer</code>.</li>
<li>The column <code>name</code> of the next version is &lsquo;Guan Yu&rsquo;, the value of <code>trx_id</code> of this version is also 100, which is also in the <code>m_ids</code> list, so it also does not meet the requirement, and continues to jump to the next version.</li>
<li>The next version of column <code>name</code> is &lsquo;Liu Bei&rsquo;, and the <code>trx_id</code> value of this version is 80, which is smaller than the <code>min_trx_id</code> value of 100 in <code>ReadView</code>, so this version is compliant, and the last version returned to the user is this record with column <code>name</code> as &lsquo;Liu Bei&rsquo;.</li>
</ul>
<p>After that, let&rsquo;s commit the transaction with transaction id 100, like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Guan Yu&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhang Fei&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">COMMIT</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Then go to the transaction with transaction id 200 and update the record with number 1 in the hero table.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">更新了一些别的表的记录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhao Yun&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhuge Liang&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>At this moment, the version chain of the record with number 1 in table hero looks like this.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/20/800924c048674388b0cb30979aed1949.png" alt="version chain"></p>
<p>Then go to the transaction that just used the READ COMMITTED isolation level and continue to look for the record with number 1 as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">使用</span><span class="k">READ</span><span class="w"> </span><span class="n">COMMITTED隔离级别的事务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">SELECT1</span><span class="err">：</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="err">、</span><span class="mi">200</span><span class="err">均未提交</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="w"> </span><span class="err">得到的列</span><span class="n">name的值为</span><span class="s1">&#39;Liu Bei&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">SELECT2</span><span class="err">：</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="err">提交，</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">200</span><span class="err">未提交</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="w"> </span><span class="err">得到的列</span><span class="n">name的值为</span><span class="s1">&#39;Zhang Fei&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The execution of this <code>SELECT2</code> is as follows.</p>
<ul>
<li>A separate <code>ReadView</code> is generated when the <code>SELECT</code> statement is executed, and the contents of the <code>m_ids</code> list of that <code>ReadView</code> is <code>[200]</code> (the transaction with transaction id 100 has already been committed, so the snapshot is generated again without it), <code>min_trx_id</code> is 200, <code>max_trx_id</code> is 201, and <code>creator_trx_id</code> is 0. id<code>is 201 and</code>creator_trx_id` is 0.</li>
<li>Then pick the visible records from the version chain. As you can see from the figure, the column <code>name</code> of the latest version is &lsquo;Zhuge Liang&rsquo;, and the <code>trx_id</code> value of this version is 200, which is inside the <code>m_ids</code> list, so it does not meet the visibility requirement, and jump to the next version according to <code>roll_pointer</code>.</li>
<li>The column <code>name</code> of the next version is &lsquo;Zhao Yun&rsquo;, the value of <code>trx_id</code> of this version is 200, which is also in the <code>m_ids</code> list, so it also does not meet the requirement, and continues to jump to the next version.</li>
<li>The next version of column <code>name</code> is &lsquo;Zhang Fei&rsquo;, and the <code>trx_id</code> value of this version is 100, which is smaller than the <code>min_trx_id</code> value of 200 in <code>ReadView</code>, so this version is compliant, and the last version returned to the user is the record with this column <code>name</code> as &lsquo;Zhang Fei&rsquo;.</li>
</ul>
<p>And so on, if after the transaction id 200 records are also submitted, again in the use of <code>READ COMMITTED</code> isolation level transactions in the query table <code>hero</code> in the <code>number</code> value of 1 record, the results are &lsquo;Zhuge Liang&rsquo;, the specific process we will not analyze. To summarize, a transaction using the <code>READ COMMITTED</code> isolation level generates a separate <code>ReadView</code> at the beginning of each query.</p>
<h3 id="repeatable-read----generates-a-readview-on-the-first-read-ensuring-consistent-results-across-multiple-queries-in-a-single-transaction">REPEATABLE READ &ndash; Generates a ReadView on the first read, ensuring consistent results across multiple queries in a single transaction</h3>
<p>For transactions using the <code>REPEATABLE READ</code> isolation level, only one <code>ReadView</code> will be generated on the first execution of the query statement, and it will not be repeated for subsequent queries. Let&rsquo;s use the example to see how this works.</p>
<p>Let&rsquo;s say there are now two transactions with transaction ids 100 and 200 in the system executing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Guan Yu&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhang Fei&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">更新了一些别的表的记录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>At this moment, the version chain obtained for the record with number 1 in table hero is shown below.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/20/50265b64fe8a41128536378893a702b3.png" alt="version chain"></p>
<p>Suppose now that a transaction using the REPEATABLE READ isolation level starts executing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">使用</span><span class="k">REPEATABLE</span><span class="w"> </span><span class="n">READ隔离级别的事务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">SELECT1</span><span class="err">：</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="err">、</span><span class="mi">200</span><span class="err">未提交</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="w"> </span><span class="err">得到的列</span><span class="n">name的值为</span><span class="s1">&#39;Liu Bei&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The execution of <code>SELECT1</code> is as follows.</p>
<ul>
<li>The <code>SELECT</code> statement is executed as a <code>ReadView</code>, and the contents of the <code>m_ids</code> list of the <code>ReadView</code> is [100, 200], <code>min_trx_id</code> is 100, <code>max_trx_id</code> is 201, and <code>creator_trx_id</code> is 0.</li>
<li>Then pick the visible records from the version chain. From the figure, we can see that the column <code>name</code> of the latest version is &lsquo;Zhang Fei&rsquo;, and the <code>trx_id</code> value of this version is 100, which is inside the <code>m_ids</code> list, so it does not meet the visibility requirement, and jump to the next version according to <code>roll_pointer</code>.</li>
<li>The column <code>name</code> of the next version is &lsquo;Guan Yu&rsquo;, the value of <code>trx_id</code> of this version is also 100, which is also in the <code>m_ids</code> list, so it also does not meet the requirement, and continues to jump to the next version.</li>
<li>The next version of column <code>name</code> is &lsquo;Liu Bei&rsquo;, and the <code>trx_id</code> value of this version is 80, which is smaller than the <code>min_trx_id</code> value of 100 in <code>ReadView</code>, so this version is compliant, and the last version returned to the user is this record with column <code>name</code> as &lsquo;Liu Bei&rsquo;.</li>
</ul>
<p>After that, we commit the transaction with transaction id 100, like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Guan Yu&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhang Fei&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">COMMIT</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Then go to the transaction with transaction id 200 and update the record with number 1 in the hero table.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="k">Transaction</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">更新了一些别的表的记录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhao Yun&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zhuge Liang&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>At this moment, the version chain of the record with number 1 in table hero looks like this.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/20/d146dc1875b44b80b6fb6c68a5796783.png" alt="version chain"></p>
<p>Then go to the transaction that just used the REPEATABLE READ isolation level and continue to look for the record with number 1, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">使用</span><span class="k">REPEATABLE</span><span class="w"> </span><span class="n">READ隔离级别的事务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">SELECT1</span><span class="err">：</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="err">、</span><span class="mi">200</span><span class="err">均未提交</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="w"> </span><span class="err">得到的列</span><span class="n">name的值为</span><span class="s1">&#39;Liu Bei&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">SELECT2</span><span class="err">：</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">100</span><span class="err">提交，</span><span class="k">Transaction</span><span class="w"> </span><span class="mi">200</span><span class="err">未提交</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="w"> </span><span class="err">得到的列</span><span class="n">name的值仍为</span><span class="s1">&#39;Liu Bei&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The execution of <code>SELECT2</code> is as follows.</p>
<ul>
<li>Because the isolation level of the current transaction is <code>REPEATABLE READ</code>, and the <code>ReadView</code> was already generated during the execution of SELECT1, the previous <code>ReadView</code> is directly reused at this time, and the contents of the <code>m_ids</code> list of the previous <code>ReadView</code> are [100, 200], <code>min_trx_id</code> is 100, <code>max_trx_id</code> is 201, and <code>creator_trx_id</code> is 0. id<code>is 100,</code>max_trx_id<code>is 201, and</code>creator_trx_id` is 0.</li>
<li>Then pick the visible records from the version chain. From the figure, we can see that the column <code>name</code> of the latest version is &lsquo;Zhuge Liang&rsquo;, and the <code>trx_id</code> value of this version is 200, which is inside the <code>m_ids</code> list, so it does not meet the visibility requirement, and jump to the next version according to <code>roll_pointer</code>.</li>
<li>The column <code>name</code> of the next version is &lsquo;Zhao Yun&rsquo;, the value of <code>trx_id</code> of this version is 200, which is also in the <code>m_ids</code> list, so it also does not meet the requirement, and continues to jump to the next version.</li>
<li>The next version of column <code>name</code> is &lsquo;Zhang Fei&rsquo;, the <code>trx_id</code> value of this version is 100, and the <code>m_ids</code> list contains transaction ids with the value of 100, so this version also does not meet the requirement, and similarly the next version of column <code>name</code> is &lsquo;Guan Yu&rsquo;. Proceed to the next version.</li>
<li>The next version of column <code>name</code> is &lsquo;Liu Bei&rsquo;, and the <code>trx_id</code> value of this version is 80, which is less than the <code>min_trx_id</code> value of 100 in <code>ReadView</code>, so this version meets the requirement, and the last version returned to the user is the record with column c as &lsquo;Liu Bei&rsquo;.</li>
</ul>
<p>That is to say, the results obtained from two <code>SELECT</code> queries are duplicated, and the column c values of the records are all &lsquo;Liu Bei&rsquo;, which is the meaning of repeatable reads. If we then submit the record with transaction id 200, and then continue to find the record with <code>number</code> of 1 in the transaction using <code>REPEATABLE READ</code> isolation level, the result will still be `Liu Bei&rsquo;, and you can analyze the specific execution process by yourself.</p>
<h2 id="to-summarize">To summarize</h2>
<p>After reading the above <strong>undolog</strong>, <strong>version chain</strong> and <strong>ReadView</strong>, we have some general ideas, <code>ReadView</code> is mainly to make visibility rules and rule verification for the record history, while the record history is stored in <code>undolog</code> using a chain table structure, the combination of the three solves the read and write problem in <code>MVCC</code>. The combination of the three solves the read/write problem in <code>MVCC</code>. The so-called <code>MVCC</code> in <code>mysql</code> refers to the process of accessing the version chain while executing ordinary <code>SELECT</code> operations using <code>RC</code> and <code>RR</code> transactions with two isolation levels, which enables read/write and write-write operations of different transactions to be executed concurrently, thus improving system performance, and their biggest difference lies in the different timing of generating <code>ReadView</code>.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/mysql/">mysql</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-04/web-attack/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Common Web Attack Means</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-04/wasm-2-0-public-drafts/">
            <span class="next-text nav-default">W3C released the first draft of WebAssembly 2.0</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
