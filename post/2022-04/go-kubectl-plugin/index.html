<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Develop and release a Kubectl plugin using Go - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Learn how to develop a Kubectl plugin using Go and release it through Github Action." /><meta name="keywords" content="golang, Kubectl Plugin, Github Action" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-04/go-kubectl-plugin/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Develop and release a Kubectl plugin using Go" />
<meta property="og:description" content="Learn how to develop a Kubectl plugin using Go and release it through Github Action." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-04/go-kubectl-plugin/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-28T18:54:42+08:00" />
<meta property="article:modified_time" content="2022-04-28T18:54:42+08:00" />

<meta itemprop="name" content="Develop and release a Kubectl plugin using Go">
<meta itemprop="description" content="Learn how to develop a Kubectl plugin using Go and release it through Github Action."><meta itemprop="datePublished" content="2022-04-28T18:54:42+08:00" />
<meta itemprop="dateModified" content="2022-04-28T18:54:42+08:00" />
<meta itemprop="wordCount" content="2601">
<meta itemprop="keywords" content="golang,kubectl," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Develop and release a Kubectl plugin using Go"/>
<meta name="twitter:description" content="Learn how to develop a Kubectl plugin using Go and release it through Github Action."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Develop and release a Kubectl plugin using Go</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-28 18:54:42 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2601 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#preface">Preface</a></li>
        <li><a href="#background">Background</a></li>
        <li><a href="#related-technologies">Related Technologies</a>
          <ul>
            <li><a href="#golang">Golang</a></li>
            <li><a href="#cobra">Cobra</a></li>
            <li><a href="#client-go">Client-go</a></li>
            <li><a href="#krew">krew</a></li>
            <li><a href="#github-publishing-related-tools">Github Publishing Related Tools</a></li>
          </ul>
        </li>
        <li><a href="#plugin-planning">Plugin planning</a></li>
        <li><a href="#development">Development</a>
          <ul>
            <li><a href="#project-initialization">Project initialization</a></li>
            <li><a href="#adding-a-subcommand">Adding a subcommand</a></li>
            <li><a href="#add-parameters">Add parameters</a></li>
            <li><a href="#implement-the-image-command">Implement the image command</a></li>
            <li><a href="#initialize-clientset">Initialize clientset</a></li>
            <li><a href="#view-resource-objects">View resource objects</a></li>
            <li><a href="#implementing-output">Implementing Output</a></li>
            <li><a href="#integrating-krew">Integrating krew</a></li>
            <li><a href="#use">Use</a></li>
          </ul>
        </li>
        <li><a href="#open-source-publishing">Open Source Publishing</a>
          <ul>
            <li><a href="#github-action">Github Action</a></li>
            <li><a href="#go-report-card">GO Report Card</a></li>
            <li><a href="#goreleaser">GoReleaser</a></li>
            <li><a href="#badges-display-tool">Badges display tool</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="preface">Preface</h2>
<p>Under the ten-year cloud computing wave, DevOps, containers, microservices and other technologies are developing rapidly, and cloud-native has become a trend. Enterprises are moving from &ldquo;ON Cloud&rdquo; to &ldquo;IN Cloud&rdquo; and becoming &ldquo;new cloud-native enterprises&rdquo;, where new capabilities and existing capabilities are established but not broken, with organic synergy to achieve Resource efficiency, application agility, business intelligence, security and trustworthiness. The whole concept of cloud-native is very big, and it is so detailed that we may encounter some small problems in the real scenario, this article will share with you the small demands and solutions we encounter in our daily work.</p>
<h2 id="background">Background</h2>
<p>In my daily use of kubectl to view K8s resources, I want to directly view the corresponding resources of the container name and image name, kubectl does not support the selection, we need to describe then to view, for the cluster itself more, not very convenient, so the development of their own kubectl plug-in to achieve this function.</p>
<h2 id="related-technologies">Related Technologies</h2>
<p>The first need to call Kubernetes requires the use of client-go project to achieve access to Kubernetes resources, for the plug-in using Golang language development, because it is client-side execution, in order to facilitate the integration to and command-line tools, using the same command-line scaffolding tool Cobra and K8s, and finally released it open source to GitHub.</p>
<h3 id="golang">Golang</h3>
<p>In cloud native development, many of Google&rsquo;s open source projects are developed using Golang, which can be distributed to multiple platforms after cross-platform compilation, and the plug-ins we develop are based on Golang and subsequently support multi-platform use.</p>
<h3 id="cobra">Cobra</h3>
<p>Cobra is a command line library that is a powerful tool for writing command lines and provides a scaffold for quickly generating Cobra-based application frameworks. We can use Cobra to quickly and easily develop the command line tools we want.</p>
<h3 id="client-go">Client-go</h3>
<p>In K8s operations, we can use kubectl, client libraries or REST requests to access the K8s API, and in fact, both kubectl and client libraries are tools that encapsulate REST requests. client-go, as a client library, can call the K8s API and implement operations on resource objects in the K8s cluster, including client-go is a client library that can call the K8s API to add, delete, modify, and query resource objects (including deployment, service, Ingress, ReplicaSet, Pod, Namespace, Node, etc.) in a K8s cluster.</p>
<h3 id="krew">krew</h3>
<p>Krew is a package management tool for kubectl plugins, similar to apt, dnf or brew, which allows you to easily manage the full cycle of kubectl plugins, including search, download, uninstall, etc.</p>
<p>The kubectl tool is already relatively complete, but for some personalized commands, the goal is to allow developers to release custom kubectl subcommands in an independent and intense form. Plugins can be developed in any language. You need to name the final footer or binary executable with the prefix <code>kubectl-</code> and put it in the PATH. You can use the <code>kubectl plugin list</code> to see which plugins are currently installed.</p>
<h3 id="github-publishing-related-tools">Github Publishing Related Tools</h3>
<ul>
<li>GitHub Action</li>
</ul>
<p>If you need an Action, you don&rsquo;t have to write your own complex script, you can just reference someone else&rsquo;s Action and the whole continuous integration process becomes a combination of Actions. This allows people to define their own Action, which can then be easily reused by others. It is also possible to unify your own or organize some public processes in the build process.</p>
<ul>
<li>gorelease</li>
</ul>
<p>Developed in Golang, GoReleaser is an automated release tool for Golang projects. Without much configuration, you can easily compile, package and publish cross-platform packages to Github, Gitlab and other repositories with just a few lines of command.</p>
<h2 id="plugin-planning">Plugin planning</h2>
<ul>
<li>The plugin is named: kubectl-img.</li>
<li>Currently only a simple implementation of an image command to view the names of different resource objects (deployments/daemonsets/statefulsets/jobs/cronjobs), and the corresponding container names, image names.</li>
<li>JSON format output is supported.</li>
<li>Finally use it as a krew plugin.</li>
<li>You can view the corresponding resources directly based on the namespace.</li>
</ul>
<h2 id="development">Development</h2>
<h3 id="project-initialization">Project initialization</h3>
<ul>
<li>Install Cobra</li>
</ul>
<p>Install Cobra in your development environment and go to the command line tool to generate project scaffolding based on this framework, which is also used to generate many of the components in K8s.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">go get -v github.com/spf13/cobra/cobra
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Initialize the project</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ cobra init --pkg-name kubectl-img
</span></span><span class="line"><span class="cl">$ ls
</span></span><span class="line"><span class="cl">LICENSE cmd     main.go
</span></span><span class="line"><span class="cl">$ tree
</span></span><span class="line"><span class="cl">├── LICENSE
</span></span><span class="line"><span class="cl">├── cmd
</span></span><span class="line"><span class="cl">│   └── root.go
</span></span><span class="line"><span class="cl">└── main.go
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Create go mod, download related packages</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">go mod init github.com/redhatxl/kubectl-img
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="adding-a-subcommand">Adding a subcommand</h3>
<p>Add a subcommand image, add a subcommand to our plugin here.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ cobra add image
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="add-parameters">Add parameters</h3>
<p>Display different resource image names by subcommand+flag form.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">Execute</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">cobra</span><span class="p">.</span><span class="nf">CheckErr</span><span class="p">(</span><span class="nx">rootCmd</span><span class="p">.</span><span class="nf">Execute</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">KubernetesConfigFlags</span> <span class="p">=</span> <span class="nx">genericclioptions</span><span class="p">.</span><span class="nf">NewConfigFlags</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">imageCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">BoolP</span><span class="p">(</span><span class="s">&#34;deployments&#34;</span><span class="p">,</span> <span class="s">&#34;d&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&#34;show deployments image&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">imageCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">BoolP</span><span class="p">(</span><span class="s">&#34;daemonsets&#34;</span><span class="p">,</span> <span class="s">&#34;e&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&#34;show daemonsets image&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">imageCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">BoolP</span><span class="p">(</span><span class="s">&#34;statefulsets&#34;</span><span class="p">,</span> <span class="s">&#34;f&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&#34;show statefulsets image&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">imageCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">BoolP</span><span class="p">(</span><span class="s">&#34;jobs&#34;</span><span class="p">,</span> <span class="s">&#34;o&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&#34;show jobs image&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">imageCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">BoolP</span><span class="p">(</span><span class="s">&#34;cronjobs&#34;</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&#34;show cronjobs image&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">imageCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">BoolP</span><span class="p">(</span><span class="s">&#34;json&#34;</span><span class="p">,</span> <span class="s">&#34;j&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&#34;show json format&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">KubernetesConfigFlags</span><span class="p">.</span><span class="nf">AddFlags</span><span class="p">(</span><span class="nx">rootCmd</span><span class="p">.</span><span class="nf">PersistentFlags</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="implement-the-image-command">Implement the image command</h3>
<p>Register subcommands and modify command usage instructions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">imageCmd</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">cobra</span><span class="p">.</span><span class="nx">Command</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">Use</span><span class="p">:</span>   <span class="s">&#34;image&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nx">Short</span><span class="p">:</span> <span class="s">&#34;show resource image&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nx">Long</span><span class="p">:</span>  <span class="s">`show k8s resource image`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nx">RunE</span><span class="p">:</span>  <span class="nx">image</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">rootCmd</span><span class="p">.</span><span class="nf">AddCommand</span><span class="p">(</span><span class="nx">imageCmd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="initialize-clientset">Initialize clientset</h3>
<p>Since we need to call K8s resources, here we use ClientSet in Client-go to get different resource images based on different flags entered by the user.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// ClientSet k8s clientset
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">func</span> <span class="nf">ClientSet</span><span class="p">(</span><span class="nx">configFlags</span> <span class="o">*</span><span class="nx">genericclioptions</span><span class="p">.</span><span class="nx">ConfigFlags</span><span class="p">)</span> <span class="o">*</span><span class="nx">kubernetes</span><span class="p">.</span><span class="nx">Clientset</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">config</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">configFlags</span><span class="p">.</span><span class="nf">ToRESTConfig</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">panic</span><span class="p">(</span><span class="s">&#34;kube config load error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="nx">clientSet</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">kubernetes</span><span class="p">.</span><span class="nf">NewForConfig</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">panic</span><span class="p">(</span><span class="s">&#34;gen kube config error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="nx">clientSet</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="view-resource-objects">View resource objects</h3>
<p>Use reflection to view specific resource  images and  image names based on different resource types.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">image</span><span class="p">(</span><span class="nx">cmd</span> <span class="o">*</span><span class="nx">cobra</span><span class="p">.</span><span class="nx">Command</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nx">clientSet</span> <span class="o">:=</span> <span class="nx">kube</span><span class="p">.</span><span class="nf">ClientSet</span><span class="p">(</span><span class="nx">KubernetesConfigFlags</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="nx">ns</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">rootCmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">GetString</span><span class="p">(</span><span class="s">&#34;namespace&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="c1">// 生命一个全局资源列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="kd">var</span> <span class="nx">rList</span> <span class="p">[]</span><span class="kd">interface</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">if</span> <span class="nx">flag</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cmd</span><span class="p">.</span><span class="nf">Flags</span><span class="p">().</span><span class="nf">GetBool</span><span class="p">(</span><span class="s">&#34;deployments&#34;</span><span class="p">);</span> <span class="nx">flag</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">deployList</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">clientSet</span><span class="p">.</span><span class="nf">AppsV1</span><span class="p">().</span><span class="nf">Deployments</span><span class="p">(</span><span class="nx">ns</span><span class="p">).</span><span class="nf">List</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">v1</span><span class="p">.</span><span class="nx">ListOptions</span><span class="p">{})</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;list deployments error: %s&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">rList</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">rList</span><span class="p">,</span> <span class="nx">deployList</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">   <span class="nx">deployMapList</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">rList</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="nx">t</span> <span class="o">:=</span> <span class="nx">rList</span><span class="p">[</span><span class="nx">i</span><span class="p">].(</span><span class="kd">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="o">*</span><span class="nx">kv1</span><span class="p">.</span><span class="nx">DeploymentList</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="nx">k</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">Items</span><span class="p">);</span> <span class="nx">k</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="nx">j</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">Items</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">Spec</span><span class="p">.</span><span class="nx">Template</span><span class="p">.</span><span class="nx">Spec</span><span class="p">.</span><span class="nx">Containers</span><span class="p">);</span> <span class="nx">j</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMap</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMap</span><span class="p">[</span><span class="s">&#34;NAMESPACE&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">ns</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMap</span><span class="p">[</span><span class="s">&#34;TYPE&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="s">&#34;deployment&#34;</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMap</span><span class="p">[</span><span class="s">&#34;RESOURCE_NAME&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Items</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nf">GetName</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMap</span><span class="p">[</span><span class="s">&#34;CONTAINER_NAME&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Items</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">Spec</span><span class="p">.</span><span class="nx">Template</span><span class="p">.</span><span class="nx">Spec</span><span class="p">.</span><span class="nx">Containers</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">Name</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMap</span><span class="p">[</span><span class="s">&#34;IMAGE&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Items</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">Spec</span><span class="p">.</span><span class="nx">Template</span><span class="p">.</span><span class="nx">Spec</span><span class="p">.</span><span class="nx">Containers</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">Image</span>
</span></span><span class="line"><span class="cl">     <span class="nx">deployMapList</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">deployMapList</span><span class="p">,</span> <span class="nx">deployMap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="implementing-output">Implementing Output</h3>
<p>Use Table to output the results, also extending JSON output.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">GenTable</span><span class="p">(</span><span class="nx">mapList</span> <span class="p">[]</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="nx">table</span><span class="p">.</span><span class="nx">Table</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">t</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">gotable</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="nx">title</span><span class="o">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;create table error: %s&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="nx">t</span><span class="p">.</span><span class="nf">AddRows</span><span class="p">(</span><span class="nx">mapList</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="nx">t</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Final project structure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/93ab3d68e21b4f779ab4d9eef10d8f0f.png" alt="project structure"></p>
<h3 id="integrating-krew">Integrating krew</h3>
<p>You need to name the final footer or binary executable with the prefix <code>kubectl-</code> and put it in the PATH. You can use the <code>kubectl plugin list</code> to see which plugins are currently installed.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ kubectl plugin list
</span></span><span class="line"><span class="cl">The following compatible plugins are available:<span class="o">=</span>
</span></span><span class="line"><span class="cl">/usr/local/bin/kubectl-debug
</span></span><span class="line"><span class="cl">  - warning: kubectl-debug overwrites existing command: <span class="s2">&#34;kubectl debug&#34;</span>
</span></span><span class="line"><span class="cl">/usr/local/bin/kubectl-v1.10.11
</span></span><span class="line"><span class="cl">/usr/local/bin/kubectl-v1.20.0
</span></span><span class="line"><span class="cl">/Users/xuel/.krew/bin/kubectl-df_pv
</span></span><span class="line"><span class="cl">/Users/xuel/.krew/bin/kubectl-krew
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 将自己开发的插件重新命名为kubectl-img放到可执行路基下</span>
</span></span><span class="line"><span class="cl">$ cp kubectl-img /Users/xuel/.krew/bin/kubectl-img
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ kubectl plugin list
</span></span><span class="line"><span class="cl">The following compatible plugins are available:<span class="o">=</span>
</span></span><span class="line"><span class="cl">/usr/local/bin/kubectl-debug
</span></span><span class="line"><span class="cl">  - warning: kubectl-debug overwrites existing command: <span class="s2">&#34;kubectl debug&#34;</span>
</span></span><span class="line"><span class="cl">/usr/local/bin/kubectl-v1.10.11
</span></span><span class="line"><span class="cl">/usr/local/bin/kubectl-v1.20.0
</span></span><span class="line"><span class="cl">/Users/xuel/.krew/bin/kubectl-df_pv
</span></span><span class="line"><span class="cl">/Users/xuel/.krew/bin/kubectl-krew
</span></span><span class="line"><span class="cl">/Users/xuel/.krew/bin/kubectl-img
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="use">Use</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ kubectl img image -h
</span></span><span class="line"><span class="cl">show k8s resource image
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Usage:
</span></span><span class="line"><span class="cl">  kubectl-img image <span class="o">[</span>flags<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Flags:
</span></span><span class="line"><span class="cl">  -b, --cronjobs       show cronjobs image
</span></span><span class="line"><span class="cl">  -e, --daemonsets     show daemonsets image
</span></span><span class="line"><span class="cl">  -d, --deployments    show deployments image
</span></span><span class="line"><span class="cl">  -h, --help           <span class="nb">help</span> <span class="k">for</span> image
</span></span><span class="line"><span class="cl">  -o, --jobs           show <span class="nb">jobs</span> image
</span></span><span class="line"><span class="cl">  -j, --json           show json format
</span></span><span class="line"><span class="cl">  -f, --statefulsets   show statefulsets image
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Global Flags:
</span></span><span class="line"><span class="cl">      --as string                      Username to impersonate <span class="k">for</span> the operation
</span></span><span class="line"><span class="cl">      --as-group stringArray           Group to impersonate <span class="k">for</span> the operation, this flag can be repeated to specify multiple groups.
</span></span><span class="line"><span class="cl">      --cache-dir string               Default cache directory <span class="o">(</span>default <span class="s2">&#34;/Users/xuel/.kube/cache&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      --certificate-authority string   Path to a cert file <span class="k">for</span> the certificate authority
</span></span><span class="line"><span class="cl">      --client-certificate string      Path to a client certificate file <span class="k">for</span> TLS
</span></span><span class="line"><span class="cl">      --client-key string              Path to a client key file <span class="k">for</span> TLS
</span></span><span class="line"><span class="cl">      --cluster string                 The name of the kubeconfig cluster to use
</span></span><span class="line"><span class="cl">      --context string                 The name of the kubeconfig context to use
</span></span><span class="line"><span class="cl">      --insecure-skip-tls-verify       If true, the server<span class="s1">&#39;s certificate will not be checked for validity. This will make your HTTPS connections insecure
</span></span></span><span class="line"><span class="cl"><span class="s1">      --kubeconfig string              Path to the kubeconfig file to use for CLI requests.
</span></span></span><span class="line"><span class="cl"><span class="s1">  -n, --namespace string               If present, the namespace scope for this CLI request
</span></span></span><span class="line"><span class="cl"><span class="s1">      --request-timeout string         The length of time to wait before giving up on a single server request. Non-zero values should contain a corresponding time unit (e.g. 1s, 2m, 3h). A value of zero means don&#39;</span>t timeout requests. <span class="o">(</span>default <span class="s2">&#34;0&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -s, --server string                  The address and port of the Kubernetes API server
</span></span><span class="line"><span class="cl">      --tls-server-name string         Server name to use <span class="k">for</span> server certificate validation. If it is not provided, the hostname used to contact the server is used
</span></span><span class="line"><span class="cl">      --token string                   Bearer token <span class="k">for</span> authentication to the API server
</span></span><span class="line"><span class="cl">      --user string                    The name of the kubeconfig user to use
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>View Resources</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># View the images of all deployments of the entire kubernetes cluster</span>
</span></span><span class="line"><span class="cl">kubectl img image --deployments
</span></span><span class="line"><span class="cl"><span class="c1"># View the images of all deployments of the entire kubernetes cluster</span>
</span></span><span class="line"><span class="cl">kubectl img image --deployments -n default
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/71223d813a5d488987c36bdee3861a48.png" alt="View Resources"></p>
</li>
<li>
<p>View all resources</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># view all resource</span>
</span></span><span class="line"><span class="cl">kubectl img image -bedof
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/b5d9e059382040f7bdf60cfa422f86fa.png" alt="View all resources"></p>
</li>
<li>
<p>JSON formatted output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Table display is used by default</span>
</span></span><span class="line"><span class="cl">kubectl img image --deployments -n default -j
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/b2543cb60241495fb6684abe337e8896.png" alt="JSON formatted output"></p>
</li>
</ul>
<h2 id="open-source-publishing">Open Source Publishing</h2>
<p>Once you&rsquo;ve finished writing the code, you&rsquo;ll publish it to GitHub so that more people can learn and share it.</p>
<h3 id="github-action">Github Action</h3>
<p>Create a <code>.github/workflows/ci.yml</code> file in the project root directory with the following contents.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ci</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">goreleaser</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Checkout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@master</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup Go</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/setup-go@v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">go-version</span><span class="p">:</span><span class="w"> </span><span class="m">1.16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">GoReleaser</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">goreleaser/goreleaser-action@v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l">latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="l">release --snapshot --rm-dist</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/84a4c9ca49de464ba1210d2a6df1cef8.png" alt="Github Action"></p>
<h3 id="go-report-card">GO Report Card</h3>
<p>Add a Go project report: <a href="https://goreportcard.com/">https://goreportcard.com/</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/79ae6829f3ed4ad28df1a840e330e6ef.png" alt="GO Report Card"></p>
<h3 id="goreleaser">GoReleaser</h3>
<p>For Golang projects, you can use GoReleaser to make a nice Release.</p>
<p>Since macOS is used, here&rsquo;s how to install it using <code>brew</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">brew install goreleaser
</span></span></code></pre></td></tr></table>
</div>
</div><p>Generate the <code>.goreleaser.yml</code> configuration in the project root directory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">goreleaser init
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once configured, remember to add <code>dist</code> to <code>.gitignore</code>, as goreleaser will output the compiled files to the <code>dist</code> directory by default.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="c"># This is an example .goreleaser.yml file with some sensible defaults.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Make sure to check the documentation at https://goreleaser.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">before</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">hooks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># You may remove this if you don&#39;t use go modules.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">go mod tidy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># you may remove this if you don&#39;t need go generate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">go generate ./...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">builds</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">CGO_ENABLED=0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">goos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">linux</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">windows</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">darwin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">archives</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">replacements</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">darwin</span><span class="p">:</span><span class="w"> </span><span class="l">Darwin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">linux</span><span class="p">:</span><span class="w"> </span><span class="l">Linux</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">windows</span><span class="p">:</span><span class="w"> </span><span class="l">Windows</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">386</span><span class="p">:</span><span class="w"> </span><span class="l">i386</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">amd64</span><span class="p">:</span><span class="w"> </span><span class="l">x86_64</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">checksum</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name_template</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;checksums.txt&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">snapshot</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name_template</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;{{ incpatch .Version }}-next&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">changelog</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">sort</span><span class="p">:</span><span class="w"> </span><span class="l">asc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">exclude</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;^docs:&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;^test:&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">project_name</span><span class="p">:</span><span class="w"> </span><span class="l">kubectl-img</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>After GoReleaser is configured, you can first compile and test it by.</p>
<p><strong>Note:</strong> To configure GITHUB_TOKEN for the first time using GoReleaser, you can apply for it here, and run the following command to configure <code>GITHUB_TOKEN</code> after the application is done.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">GITHUB_TOKEN</span><span class="o">=</span>&lt;YOUR_TOKEN&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Make sure there are no problems, then you can run Git and GoReleaser to release the release.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;add goreleaser&#34;</span>
</span></span><span class="line"><span class="cl">git tag -a v0.0.2 -m <span class="s2">&#34;First release&#34;</span>
</span></span><span class="line"><span class="cl">git push origin main
</span></span><span class="line"><span class="cl">git push origin v0.0.2
</span></span></code></pre></td></tr></table>
</div>
</div><p>After all is done, execute the following command to publish.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ goreleaser release --rm-dist
</span></span><span class="line"><span class="cl">   • releasing...
</span></span><span class="line"><span class="cl">   • loading config file       <span class="nv">file</span><span class="o">=</span>.goreleaser.yaml
</span></span><span class="line"><span class="cl">   • loading environment variables
</span></span><span class="line"><span class="cl">   • getting and validating git state
</span></span><span class="line"><span class="cl">      • building...               <span class="nv">commit</span><span class="o">=</span>98703b3b9d9ac7f4661c5669c1e164d2cf3675d2 latest <span class="nv">tag</span><span class="o">=</span>v1.0.0
</span></span><span class="line"><span class="cl">   • parsing tag
</span></span><span class="line"><span class="cl">   • running before hooks
</span></span><span class="line"><span class="cl">      • running                   <span class="nv">hook</span><span class="o">=</span>go mod tidy
</span></span><span class="line"><span class="cl">      • running                   <span class="nv">hook</span><span class="o">=</span>go generate ./...
</span></span><span class="line"><span class="cl">   • setting defaults
</span></span><span class="line"><span class="cl">      • DEPRECATED: skipped windows/arm64 build on Go &lt; 1.17 <span class="k">for</span> compatibility, check https://goreleaser.com/deprecations/#builds-for-windowsarm64 <span class="k">for</span> more info.
</span></span><span class="line"><span class="cl">   • checking distribution directory
</span></span><span class="line"><span class="cl">      • --rm-dist is set, cleaning it up
</span></span><span class="line"><span class="cl">   • loading go mod information
</span></span><span class="line"><span class="cl">   • build prerequisites
</span></span><span class="line"><span class="cl">   • writing effective config file
</span></span><span class="line"><span class="cl">      • writing                   <span class="nv">config</span><span class="o">=</span>dist/config.yaml
</span></span><span class="line"><span class="cl">   • generating changelog
</span></span><span class="line"><span class="cl">      • writing                   <span class="nv">changelog</span><span class="o">=</span>dist/CHANGELOG.md
</span></span><span class="line"><span class="cl">   • building binaries
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_linux_386/kubectl-img
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_linux_amd64/kubectl-img
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_darwin_arm64/kubectl-img
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_linux_arm64/kubectl-img
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_windows_amd64/kubectl-img.exe
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_windows_386/kubectl-img.exe
</span></span><span class="line"><span class="cl">      • building                  <span class="nv">binary</span><span class="o">=</span>/Users/xuel/workspace/goworkspace/src/github.com/kaliarch/kubectl-img/dist/kubectl-img_darwin_amd64/kubectl-img
</span></span><span class="line"><span class="cl">   • archives
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Linux_i386.tar.gz
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Darwin_x86_64.tar.gz
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Linux_x86_64.tar.gz
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Windows_x86_64.tar.gz
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Linux_arm64.tar.gz
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Windows_i386.tar.gz
</span></span><span class="line"><span class="cl">      • creating                  <span class="nv">archive</span><span class="o">=</span>dist/kubectl-img_1.0.0_Darwin_arm64.tar.gz
</span></span><span class="line"><span class="cl">   • calculating checksums
</span></span><span class="line"><span class="cl">   • storing release metadata
</span></span><span class="line"><span class="cl">      • writing                   <span class="nv">file</span><span class="o">=</span>dist/artifacts.json
</span></span><span class="line"><span class="cl">      • writing                   <span class="nv">file</span><span class="o">=</span>dist/metadata.json
</span></span><span class="line"><span class="cl">   • publishing
</span></span><span class="line"><span class="cl">      • scm releases
</span></span><span class="line"><span class="cl">         • creating or updating release <span class="nv">repo</span><span class="o">=</span>redhatxl/kubectl-img <span class="nv">tag</span><span class="o">=</span>v1.0.0
</span></span><span class="line"><span class="cl">         • release updated           <span class="nv">url</span><span class="o">=</span>https://github.com/redhatxl/kubectl-img/releases/tag/v1.0.0
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/checksums.txt <span class="nv">name</span><span class="o">=</span>checksums.txt
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Linux_i386.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Linux_i386.tar.gz
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Linux_x86_64.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Linux_x86_64.tar.gz
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Windows_i386.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Windows_i386.tar.gz
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Linux_arm64.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Linux_arm64.tar.gz
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Darwin_x86_64.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Darwin_x86_64.tar.gz
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Windows_x86_64.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Windows_x86_64.tar.gz
</span></span><span class="line"><span class="cl">         • uploading to release      <span class="nv">file</span><span class="o">=</span>dist/kubectl-img_1.0.0_Darwin_arm64.tar.gz <span class="nv">name</span><span class="o">=</span>kubectl-img_1.0.0_Darwin_arm64.tar.gz
</span></span><span class="line"><span class="cl">   • announcing
</span></span><span class="line"><span class="cl">   • release succeeded after 183.24s
</span></span></code></pre></td></tr></table>
</div>
</div><p>Check out the Release that was released.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/1b4bcad812ff4e2db3914f65c9bca932.png" alt="Release"></p>
<p>Add the installation method for different platforms in the project README.</p>
<h4 id="linux">Linux</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">release</span><span class="o">=</span>v1.0.0
</span></span><span class="line"><span class="cl">curl -L -o kubectl-img.tar.gz https://github.com/redhatxl/kubectl-img/releases/download/<span class="si">${</span><span class="nv">release</span><span class="si">}</span>/kubectl-img_<span class="si">${</span><span class="nv">release</span><span class="si">}</span>_Linux_arm64.tar.gz
</span></span><span class="line"><span class="cl">tar -xvf kubectl-img.tar.gz
</span></span><span class="line"><span class="cl">cp kubectl-img /usr/local/bin/kubectl-img
</span></span><span class="line"><span class="cl"><span class="c1"># use kubectl krew</span>
</span></span><span class="line"><span class="cl">cp kubectl-img <span class="nv">$HOME</span>/.krew/bin
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="osx">OSX</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">release</span><span class="o">=</span>v1.0.0
</span></span><span class="line"><span class="cl">curl -L -o kubectl-img.tar.gz https://github.com/redhatxl/kubectl-img/releases/download/<span class="si">${</span><span class="nv">release</span><span class="si">}</span>/kubectl-img_<span class="si">${</span><span class="nv">release</span><span class="si">}</span>_Darwin_x86_64.tar.gz
</span></span><span class="line"><span class="cl">tar -xvf kubectl-img.tar.gz
</span></span><span class="line"><span class="cl">mv kubectl-img /usr/local/bin/kubectl-img
</span></span><span class="line"><span class="cl"><span class="c1"># use kubectl krew</span>
</span></span><span class="line"><span class="cl">cp kubectl-img <span class="nv">$HOME</span>/.krew/bin
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="windows">Windows</h4>
<p>In PowerShell v5+</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">=</span> <span class="s2">&#34;https://github.com/redhatxl/kubectl-img/releases/download/v1.0.0/kubectl-img_1.0.0_Windows_x86_64.tar.gz&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="nv">$PSScriptRoot</span><span class="s2">\kubectl-img.zip&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Invoke-WebRequest -Uri <span class="nv">$url</span> -OutFile <span class="nv">$output</span>
</span></span><span class="line"><span class="cl">Expand-Archive <span class="s2">&#34;</span><span class="nv">$PSScriptRoot</span><span class="s2">\kubectl-img.zip&#34;</span> -DestinationPath <span class="s2">&#34;</span><span class="nv">$PSScriptRoot</span><span class="s2">\kubectl-img&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="badges-display-tool">Badges display tool</h3>
<p>Here&rsquo;s a great tool for displaying Badges: <a href="https://shields.io/">https://shields.io/</a>. This site offers a wide variety of Badges, and you can fill up your GitHub README.md with them if you want.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/9bbc8b1ef45d4f22a96cddb49e8619dd.png" alt="Badges"></p>
<h2 id="summary">Summary</h2>
<p>The current implementation is relatively simple, as a way to throw the function, later you can carry out more functions or other plug-in development. From a technical perspective, cloud-native technologies represented by containers, microservices and dynamic orchestration are flourishing and have become an important driving force for enabling business innovation, and have been applied to the core business of enterprises. From the market perspective, cloud-native technologies have been widely verified in many industries such as finance, manufacturing, and Internet, and the business scenarios supported are getting richer and richer, and the industry ecology is becoming more and more prosperous.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/golang/">golang</a>
          <a href="/tags/kubectl/">kubectl</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-04/lsm-tree/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Principle of LSM Tree</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-04/go-project-layout/">
            <span class="next-text nav-default">How should the standard structure of a Go project be laid out?</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
