<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Two-Year-Old Critical Vulnerability in Apache Struts Resurfaces, Official Patch Released - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="The Apache Software Foundation has issued a security advisory S2-062 to address a remote code execution vulnerability in Struts versions 2.0.0 through 2.5.29." /><meta name="keywords" content="struts, Vulnerability, S2-062, S2-061" />






<meta name="generator" content="Hugo 0.96.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-04/apache-struts-bug-new-patch/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Two-Year-Old Critical Vulnerability in Apache Struts Resurfaces, Official Patch Released" />
<meta property="og:description" content="The Apache Software Foundation has issued a security advisory S2-062 to address a remote code execution vulnerability in Struts versions 2.0.0 through 2.5.29." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-04/apache-struts-bug-new-patch/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-15T10:21:06+08:00" />
<meta property="article:modified_time" content="2022-04-15T10:21:06+08:00" />

<meta itemprop="name" content="Two-Year-Old Critical Vulnerability in Apache Struts Resurfaces, Official Patch Released">
<meta itemprop="description" content="The Apache Software Foundation has issued a security advisory S2-062 to address a remote code execution vulnerability in Struts versions 2.0.0 through 2.5.29."><meta itemprop="datePublished" content="2022-04-15T10:21:06+08:00" />
<meta itemprop="dateModified" content="2022-04-15T10:21:06+08:00" />
<meta itemprop="wordCount" content="348">
<meta itemprop="keywords" content="struts,Vulnerability," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Two-Year-Old Critical Vulnerability in Apache Struts Resurfaces, Official Patch Released"/>
<meta name="twitter:description" content="The Apache Software Foundation has issued a security advisory S2-062 to address a remote code execution vulnerability in Struts versions 2.0.0 through 2.5.29."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Two-Year-Old Critical Vulnerability in Apache Struts Resurfaces, Official Patch Released</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-15 10:21:06 </span>
        <div class="post-category">
            <a href="/categories/news/"> news </a>
            </div>
          <span class="more-meta"> 348 words </span>
          <span class="more-meta"> 2 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents"></nav>
  </div>
</div>
    <div class="post-content">
      <p>The Apache Software Foundation has issued a <a href="https://cwiki.apache.org/confluence/display/WW/S2-062">Security Advisory S2-062</a> to address a remote code execution vulnerability in Struts versions 2.0.0 through 2.5.29; an attacker could exploit this vulnerability to compromise an affected system. In response, the U.S. Cybersecurity and Infrastructure Security Agency (CISA) has also issued a <a href="https://www.cisa.gov/uscert/ncas/current-activity/2022/04/12/apache-releases-security-advisory-struts-2">bulletin</a> urging organizations to review the Apache bulletin and upgrade to the latest version of the Struts 2 patch as soon as possible.</p>
<p>The vulnerability is tracked as CVE-2021-31805 and is due to an incomplete fix for CVE-2020-17530 (<a href="https://cwiki.apache.org/confluence/display/WW/S2-061">S2-061</a>) in 2020. This means that the vulnerability existed as early as 2020 and was thought to have been fixed at that time, but it turns out that the issue has not been fully resolved.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/15/0bca58d8c3a24f06a5a794f2d9b8a389.png" alt="struts S2-062"></p>
<p>In 2020, GitHub researchers Alvaro Munoz and Masato Anzai of Aeye Security Labs reported an OGNL injection vulnerability in Struts 2 versions 2.0.0 - 2.5.25 under certain circumstances, as CVE-2020-17530, which received a score of 9.8 out of 10 on the CVSS severity scale. out of 10).</p>
<p>&ldquo;If a developer uses the %{&hellip;} syntax for mandatory OGNL evaluation, some attributes of the tag can still perform double evaluation. Using mandatory OGNL evaluation on untrusted user input can lead to remote code execution and degraded security.&rdquo;</p>
<p>Object-Graph Navigation Language (OGNL) is an open source Java expression language that simplifies the scope of expressions in the Java language. It is integrated into frameworks such as Struts2 and serves to access data; it has features such as type conversion, access to object methods, and manipulation of collection objects.</p>
<p>Although Apache addressed the vulnerabilities reported in 2020 in Struts 2.5.26, researcher Chris McCown <a href="https://www.openwall.com/lists/oss-security/2022/04/12/6">found</a> that the fix applied was incomplete. He reported to Apache that the &ldquo;double-evaluation&rdquo; issue can still be reproduced in Struts version 2.5.26 and later.</p>
<p>As a workaround, for its part, Apache recommends that developers avoid using mandatory OGNL evaluation in tag attributes based on untrusted user input, and/or upgrade to Struts 2.5.30 or later to check that expression evaluation does not lead to double evaluation. It is also recommended to follow the <a href="https://struts.apache.org/security/#do-not-use-incoming-untrusted-user-input-in-forced-expression-evaluation">Security Guidelines</a> for best practices.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/struts/">struts</a>
          <a href="/tags/vulnerability/">Vulnerability</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-04/go-when-generics/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">The main designer of the Go generic type describes the best time to use it</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-04/appflowy/">
            <span class="next-text nav-default">Open source alternative to Notion built with Rust and Flutter - AppFlowy</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
