<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>How should the standard structure of a Go project be laid out? - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="This article details the ins and outs of the structural layout of Go language projects and the factual criteria for Go project structure." /><meta name="keywords" content="golang, project layout" />






<meta name="generator" content="Hugo 0.96.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-04/go-project-layout/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="How should the standard structure of a Go project be laid out?" />
<meta property="og:description" content="This article details the ins and outs of the structural layout of Go language projects and the factual criteria for Go project structure." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-04/go-project-layout/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-28T13:44:17+08:00" />
<meta property="article:modified_time" content="2022-04-28T13:44:17+08:00" />

<meta itemprop="name" content="How should the standard structure of a Go project be laid out?">
<meta itemprop="description" content="This article details the ins and outs of the structural layout of Go language projects and the factual criteria for Go project structure."><meta itemprop="datePublished" content="2022-04-28T13:44:17+08:00" />
<meta itemprop="dateModified" content="2022-04-28T13:44:17+08:00" />
<meta itemprop="wordCount" content="2786">
<meta itemprop="keywords" content="golang," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How should the standard structure of a Go project be laid out?"/>
<meta name="twitter:description" content="This article details the ins and outs of the structural layout of Go language projects and the factual criteria for Go project structure."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">How should the standard structure of a Go project be laid out?</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-28 13:44:17 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2786 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#1-the-project-structure-of-the-go-project">1. The project structure of the Go project</a></li>
            <li><a href="#2-typical-project-structure-for-go-language">2. Typical project structure for Go language</a></li>
            <li><a href="#3-summary">3. Summary</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Whenever we write a non-hello world utility Go program or library, we will trudge around in front of the three &ldquo;thresholds&rdquo; of project structure, code style, and identifier naming for a long time, and never even get a satisfactory answer.</p>
<p>In this article, we will introduce in detail how to cross the &ldquo;threshold&rdquo; of Go project structure to help you get into the core hinterland of Go language faster and improve your learning efficiency.</p>
<p>Unless it is a simple program like hello world, whenever we write a utility or library, we will encounter the problem of what project structure to use (usually a Go project corresponds to a repository). In Go, the project structure is also very important, because it determines the layout of packages and package dependencies within the project, and also affects the dependencies and references of external projects to packages in the project.</p>
<h3 id="1-the-project-structure-of-the-go-project">1. The project structure of the Go project</h3>
<p>Let&rsquo;s take a look at the project structure of the Go language itself, the world&rsquo;s first Go project.</p>
<p>The project structure of the Go project has been very stable since the release of version 1.0, and the top-level structure of the Go project has remained largely unchanged until now. As of go project commit 1e3ffb0c (2019.5.14), the structure of the go project is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ tree -LF <span class="m">1</span> ~/go/src/github.com/golang/go
</span></span><span class="line"><span class="cl">./go
</span></span><span class="line"><span class="cl">├── api/
</span></span><span class="line"><span class="cl">├── AUTHORS
</span></span><span class="line"><span class="cl">├── CONTRIBUTING.md
</span></span><span class="line"><span class="cl">├── CONTRIBUTORS
</span></span><span class="line"><span class="cl">├── doc/
</span></span><span class="line"><span class="cl">├── favicon.ico
</span></span><span class="line"><span class="cl">├── lib/
</span></span><span class="line"><span class="cl">├── LICENSE
</span></span><span class="line"><span class="cl">├── misc/
</span></span><span class="line"><span class="cl">├── PATENTS
</span></span><span class="line"><span class="cl">├── README.md
</span></span><span class="line"><span class="cl">├── robots.txt
</span></span><span class="line"><span class="cl">├── src/
</span></span><span class="line"><span class="cl">└── test/
</span></span></code></pre></td></tr></table>
</div>
</div><p>As the &ldquo;founding project&rdquo; of Go, the layout of its project structure is an important reference for other subsequent Go projects, especially the structure under the src directory in the early Go projects, which is widely used by the Go community as a template for Go application project structure. Let&rsquo;s take the structure under the src directory of the early Go 1.3 version as an example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ tree -LF <span class="m">1</span> ./src
</span></span><span class="line"><span class="cl">./src
</span></span><span class="line"><span class="cl">├── all.bash*
</span></span><span class="line"><span class="cl">├── all.bat
</span></span><span class="line"><span class="cl">├── all.rc*
</span></span><span class="line"><span class="cl">├── clean.bash*
</span></span><span class="line"><span class="cl">├── clean.bat
</span></span><span class="line"><span class="cl">├── clean.rc*
</span></span><span class="line"><span class="cl">├── cmd/
</span></span><span class="line"><span class="cl">├── lib9/
</span></span><span class="line"><span class="cl">├── libbio/
</span></span><span class="line"><span class="cl">├── liblink/
</span></span><span class="line"><span class="cl">├── make.bash*
</span></span><span class="line"><span class="cl">├── make.bat
</span></span><span class="line"><span class="cl">├── Make.dist
</span></span><span class="line"><span class="cl">├── make.rc*
</span></span><span class="line"><span class="cl">├── nacltest.bash*
</span></span><span class="line"><span class="cl">├── pkg/
</span></span><span class="line"><span class="cl">├── race.bash*
</span></span><span class="line"><span class="cl">├── race.bat
</span></span><span class="line"><span class="cl">├── run.bash*
</span></span><span class="line"><span class="cl">├── run.bat
</span></span><span class="line"><span class="cl">├── run.rc*
</span></span><span class="line"><span class="cl">└── sudo.bash*
</span></span></code></pre></td></tr></table>
</div>
</div><p>Regarding the structure below the src directory above, I have summarized three features.</p>
<ol>
<li>
<p>the script source files for code building are placed in the top-level directory under src.</p>
</li>
<li>
<p>the secondary directory cmd under src holds the main directory of go toolchain-related executables (e.g.: go, gofmt, etc.) and their main package source files.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ tree -LF <span class="m">1</span> ./cmd
</span></span><span class="line"><span class="cl">./cmd
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">├── 6a/
</span></span><span class="line"><span class="cl">├── 6c/
</span></span><span class="line"><span class="cl">├── 6g/
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">├── cc/
</span></span><span class="line"><span class="cl">├── cgo/
</span></span><span class="line"><span class="cl">├── dist/
</span></span><span class="line"><span class="cl">├── fix/
</span></span><span class="line"><span class="cl">├── gc/
</span></span><span class="line"><span class="cl">├── go/
</span></span><span class="line"><span class="cl">├── gofmt/
</span></span><span class="line"><span class="cl">├── ld/
</span></span><span class="line"><span class="cl">├── nm/
</span></span><span class="line"><span class="cl">├── objdump/
</span></span><span class="line"><span class="cl">├── pack/
</span></span><span class="line"><span class="cl">└── yacc/
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>The secondary directory under src, pkg, holds the source files of the packages, go runtime, and go standard library that each toolchain depends on under cmd above.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ tree -LF <span class="m">1</span> ./pkg
</span></span><span class="line"><span class="cl">./pkg
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">├── flag/
</span></span><span class="line"><span class="cl">├── fmt/
</span></span><span class="line"><span class="cl">├── go/
</span></span><span class="line"><span class="cl">├── io/
</span></span><span class="line"><span class="cl">├── log/
</span></span><span class="line"><span class="cl">├── math/
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">├── syscall/
</span></span><span class="line"><span class="cl">├── testing/
</span></span><span class="line"><span class="cl">├── text/
</span></span><span class="line"><span class="cl">├── time/
</span></span><span class="line"><span class="cl">├── unicode/
</span></span><span class="line"><span class="cl">└── unsafe/
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>Several structural changes have occurred in the src directory under Go projects since Go version 1.3 to date.</p>
<ul>
<li>Go 1.4 removes the pkg level from src/pkg/xxx in the Go source tree and instead uses src/xxx directly.</li>
<li>Go 1.4 added the internal directory under src to store packages that cannot be imported externally and are only used by Go projects.</li>
<li>Go 1.6 added the vendor directory under src, but the Go project itself really enabled the vendor mechanism in Go 1.7. The vendor directory holds the Go project&rsquo;s own dependencies on external projects, mainly packages under golang.org/x, including: net, text, crypto, etc. The packages in this directory are updated with each Go version release.</li>
<li>Go version 1.13 added go.mod and go.num under src, which realized the migration of go module of go project itself. All packages in go project were put under the module named std, and its dependencies are still various packages under golang.org/x</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// Go 1.13版本go项目src下面的go.mod
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">module</span> <span class="nx">std</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">go</span> <span class="mf">1.12</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">require</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">x</span><span class="o">/</span><span class="nx">crypto</span> <span class="nx">v0</span><span class="mf">.0.0</span><span class="o">-</span><span class="mi">20200124225646</span><span class="o">-</span><span class="mi">8</span><span class="nx">b5121be2f68</span>
</span></span><span class="line"><span class="cl">    <span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">x</span><span class="o">/</span><span class="nx">net</span> <span class="nx">v0</span><span class="mf">.0.0</span><span class="o">-</span><span class="mi">20190813141303</span><span class="o">-</span><span class="mi">74</span><span class="nx">dc4d7220e7</span>
</span></span><span class="line"><span class="cl">    <span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">x</span><span class="o">/</span><span class="nx">sys</span> <span class="nx">v0</span><span class="mf">.0.0</span><span class="o">-</span><span class="mi">20190529130038</span><span class="o">-</span><span class="mi">5219</span><span class="nx">a1e1c5f8</span> <span class="c1">// indirect
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">x</span><span class="o">/</span><span class="nx">text</span> <span class="nx">v0</span><span class="mf">.3.2</span> <span class="c1">// indirect
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here is the complete layout in the src directory of the latest Go 1.16 release.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">├── Make.dist
</span></span><span class="line"><span class="cl">├── README.vendor
</span></span><span class="line"><span class="cl">├── all.bash*
</span></span><span class="line"><span class="cl">├── all.bat
</span></span><span class="line"><span class="cl">├── all.rc*
</span></span><span class="line"><span class="cl">├── bootstrap.bash*
</span></span><span class="line"><span class="cl">├── buildall.bash*
</span></span><span class="line"><span class="cl">├── clean.bash*
</span></span><span class="line"><span class="cl">├── clean.bat
</span></span><span class="line"><span class="cl">├── clean.rc*
</span></span><span class="line"><span class="cl">├── cmd/
</span></span><span class="line"><span class="cl">├── cmp.bash
</span></span><span class="line"><span class="cl">├── go.mod
</span></span><span class="line"><span class="cl">├── go.sum
</span></span><span class="line"><span class="cl">├── internal/
</span></span><span class="line"><span class="cl">├── make.bash*
</span></span><span class="line"><span class="cl">├── make.bat
</span></span><span class="line"><span class="cl">├── make.rc*
</span></span><span class="line"><span class="cl">├── race.bash*
</span></span><span class="line"><span class="cl">├── race.bat
</span></span><span class="line"><span class="cl">├── run.bash*
</span></span><span class="line"><span class="cl">├── run.bat
</span></span><span class="line"><span class="cl">├── run.rc*
</span></span><span class="line"><span class="cl">├── testdata/
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">└── vendor/
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-typical-project-structure-for-go-language">2. Typical project structure for Go language</h3>
<h4 id="1-minimum-standard-layout-of-go-project-structure">(1) Minimum standard layout of Go project structure</h4>
<p>The official Go team has never given a reference standard about what the standard layout of a Go application project structure looks like. However, as the technical leader of the Go language project, <a href="https://github.com/golang-standards/project-layout/issues/117#issuecomment-828503689">Russ Cox gave his thoughts on the minimum standard layout of the Go project structure</a> in an issue of the open source project. He believes that the minimum standard layout of the Go project should be as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">// 在Go项目仓库根路径下
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- go.mod
</span></span><span class="line"><span class="cl">- LICENSE
</span></span><span class="line"><span class="cl">- xx.go
</span></span><span class="line"><span class="cl">- yy.go
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">or
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- go.mod
</span></span><span class="line"><span class="cl">- LICENSE
</span></span><span class="line"><span class="cl">- package1
</span></span><span class="line"><span class="cl">  - package1.go
</span></span><span class="line"><span class="cl">- package2
</span></span><span class="line"><span class="cl">  - package2.go
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><p>As for pkg, cmd, docs, these directories should not be part of the standard structure of a Go project, or at least not required. I believe that the minimum standard layout given by Russ Cox is consistent with Go&rsquo;s philosophy of &ldquo;simplicity&rdquo;, which is flexible enough to meet the needs of various Go projects.</p>
<p>However, before Russ Cox elaborated on the minimum standard, the Go community was in a &ldquo;non-standard&rdquo; state, and the influence of the early Go language&rsquo;s own project structure on a large number of existing Go open source projects is still lasting. For larger Go applications, we are bound to extend the &ldquo;minimal standard layout&rdquo;. This extension will obviously not be blind, but will still refer to the Go language project&rsquo;s own structural layout, so we have the following unofficial standard suggested structural layout.</p>
<h4 id="2-go-project-structure-for-the-purpose-of-building-binary-executables">(2) Go project structure for the purpose of building binary executables</h4>
<p>Based on the early structure of Go language projects themselves and their subsequent evolution, the Go community has gradually formed a typical project structure after years of Go language practice accumulation, which is compatible with Russ Cox&rsquo;s minimum standard layout, as shown in Figure 1.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/3e6f0bf6327549d7a88a27ad5e5c1883.png" alt="Go language typical project structure"></p>
<p>The above is the structure of a typical Go project that supports building binary executables (under cmd), let&rsquo;s look at the purpose of each important directory separately.</p>
<ul>
<li>
<p>cmd directory: store the source files of the main package corresponding to the executable file to be compiled and built by the project. If there are multiple executables to build, the main package of each executable is placed in a separate subdirectory, such as app1 and app2 in the figure; the main package of each app in the cmd directory connects the dependencies of the whole project together; and generally speaking, the main package should be very concise. We will do some command line parameter parsing, resource initialization, logging facility initialization, database connection initialization, etc. in the main package, after which we will hand over the execution rights of the program to a more advanced execution control object; there are also some go projects that change the name cmd to app, but its utility does not change.</p>
</li>
<li>
<p>pkg directory: the project itself to use, but also the executable file corresponding to the main package to depend on the library files; at the same time, the package under this directory can also be external project reference, as a project export package &ldquo;aggregation&rdquo;; also some projects will be pkg the name to lib, but the directory purpose remains the same; because the Go language projects have removed the pkg directory in version 1.4, there are some projects that directly lay the packages under the root path of the project, but I think that for some larger projects, too many packages will make the top-level directory of the project less concise and &ldquo;crowded&rdquo;. For complex Go projects, I suggest keeping the pkg directory.</p>
</li>
<li>
<p>Makefile: Makefile here is a &ldquo;representation&rdquo; of the scripts used by the project build tool, it can represent the scripts used by any third party build tool. seems to be indispensable for larger projects. In a typical Go project, the scripts for the project build tool are usually placed in the top-level project directory, such as the Makefile here; for projects with more build scripts, you can also create a build directory and put the build scripts&rsquo; rule property files and sub-build scripts into it.</p>
</li>
<li>
<p>go.mod and go.sum: configuration files used for Go language package dependency management. go modules was introduced in Go 1.11, and go module became the default dependency package management and build mechanism in Go 1.16. So for new Go projects, we recommend to use go modules for package dependency management. For projects that don&rsquo;t use go modules for package management (probably mainly go projects that use previous versions of go 1.11), you can replace them with dep&rsquo;s Gopkg.toml and Gopkg.lock or glide&rsquo;s glide.yaml and glide.lock, etc.</p>
</li>
<li>
<p>vendor directory (optional): vendor is a mechanism introduced in Go 1.5 to cache version-specific dependency packages locally in the project, before the go modules mechanism was introduced, vendor-based reproducible builds could be implemented to ensure that executables built from the same source code were equivalent. go modules itself can implement reproducible builds without vendor. modules itself enables reproducible builds without the need for vendor, but the go modules mechanism also preserves the vendor directory (go mod vendor generates dependencies under vendor; go build -mod=vendor enables vendor-based builds), so here the vendor directory as an optional directory. Generally we only keep the vendor directory in the root of the project, otherwise it will cause unnecessary complexity in dependency selection.</p>
</li>
</ul>
<p>Go 1.11 introduces a module as a collection of packages that belong to the same versioning unit. And while Go supports multiple modules in a project/repository, this management approach may introduce more complexity than a certain percentage of code duplication. Therefore, if there are versioning &ldquo;divergences&rdquo; in the project structure, e.g. app1 and app2 releases are not always in sync, then I recommend splitting the project into multiple projects (repositories), with each project being a separate module for separate versioning and evolution.</p>
<h4 id="3-go-project-structure-for-library-only-building">(3) Go project structure for library-only building</h4>
<p>When Go 1.4 was released, the Go language project itself removed the pkg layer under src. This structural change has some impact on the structure of Go library-type projects that are built for library-only purposes. Let&rsquo;s look at the structure of a typical Go library type project, see Figure 2.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/28/d69e7b418dee48ccb8183f382effef7a.png" alt="Go Language Library Project Structure"></p>
<p>We see that the library type project structure is also compatible with the minimum standard layout of a Go project, but is simpler than a Go project that aims to build binary executables.</p>
<ul>
<li>The cmd and pkg subdirectories have been removed: since the library is only a component library, there is no need to keep the cmd directory where the main package source files of binaries are stored; since the original intent of Go library projects is to expose the API to the outside world (open source or internal organization), there is no need to aggregate it under the pkg directory.</li>
<li>vendor is no longer optional: for library type projects, we do not recommend placing a vendor directory in the project to cache the library&rsquo;s own third-party dependencies; library projects should only explicitly state the modules or packages that the project depends on and the version requirements through go.mod (or other package dependency management tools&rsquo; manifest files).</li>
</ul>
<h4 id="4-about-the-internal-directory">(4) About the internal directory</h4>
<p>For any of the above types of Go projects, for packages that you do not want to expose to external references, but only for internal use, the project structure can be implemented through the internal package mechanism introduced in Go 1.4. In the case of library projects, the easiest way to do this is to add an internal directory at the top level and put all packages that you don&rsquo;t want to expose to the outside in that directory, such as ilib1 and ilib2 in the project structure below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">// 带internal的Go库项目结构
</span></span><span class="line"><span class="cl"><span class="nv">$tree</span> -F ./chapter2/sources/GoLibProj
</span></span><span class="line"><span class="cl">GoLibProj
</span></span><span class="line"><span class="cl">├── LICENSE
</span></span><span class="line"><span class="cl">├── Makefile
</span></span><span class="line"><span class="cl">├── README.md
</span></span><span class="line"><span class="cl">├── go.mod
</span></span><span class="line"><span class="cl">├── internal/
</span></span><span class="line"><span class="cl">│   ├── ilib1/
</span></span><span class="line"><span class="cl">│   └── ilib2/
</span></span><span class="line"><span class="cl">├── lib.go
</span></span><span class="line"><span class="cl">├── lib1/
</span></span><span class="line"><span class="cl">│   └── lib1.go
</span></span><span class="line"><span class="cl">└── lib2/
</span></span><span class="line"><span class="cl">    └── lib2.go
</span></span></code></pre></td></tr></table>
</div>
</div><p>Thus, according to the principle of the go internal mechanism, ilib1 and ilib2 in the internal directory can be imported and used by code in other directories (such as lib.go, lib1/lib1.go, etc.) with the GoLibProj directory as the root directory, but not by code outside the GoLibProj directory. This allows for selective exposure of API packages. Of course internal can be placed at any directory level in the project structure, but it is critical that the project structure designer is clear about what to expose to the outer code and what to use only in sibling directories or subdirectories.</p>
<p>For projects that aim to build binary executable types, we can also aggregate packages that we don&rsquo;t want to expose to the outside under internal at the top-level path of the project, echoing the aggregation directory pkg for packages that are exposed to the outside.</p>
<h3 id="3-summary">3. Summary</h3>
<p>This article has detailed the history of the structural layout of Go language projects and the de facto standards for Go project structures. The two project reference structures for building binary executable types and library types in this article are recognized and widely used by the Go community after years of practice, and they are compatible with the minimum standard layout for Go projects proposed by Russ Cox, which is valuable for slightly larger Go projects. However, they are not required, and in the early days of the Go language, the practice of placing all source files in a root package located at the root of the project worked equally well in some small-scale projects.</p>
<p>For projects aiming to build binary executable types, the removal of the pkg hierarchy is also the structural layout of choice for many projects, influenced by the Go 1.4 project structure.</p>
<p>The above reference project structure is similar to the idea of &ldquo;minimum viable product&rdquo; (mvp) in the field of product design and development, and developers can extend it based on such a minimum &ldquo;project structure core&rdquo; according to their actual needs.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/golang/">golang</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-04/go-kubectl-plugin/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Develop and release a Kubectl plugin using Go</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-04/postgresql-fulltext-search/">
            <span class="next-text nav-default">Using PostgreSQL as a search engine</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
