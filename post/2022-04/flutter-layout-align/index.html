<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Flutter/Layout: Thoroughly figure out how Align is aligned - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="This article shares my understanding of Align&#39;s alignment principles, so you can thoroughly understand how Align is aligned." /><meta name="keywords" content="flutter, Align" />






<meta name="generator" content="Hugo 0.101.0 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-04/flutter-layout-align/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Flutter/Layout: Thoroughly figure out how Align is aligned" />
<meta property="og:description" content="This article shares my understanding of Align&#39;s alignment principles, so you can thoroughly understand how Align is aligned." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-04/flutter-layout-align/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-04T14:00:38+08:00" />
<meta property="article:modified_time" content="2022-04-04T14:00:38+08:00" />

<meta itemprop="name" content="Flutter/Layout: Thoroughly figure out how Align is aligned">
<meta itemprop="description" content="This article shares my understanding of Align&#39;s alignment principles, so you can thoroughly understand how Align is aligned."><meta itemprop="datePublished" content="2022-04-04T14:00:38+08:00" />
<meta itemprop="dateModified" content="2022-04-04T14:00:38+08:00" />
<meta itemprop="wordCount" content="1037">
<meta itemprop="keywords" content="flutter," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Flutter/Layout: Thoroughly figure out how Align is aligned"/>
<meta name="twitter:description" content="This article shares my understanding of Align&#39;s alignment principles, so you can thoroughly understand how Align is aligned."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SOBYTE</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SOBYTE</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Flutter/Layout: Thoroughly figure out how Align is aligned</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-04 14:00:38 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1037 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#pre-requisite-knowledge-alignment">Pre-requisite knowledge: Alignment</a></li>
        <li><a href="#how-align-works">How Align works</a></li>
        <li><a href="#misunderstanding">Misunderstanding</a></li>
        <li><a href="#my-understanding">My understanding</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>We will often use the Align component in our development to position the child components. Usually we use several common relative positions, such as alignment: Alignment.bottomRight, bottom-right corner. Recently, the official documentation about alignment: Alignment(x, y) in Align seems to be a little bit wrong, and then combined with the relevant source code, we finally figured it out. Then I found that most of the tutorials on the Internet are wrong, so I&rsquo;ll share my understanding of Align&rsquo;s alignment principle below.</p>
<h2 id="pre-requisite-knowledge-alignment">Pre-requisite knowledge: Alignment</h2>
<p>Alignment works by first creating a virtual coordinate system in a rectangle. The origin of this virtual coordinate system is the midpoint of the rectangle, then (x, y) is the locus in this virtual coordinate system, and the values of (x, y) are specified to represent relative values. For example, Alignment(0.0, 0.0) is the midpoint and Alignment(1.0, 1.0) is the lower right corner, as shown in the figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/04/6d358e784b95482491a6858abbe018ff.png" alt="example"></p>
<p>The unit of the relative value of x in (x, y) is half of the width of the rectangle, for example, 2.0 is equivalent to the entire width of the rectangle; y is similar, the unit of y is half of the height of the rectangle.</p>
<p>This is then converted to a point of orientation in the coordinate system with the upper left corner of the rectangle as the origin by a formula. This conversion formula is as follows: <code>(x * w/2 + w/2, y * h/2 + h/2)</code>, where w is the width of the rectangle and h is the height of the rectangle. The calculation process is understood in conjunction with the following schematic diagram.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/04/9d38287cca7d42139dbc61e973e99248.png" alt="calculation"></p>
<p>The green box is this rectangle, the black axis is the virtual coordinate system, and the blue axis is the target coordinate system with the upper left corner of the rectangle as the origin. Taking the horizontal coordinate x on the virtual coordinate axis as an example, the converted target point&rsquo;s horizontal coordinate x&rsquo; = half of the rectangle width plus x * half of the rectangle width (the unit of x in the virtual coordinate axis is half of the rectangle width).</p>
<p>For example, the value of Alignment(2.0, 0.0) is 1.5 times the width of the rectangle, not twice the width of the rectangle.</p>
<h2 id="how-align-works">How Align works</h2>
<p>In the official Align documentation there is this sentence.</p>
<blockquote>
<p>How it works</p>
<p>The alignment property describes a point in the child&rsquo;s coordinate system and a different point in the coordinate system of this widget. The Align widget positions the child such that both points are lined up on top of each other.</p>
</blockquote>
<h2 id="misunderstanding">Misunderstanding</h2>
<p>From the above description, we can see that the final placement coordinates are related to the size of Align as well, because the process uses alignment to calculate a point in Align. But I only see from the official documentation that the calculation is related to the subcomponent.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/04/a68387fe2b01444e88f060d6c2dc2545.png" alt="official documentation"></p>
<p>And some of the tutorials I&rsquo;ve seen online have explanations that are wrong, such as this one.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/04/817ecaac502e499ba6c2491358a074cb.png" alt="wrong explanations"></p>
<p>To prove this error is simple, place Align in a Container and set alignment to Alignment(1.0, 0.0). Then place a random child component, like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Container</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">height</span><span class="o">:</span> <span class="mi">120</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">width</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">color</span><span class="o">:</span> <span class="nx">Colors</span><span class="p">.</span><span class="nx">green</span><span class="p">.</span><span class="nx">withOpacity</span><span class="p">(</span><span class="mf">0.6</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">child</span><span class="o">:</span> <span class="nx">Align</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alignment</span><span class="o">:</span> <span class="nx">Alignment</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">child</span><span class="o">:</span> <span class="nx">Container</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nx">width</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">height</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">color</span><span class="o">:</span> <span class="nx">Colors</span><span class="p">.</span><span class="nx">red</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">),</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>You will notice that no matter how you change the width of the outside Container, the right side of the red rectangle inside always coincides with the right side of the outside Container. How does this work if the coordinates of the positioning are only related to the width of the child component?</p>
<h2 id="my-understanding">My understanding</h2>
<p>The official documentation on how it works gives the principle of the calculation, but not the exact formula. I&rsquo;ve looked at the source code to confirm that the description of how it works is fine, so I&rsquo;ll use a simple example to illustrate the calculation process and give the correct formula.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/04/04/6bb3ad04a6e8447a82dd5932ab377419.png" alt="calculation"></p>
<p>The green rectangle above is the size of Align, the red is the subcomponent, and I&rsquo;ll use Alignment(1.0, 0.0) to illustrate this. the horizontal coordinate of the point described by Alignment(1.0, 0.0) is at the right box in both the green and red rectangles, and if Align positions the subcomponent according to this position, the red rectangle should be at the red dotted box If Align had positioned the subcomponent in this way, the red rectangle would be in the red dotted box. However, according to the description of how it works, Align places the subcomponent so that the two points coincide, i.e. the point on the right side of the red rectangle coincides with the point on the right side of the green rectangle. In this case, we just need to move from the position of the red dotted box to the position of the solid box, i.e., the horizontal coordinate of the point positioned in Align minus the horizontal coordinate of the point positioned in the subcomponent.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">alignWidth</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">*</span> <span class="p">(</span><span class="nx">alignWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">childWidth</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nx">x</span> <span class="o">*</span> <span class="p">(</span><span class="nx">childWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>A similar process can be described for the y-values of the coordinates, so the formula for the final locus should be</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="p">(</span><span class="nx">alignWidth</span> <span class="o">-</span> <span class="nx">childWidth</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">*</span> <span class="p">((</span><span class="nx">alignWidth</span> <span class="o">-</span> <span class="nx">childWidth</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="p">(</span><span class="nx">alignHeight</span> <span class="o">-</span> <span class="nx">childHeight</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">*</span> <span class="p">((</span><span class="nx">parentHeight</span> <span class="o">-</span> <span class="nx">childHeight</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Finally, if alignment is FractionalOffset, a similar process can be used to describe positioning. The difference between FractionalOffset and Alignment is that the origin of FractionalOffset in the virtual coordinate system is in the upper left corner of the rectangle, and the unit of x in FractionalOffset(x, y) is the entire width of the rectangle, not half. Positioning in Align still follows that the points of the two FractionalOffsets should be coincident.</p>
<p>The difference between FractionalOffset and Alignment is that the origin of FractionalOffset in the virtual coordinate system is in the upper-left corner of the rectangle, and the unit of x in FractionalOffset(x, y) is the full width of the rectangle, not half of it. Positioning in Align still follows that the points of the two FractionalOffsets should be coincident.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/flutter/">flutter</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-04/windows-wls2-ubuntu-cuda-cudnn-tensorflow-pytorch/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Machine learning environment build: WLS2&#43;Ubuntu&#43;CUDA&#43;cuDNN</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-04/kubernetes-app/">
            <span class="next-text nav-default">An HTTP application running on Kubernetes</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
